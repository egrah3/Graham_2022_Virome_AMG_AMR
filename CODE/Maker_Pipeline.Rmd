---
title: "Marker_Pipeline"
output: html_document
---

```{r setup, include=FALSE}
library(NRES803)
library(tidyverse)
library(GGally)
library(readr)
library(mgcv)
library(broom)
library(gridExtra)
library(lme4)
library(lmerTest)
library(broom.mixed)
library(readr)
library(phyloseq)
library(dplyr)
library(tidyr)
library(ggplot2)
library(phyloseq)
library(tidyverse)
library(microbiome)
library(readr)
library("ggpubr")
library("tidyverse")
library(vegan)
library(ComplexHeatmap)
library(gridBase)
library(metagenomeSeq)
library(bbmle)
library(glmmTMB)
library(circlize)
```

#Contig List to Tax 
```{r}
counts <- read_delim("counts2_c.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
counts_tax <- counts
counts_tax$phylum <- counts_tax$contig
counts_tax <- subset(counts_tax, select = c(contig,phylum))
write_csv(counts_tax, 'contig_list.csv')
contigs_list <- read.csv('contig_list.csv', header = TRUE, stringsAsFactors = FALSE, row.names = 1)
contigs_list <- as.matrix(contigs_list)
TAX <- tax_table(contigs_list)
ermc_Markers <- c("k127_13186497", "k127_12842510","k127_2295155")
marker_ermc1<-subset(counts, counts$contig %in% ermc_Markers)
```
#OTU Table
```{r}
write_csv(counts, 'counts2_no1.csv')
OTU <- read.csv('counts2_no1.csv', header = TRUE, stringsAsFactors = FALSE, row.names = 1)
OTU <- subset(OTU, select = -c(length))
OTU <- otu_table(OTU, taxa_are_rows = TRUE)
```
#Metadata
```{r}
Metadata2 <- read_csv("~/Desktop/Current_work/OTU_Builber/Sequencing_Data_Info_Sheet3.csv")
Metadata3 <- Metadata2
Metadata3$Time <- Metadata3$Time_Collected
Metadata3$Time[which(Metadata3$Time == "T_0")] <- "00_Weeks"
Metadata3$Time[which(Metadata3$Time == "2_week")] <- "02_Weeks"
Metadata3$Time[which(Metadata3$Time == "1_month")] <- "04_Weeks"
Metadata3$Time[which(Metadata3$Time == "3_month")] <- "12_Weeks"
Metadata3$Time[which(Metadata3$Time == "6_month")] <- "24_Weeks"
#Metadata3 <-Metadata3[!grepl("HV_003_15", Metadata3$SampleID),]
META <- sample_data(Metadata3)
sample_names(META)= META$SampleID
```

#Phyloseq Object
```{r}
PHY <- phyloseq(OTU, TAX, META)
Samples_toRemove <- c("HV_001_27", "HV_002_27", "HV_003_27", "HV_004_27", "HV_005_27", "HV_006_27", "HV_007_27", "HV_008_27",
                      "HV_009_27", "HV_010_27", "HV_011_27", "HV_012_27", "HV_013_27", "HV_014_27", "HV_015_27", "HV_016_27",
                      "HV_017_27", "HV_018_27", "HV_019_27", "HV_020_27", "HV_021_27", "HV_022_27", "HV_023_27", "HV_024_27",
                      "HV_025_27", "HV_026_27", "HV_027_27", "HV_028_27", "HV_029_27", "HV_030_27", "HV_015_20", "HV_015_21", 
                      "HV_020_22", "HV_027_02", "HV_027_03", "HV_027_04", "HV_027_05", "HV_027_06", "HV_027_07", "HV_020_10",
                      "HV_021_13", "HV_027_01")

PHY2 <- subset_samples(PHY, !(SampleID %in% Samples_toRemove))
```

```{r}
prevdf_ps= apply(X = otu_table(PHY2), 
                       MARGIN = ifelse(taxa_are_rows(PHY2), yes = 1, no = 2), 
                       FUN = function(x){sum(x > 0)})
prevdf_ps <- data.frame(Prevalence= prevdf_ps, TotalAbundance=taxa_sums(PHY2))
#View(prevdf_ps)
ps_virome_run <- rownames(prevdf_ps)[prevdf_ps$Prevalence > 1]
ps_virome_run
ps_virome_analyze <- prune_taxa(ps_virome_run, PHY2)
ps_virome_analyze
sum(otu_table(ps_virome_analyze))/sum(otu_table(PHY2)) 
save(ps_virome_analyze, file = "ps_virome_analyze.rds")
load("ps_virome_analyze.rds")
sum(otu_table(ps_virome_analyze)) 
ps_rarefy <- rarefy_even_depth(ps_virome_analyze, sample.size = min(sample_sums(ps_virome_analyze)), rngseed = T, replace = TRUE, trimOTUs = TRUE, verbose = TRUE)

Chao1_obser_rarefy= estimate_richness(ps_rarefy, split = TRUE, measures = c("Chao1"))
head(Chao1_obser_rarefy)
obser_rarefy= estimate_richness(ps_rarefy, split = TRUE, measures = c("Observed"))
head(obser_rarefy)
shannon_obser_rarefy= estimate_richness(ps_rarefy, split = TRUE, measures = c("Shannon"))
Chao1_obser_rarefy_metadata= merge(META,Chao1_obser_rarefy, by= "row.names")
head(Chao1_obser_rarefy_metadata)
shannon_obser_rarefy_metadata= merge(META,shannon_obser_rarefy, by= "row.names")
```
```{r}
alpha_meas = c("Observed", "Chao1", "Shannon")
(p <- plot_richness(ps_rarefy, "Time_Collected", measures=alpha_meas))
test <- (p + geom_boxplot(data=p$data, aes(x=Time_Collected, y=value, color=NULL), alpha=0.1)) 
plot(test)
observed_pairwise <- pairwise.wilcox.test(obser_rarefy$Observed, sample_data(ps_rarefy)$Time_Collected)
observed_pairwise
chao1_pairwise <- pairwise.wilcox.test(Chao1_obser_rarefy$Chao1, sample_data(ps_rarefy)$Time_Collected)
chao1_pairwise 
shannon_pairwise <- pairwise.wilcox.test(shannon_obser_rarefy$Shannon, sample_data(ps_rarefy)$Time_Collected)
shannon_pairwise
```
Unclassified Baculoviridae
Escherichia virus Lambda
Autographa californica multiple nucleopolyhedrovirus1
Streptococcus phage phi−SC181
Marine virus AFVG_25M557
Streptococcus phage phiJH1301−2
```{r}
norm_groups <- transform_sample_counts(PHY2, function(x) x / sum(x) )
otu_table(norm_groups)
ord.core_groups.pcoa <- ordinate(norm_groups, method="PCoA", distance="jaccard")
plot_ordination(norm_groups, ord.core_groups.pcoa, color = "Subject", shape = "Time_Collected") +
  geom_point(size=1)
```

```{r}
counts2_checkv_FINAL <- read_delim("counts2_checkv_FINAL.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
tax_ann <- read.csv("vc_tax.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
OTU_SUMS <- merge(tax_ann, counts2_checkv_FINAL, by="contig")
OTU_SUMS<- subset (OTU_SUMS, select = -c(HV_001_27,HV_004_27,HV_005_27,HV_006_27,HV_007_27,HV_008_27,HV_009_27,HV_010_27,HV_011_27,HV_012_27,HV_013_27,HV_014_27,HV_015_20,HV_015_27,HV_016_27,HV_017_27,HV_018_27,HV_019_27,HV_020_10,HV_020_22,HV_020_27,HV_021_13,HV_021_27,HV_022_27,HV_023_27,HV_024_27,HV_025_27,HV_026_27,HV_027_01,HV_027_02,HV_027_03,HV_027_04,HV_027_05,HV_027_06,HV_027_07,HV_027_27,HV_028_27,HV_029_27,HV_030_27))
OTU_SUMS$contig -> row.names(OTU_SUMS)
OTU_SUMS<- subset (OTU_SUMS, select = -c(contig))
OTU_SUMS<- subset (OTU_SUMS, select = -c(length))
OTU<-OTU_SUMS
```
#OTU Table
```{r}
#1x
#OTU <- read.csv("counts2_bowtie2_1x.txt", "\t", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
OTU <- read.csv("counts2_FINAL_1x.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
tax_ann <- read.csv("vc_tax.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
OTU_SUMS <- merge(tax_ann, OTU, by.x = "row.names", by.y = "row.names")
OTU_SUMS<- subset (OTU_SUMS, select = -c(Superkingdom, Realm, Kingdom, Phylum, Class, Order, Species, Subfamily, Genus))
OTU_SUMS<-ddply(OTU_SUMS,"Family",numcolwise(sum))
OTU_SUMS<- subset (OTU_SUMS, select = -c(HV_027_01,HV_027_02,HV_027_03,HV_027_04,HV_027_05,HV_027_06,HV_027_07,HV_015_20, HV_015_21, HV_020_10, HV_020_22, HV_021_13,length))


#no 1x
OTU <- read.csv("counts2_bowtie.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
#OTU  <- subset(OTU , select = -c(length))
tax_ann <- read.csv("vc_tax.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
OTU <- merge(tax_ann, OTU, by.x = "row.names", by.y = "row.names")
OTU <- subset(OTU, select = -c(Row.names))
OTU$ContigID <- row.names(OTU)
OTU_SUMS<-OTU
OTU_SUMS<- subset (OTU_SUMS, select = -c(Superkingdom, Realm, Kingdom, Phylum, Class, Order, Family, Subfamily, Genus))
OTU_SUMS<-ddply(OTU_SUMS,"Species",numcolwise(sum))
OTU_SUMS<- subset (OTU_SUMS, select = -c(HV_001_27,HV_004_27,HV_005_27,HV_006_27,HV_007_27,HV_008_27,HV_009_27,HV_010_27,HV_011_27,HV_012_27,HV_013_27,HV_014_27,HV_015_20,HV_015_27,HV_016_27,HV_017_27,HV_018_27,HV_019_27,HV_020_10,HV_020_22,HV_020_27,HV_021_13,HV_021_27,HV_022_27,HV_023_27,HV_024_27,HV_025_27,HV_026_27,HV_027_01,HV_027_02,HV_027_05,HV_027_06,HV_027_07,HV_027_27,HV_028_27,HV_029_27,HV_030_27,HV_015_21,HV_027_03,HV_027_04))


checkv_overall_family <- c("Baculoviridae","Genomoviridae","Herelleviridae","Myoviridae","Papillomaviridae","Podoviridae","Siphoviridae","Unclassified Caudovirales","Unclassified Homo sapiens like virus","Unclassified Staphylococcus warneri like virus","Caulimoviridae")

checkv_overall_stable_family <- OTU_Stable
checkv_overall_stable_family$Family->row.names(checkv_overall_stable_family)
checkv_overall_stable_family<- subset (checkv_overall_stable_family, select = -c(Family,length))
checkv_overall_stable2_family <- subset(checkv_overall_stable_family, rownames(checkv_overall_stable_family) %in% checkv_overall_family)
checkv_overall_stable2_family <- subset(checkv_overall_stable2_family , select = c(P01_SC,P02_SC,P03_SC,P04_SC,P05_SC,P06_SC,P07_SC,P08_SC,P09_SC,P10_SC,P11_SC,P12_SC,P13_SC,P14_SC,P15_SC,P16_SC, P17_SC,P18_SC,P19_SC,P20_SC,P21_SC,P22_SC,P23_SC,P24_SC,P25_SC,P26_SC,P27_SC,P28_SC,P29_SC,P30_SC,P31_SC,P32_SC,P34_SC,P35_SC,P36_SC,P37_SC,P38_SC,P39_SC,P40_SC,P41_SC,P42_SC,P43_SC))
checkv_overall_stable2_family<-as.matrix(checkv_overall_stable2_family)
checkv_overall_stable2_family<- t(checkv_overall_stable2_family)

col_fun = colorRamp2(c(0, 4), c("white", "#000033"))
col_fun2 = colorRamp2(c(0, 4), c("#000033", "#66CCFF"))

Heatmap(checkv_overall_stable2_family, name = "Presence Over Time", row_title = "Subject", column_title_side = "bottom", row_dend_width = unit(2, "cm"), cluster_columns = FALSE, col = col_fun2, column_names_rot = 45)


checkv_overall <- c("Autographa californica multiple nucleopolyhedrovirus", "Autographa californica nucleopolyhedrovirus", "Staphylococcus phage St 134", "Unclassified Caudovirales", "Unclassified Homo sapiens like virus", "Unclassified Siphoviridae", "Uncultured Caudovirales phage")
checkv_overall_stable_Species <- OTU_Stable
checkv_overall_stable_Species$Species->row.names(checkv_overall_stable_Species)
checkv_overall_stable_Species<- subset (checkv_overall_stable_Species, select = -c(Species,length))
checkv_overall_stable2_Species <- subset(checkv_overall_stable_Species, rownames(checkv_overall_stable_Species) %in% checkv_overall)
checkv_overall_stable2_Species <- subset(checkv_overall_stable2_Species , select = c(P01_SC,P02_SC,P03_SC,P04_SC,P05_SC,P06_SC,P07_SC,P08_SC,P09_SC,P10_SC,P11_SC,P12_SC,P13_SC,P14_SC,P15_SC,P16_SC, P17_SC,P18_SC,P19_SC,P20_SC,P21_SC,P22_SC,P23_SC,P24_SC,P25_SC,P26_SC,P27_SC,P28_SC,P29_SC,P30_SC,P31_SC,P32_SC,P34_SC,P35_SC,P36_SC,P37_SC,P38_SC,P39_SC,P40_SC,P41_SC,P42_SC,P43_SC))
checkv_overall_stable2_Species<-as.matrix(checkv_overall_stable2_Species)
checkv_overall_stable2_Species<- t(checkv_overall_stable2_Species)

Heatmap(checkv_overall_stable2_Species, name = "Presence Over Time", row_title = "Subject", column_title_side = "bottom", row_dend_width = unit(2, "cm"), cluster_columns = FALSE, col = col_fun2, column_names_rot = 45)


checkv_overall_stable2_Species <- subset(checkv_overall_stable2_Species , select = c(P01_LH,P02_LH,P03_LH,P04_LH,P05_LH,P06_LH,P07_LH,P08_LH,P09_LH,P10_LH,P11_LH,P12_LH,P13_LH,P14_LH,P15_LH,P16_LH, P17_LH,P18_LH,P19_LH,P20_LH,P21_LH,P22_LH,P23_LH,P24_LH,P25_LH,P26_LH,P27_LH,P28_LH,P29_LH,P30_LH,P31_LH,P32_LH,P34_LH,P35_LH,P36_LH,P37_LH,P38_LH,P39_LH,P40_LH,P41_LH,P42_LH,P43_LH,P01_RH,P02_RH,P03_RH,P04_RH,P05_RH,P06_RH,P07_RH,P08_RH,P09_RH,P10_RH,P11_RH,P12_RH,P13_RH,P14_RH,P15_RH,P16_RH, P17_RH,P18_RH,P19_RH,P20_RH,P21_RH,P22_RH,P23_RH,P24_RH,P25_RH,P26_RH,P27_RH,P28_RH,P29_RH,P30_RH,P31_RH,P32_RH,P34_RH,P35_RH,P36_RH,P37_RH,P38_RH,P39_RH,P40_RH,P41_RH,P42_RH,P43_RH))

```

```{r}
#P01 Left
OTU_SUMS$P01_LH <- OTU_SUMS$HV_001_01 + OTU_SUMS$HV_002_01 + OTU_SUMS$HV_003_01 + OTU_SUMS$HV_004_01 + OTU_SUMS$HV_005_01
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_01,HV_002_01,HV_003_01,HV_004_01,HV_005_01 ))
#P01 Right
OTU_SUMS$P01_RH <- OTU_SUMS$HV_001_02 + OTU_SUMS$HV_002_02 + OTU_SUMS$HV_003_02 + OTU_SUMS$HV_004_02
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_02,HV_002_02,HV_003_02,HV_004_02 ))
#P01 Scalp
OTU_SUMS$P01_SC <- OTU_SUMS$HV_001_03 + OTU_SUMS$HV_004_03 + OTU_SUMS$HV_003_03 + OTU_SUMS$HV_005_03 + OTU_SUMS$HV_002_03
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_03,HV_002_03,HV_003_03,HV_004_03,HV_005_03 ))

#P02 Left
OTU_SUMS$P02_LH <- OTU_SUMS$HV_001_04 + OTU_SUMS$HV_002_04 + OTU_SUMS$HV_003_04 + OTU_SUMS$HV_004_04 + OTU_SUMS$HV_005_04
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_04,HV_002_04,HV_003_04,HV_004_04,HV_005_04 ))
#P02 Right
OTU_SUMS$P02_RH <- OTU_SUMS$HV_001_05 + OTU_SUMS$HV_002_05  + OTU_SUMS$HV_003_05 +OTU_SUMS$HV_004_05 + OTU_SUMS$HV_005_05
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_05,HV_002_05,HV_004_05,HV_005_05,HV_003_05 ))


#P02 Scalp
OTU_SUMS$P02_SC <- OTU_SUMS$HV_001_06 + OTU_SUMS$HV_002_06 + OTU_SUMS$HV_003_06 + OTU_SUMS$HV_004_06 + OTU_SUMS$HV_005_06
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_06,HV_002_06,HV_003_06,HV_004_06,HV_005_06 ))

#P03 Left
OTU_SUMS$P03_LH <- OTU_SUMS$HV_001_07 + OTU_SUMS$HV_002_07 + OTU_SUMS$HV_003_07 + OTU_SUMS$HV_004_07 + OTU_SUMS$HV_005_07
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_07,HV_002_07,HV_003_07,HV_004_07,HV_005_07 ))
#P03 Right
OTU_SUMS$P03_RH <- OTU_SUMS$HV_001_08 + OTU_SUMS$HV_002_08 + OTU_SUMS$HV_003_08 + OTU_SUMS$HV_004_08 + OTU_SUMS$HV_005_08
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_08,HV_002_08,HV_003_08,HV_004_08,HV_005_08 ))
#P03 Scalp
OTU_SUMS$P03_SC <- OTU_SUMS$HV_001_09 + OTU_SUMS$HV_002_09 + OTU_SUMS$HV_003_09 + OTU_SUMS$HV_004_09 + OTU_SUMS$HV_005_09
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_09,HV_002_09,HV_003_09,HV_004_09,HV_005_09 ))

#P04 Left
OTU_SUMS$P04_LH <- OTU_SUMS$HV_001_10 + OTU_SUMS$HV_002_10 + OTU_SUMS$HV_003_10 + OTU_SUMS$HV_004_10 + OTU_SUMS$HV_005_10
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_10,HV_002_10,HV_003_10,HV_004_10,HV_005_10 ))
#P04 Right
OTU_SUMS$P04_RH <- OTU_SUMS$HV_001_11 + OTU_SUMS$HV_002_11 + OTU_SUMS$HV_003_11 + OTU_SUMS$HV_004_11 + OTU_SUMS$HV_005_11
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_11,HV_002_11,HV_003_11,HV_004_11,HV_005_11 ))
#P04 Scalp
OTU_SUMS$P04_SC <- OTU_SUMS$HV_001_12 + OTU_SUMS$HV_002_12 + OTU_SUMS$HV_003_12 + OTU_SUMS$HV_004_12 + OTU_SUMS$HV_005_12
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_12,HV_002_12,HV_003_12,HV_004_12,HV_005_12 ))

#P05 Left
OTU_SUMS$P05_LH <- OTU_SUMS$HV_001_13 + OTU_SUMS$HV_002_13 + OTU_SUMS$HV_003_13 + OTU_SUMS$HV_004_13 + OTU_SUMS$HV_005_13
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_13,HV_002_13,HV_003_13,HV_004_13,HV_005_13 ))
#P05 Right
OTU_SUMS$P05_RH <- OTU_SUMS$HV_001_14 + OTU_SUMS$HV_002_14 + OTU_SUMS$HV_003_14 + OTU_SUMS$HV_004_14 + OTU_SUMS$HV_005_14
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_14,HV_002_14,HV_003_14,HV_004_14,HV_005_14 ))
#P05 Scalp
OTU_SUMS$P05_SC <- OTU_SUMS$HV_001_15 + OTU_SUMS$HV_002_15 +OTU_SUMS$HV_003_15+ OTU_SUMS$HV_004_15 + OTU_SUMS$HV_005_15
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_15,HV_002_15,HV_004_15,HV_005_15,HV_003_15 ))
#removed  OTU_SUMS$HV_003_15

#P06 Left
OTU_SUMS$P06_LH <- OTU_SUMS$HV_001_16 + OTU_SUMS$HV_003_16 + OTU_SUMS$HV_004_16 + OTU_SUMS$HV_005_16
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_16,HV_003_16,HV_004_16,HV_005_16 ))
#P06 Right
OTU_SUMS$P06_RH <- OTU_SUMS$HV_001_18 + OTU_SUMS$HV_002_18 + OTU_SUMS$HV_003_18 + OTU_SUMS$HV_004_18 + OTU_SUMS$HV_005_18
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_18,HV_002_18,HV_003_18,HV_004_18,HV_005_18 ))
#P06 Scalp
OTU_SUMS$P06_SC <- OTU_SUMS$HV_001_19 + OTU_SUMS$HV_002_19 + OTU_SUMS$HV_003_19 + OTU_SUMS$HV_004_19 + OTU_SUMS$HV_005_19
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_19,HV_002_19,HV_003_19,HV_004_19,HV_005_19 ))

#P07 Left
OTU_SUMS$P07_LH <- OTU_SUMS$HV_001_20 + OTU_SUMS$HV_002_20 + OTU_SUMS$HV_003_20 + OTU_SUMS$HV_004_20 + OTU_SUMS$HV_005_20
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_20,HV_002_20,HV_003_20,HV_004_20,HV_005_20 ))
#P07 Right
OTU_SUMS$P07_RH <- OTU_SUMS$HV_001_21 + OTU_SUMS$HV_002_21 + OTU_SUMS$HV_003_21 + OTU_SUMS$HV_004_21 
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_21,HV_002_21,HV_003_21,HV_004_21 ))
#P07 Scalp
OTU_SUMS$P07_SC <- OTU_SUMS$HV_001_22 + OTU_SUMS$HV_002_22 + OTU_SUMS$HV_003_22 + OTU_SUMS$HV_004_22 + OTU_SUMS$HV_005_22
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_001_22,HV_002_22,HV_003_22,HV_004_22,HV_005_22 ))


#P08 Left
OTU_SUMS$P08_LH <- OTU_SUMS$HV_006_01 + OTU_SUMS$HV_007_01 + OTU_SUMS$HV_008_01 + OTU_SUMS$HV_009_01 + OTU_SUMS$HV_010_01
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_01,HV_007_01,HV_008_01,HV_009_01,HV_010_01))
#P08 Right
OTU_SUMS$P08_RH <- OTU_SUMS$HV_006_02 + OTU_SUMS$HV_007_02 + OTU_SUMS$HV_008_02 + OTU_SUMS$HV_010_02
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_02,HV_007_02,HV_008_02,HV_010_02))
#P08 Scalp
OTU_SUMS$P08_SC <- OTU_SUMS$HV_006_03 + OTU_SUMS$HV_007_03 + OTU_SUMS$HV_008_03 + OTU_SUMS$HV_009_03 + OTU_SUMS$HV_010_03
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_03,HV_007_03,HV_008_03,HV_009_03,HV_010_03))

#P09 Left
OTU_SUMS$P09_LH <- OTU_SUMS$HV_006_04 + OTU_SUMS$HV_007_04 + OTU_SUMS$HV_008_04 + OTU_SUMS$HV_009_04 + OTU_SUMS$HV_010_04
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_04,HV_007_04,HV_008_04,HV_009_04,HV_010_04))
#P09 Right
OTU_SUMS$P09_RH <- OTU_SUMS$HV_006_05 + OTU_SUMS$HV_007_05 + OTU_SUMS$HV_008_05 + OTU_SUMS$HV_009_05 + OTU_SUMS$HV_010_05
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_05,HV_007_05,HV_008_05,HV_009_05,HV_010_05))
#P09 Scalp
OTU_SUMS$P09_SC <- OTU_SUMS$HV_006_06 + OTU_SUMS$HV_007_06 + OTU_SUMS$HV_008_06 + OTU_SUMS$HV_009_06 + OTU_SUMS$HV_010_06
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_06,HV_007_06,HV_008_06,HV_009_06,HV_010_06))

#P10 Left
OTU_SUMS$P10_LH <- OTU_SUMS$HV_006_07 + OTU_SUMS$HV_007_07 + OTU_SUMS$HV_008_07 + OTU_SUMS$HV_009_07 + OTU_SUMS$HV_010_07
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_07,HV_007_07,HV_008_07,HV_009_07,HV_010_07))
#P10 Right
OTU_SUMS$P10_RH <- OTU_SUMS$HV_006_08 + OTU_SUMS$HV_007_08 + OTU_SUMS$HV_008_08 + OTU_SUMS$HV_009_08 + OTU_SUMS$HV_010_08
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_08,HV_007_08,HV_008_08,HV_009_08,HV_010_08))
#P10 Scalp
OTU_SUMS$P10_SC <- OTU_SUMS$HV_006_09 + OTU_SUMS$HV_007_09 + OTU_SUMS$HV_008_09 + OTU_SUMS$HV_009_09 + OTU_SUMS$HV_010_09
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_09,HV_007_09,HV_008_09,HV_009_09,HV_010_09))

#P11 Left
OTU_SUMS$P11_LH <- OTU_SUMS$HV_006_10 + OTU_SUMS$HV_007_10 + OTU_SUMS$HV_008_10 + OTU_SUMS$HV_009_10 + OTU_SUMS$HV_010_10
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_10,HV_007_10,HV_008_10,HV_009_10,HV_010_10))
#P11 Right
OTU_SUMS$P11_RH <- OTU_SUMS$HV_006_11 + OTU_SUMS$HV_007_11 + OTU_SUMS$HV_008_11 + OTU_SUMS$HV_009_11 + OTU_SUMS$HV_010_11
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_11,HV_007_11,HV_008_11,HV_009_11,HV_010_11))
#P11 Scalp
OTU_SUMS$P11_SC <- OTU_SUMS$HV_006_12 + OTU_SUMS$HV_007_12 + OTU_SUMS$HV_008_12 + OTU_SUMS$HV_009_12 + OTU_SUMS$HV_010_12
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_12,HV_007_12,HV_008_12,HV_009_12,HV_010_12))

#P12 Left
OTU_SUMS$P12_LH <- OTU_SUMS$HV_006_13 + OTU_SUMS$HV_007_13 + OTU_SUMS$HV_008_13 + OTU_SUMS$HV_009_13 + OTU_SUMS$HV_010_13
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_13,HV_007_13,HV_008_13,HV_009_13,HV_010_13))
#P12 Right
OTU_SUMS$P12_RH <- OTU_SUMS$HV_006_14 + OTU_SUMS$HV_007_14 + OTU_SUMS$HV_008_14 + OTU_SUMS$HV_009_14 + OTU_SUMS$HV_010_14
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_14,HV_007_14,HV_008_14,HV_009_14,HV_010_14))
#P12 Scalp
OTU_SUMS$P12_SC <- OTU_SUMS$HV_006_15 + OTU_SUMS$HV_007_15 + OTU_SUMS$HV_008_15 + OTU_SUMS$HV_009_15 + OTU_SUMS$HV_010_15
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_15,HV_007_15,HV_008_15,HV_009_15,HV_010_15))

#P13 Left
OTU_SUMS$P13_LH <- OTU_SUMS$HV_006_16 + OTU_SUMS$HV_007_16 + OTU_SUMS$HV_008_16 + OTU_SUMS$HV_009_16 + OTU_SUMS$HV_010_16
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_16,HV_007_16,HV_008_16,HV_009_16,HV_010_16))
#P13 Right
OTU_SUMS$P13_RH <- OTU_SUMS$HV_006_18 + OTU_SUMS$HV_007_18 + OTU_SUMS$HV_008_18 + OTU_SUMS$HV_009_18 + OTU_SUMS$HV_010_18
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_18,HV_007_18,HV_008_18,HV_009_18,HV_010_18))
#P13 Scalp
OTU_SUMS$P13_SC <- OTU_SUMS$HV_006_19 + OTU_SUMS$HV_007_19 + OTU_SUMS$HV_008_19 + OTU_SUMS$HV_009_19 + OTU_SUMS$HV_010_19
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_19,HV_007_19,HV_008_19,HV_009_19,HV_010_19))

#P14 Left
OTU_SUMS$P14_LH <- OTU_SUMS$HV_006_20 + OTU_SUMS$HV_007_20 + OTU_SUMS$HV_008_20 + OTU_SUMS$HV_009_20 + OTU_SUMS$HV_010_20
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_20,HV_007_20,HV_008_20,HV_009_20,HV_010_20))
#P14 Right
OTU_SUMS$P14_RH <- OTU_SUMS$HV_006_21 + OTU_SUMS$HV_007_21 + OTU_SUMS$HV_008_21 + OTU_SUMS$HV_009_21 + OTU_SUMS$HV_010_21
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_21,HV_007_21,HV_008_21,HV_009_21,HV_010_21))
#P14 Scalp
OTU_SUMS$P14_SC <- OTU_SUMS$HV_006_22 + OTU_SUMS$HV_007_22 + OTU_SUMS$HV_008_22 + OTU_SUMS$HV_009_22 + OTU_SUMS$HV_010_22
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_006_22,HV_007_22,HV_008_22,HV_009_22,HV_010_22))

#P15 Left
OTU_SUMS$P15_LH <- OTU_SUMS$HV_011_01 + OTU_SUMS$HV_012_01 + OTU_SUMS$HV_013_01 + OTU_SUMS$HV_014_01 + OTU_SUMS$HV_015_01
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_01,HV_012_01,HV_013_01,HV_014_01,HV_015_01))
#P15 Right
OTU_SUMS$P15_RH <- OTU_SUMS$HV_011_02 + OTU_SUMS$HV_012_02 + OTU_SUMS$HV_013_02 + OTU_SUMS$HV_014_02 + OTU_SUMS$HV_015_02
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_02,HV_012_02,HV_013_02,HV_014_02,HV_015_02))
#P15 Scalp
OTU_SUMS$P15_SC <- OTU_SUMS$HV_011_03 + OTU_SUMS$HV_012_03 + OTU_SUMS$HV_013_03 + OTU_SUMS$HV_014_03 + OTU_SUMS$HV_015_03
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_03,HV_012_03,HV_013_03,HV_014_03,HV_015_03))

#P16 Left
OTU_SUMS$P16_LH <- OTU_SUMS$HV_011_04 + OTU_SUMS$HV_012_04 + OTU_SUMS$HV_013_04 + OTU_SUMS$HV_014_04 + OTU_SUMS$HV_015_04
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_04,HV_012_04,HV_013_04,HV_014_04,HV_015_04))
#P16 Right
OTU_SUMS$P16_RH <- OTU_SUMS$HV_011_05 + OTU_SUMS$HV_012_05 + OTU_SUMS$HV_013_05 + OTU_SUMS$HV_014_05 + OTU_SUMS$HV_015_05
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_05,HV_012_05,HV_013_05,HV_014_05,HV_015_05))
#P16 Scalp
OTU_SUMS$P16_SC <- OTU_SUMS$HV_011_06 + OTU_SUMS$HV_012_06 ++ OTU_SUMS$HV_014_06 + OTU_SUMS$HV_015_06
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_06,HV_012_06,HV_014_06,HV_015_06))

#P17 Left
OTU_SUMS$P17_LH <- OTU_SUMS$HV_011_07 + OTU_SUMS$HV_012_07 + OTU_SUMS$HV_013_07 + OTU_SUMS$HV_014_07 + OTU_SUMS$HV_015_07
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_07,HV_012_07,HV_013_07,HV_014_07,HV_015_07))
#P17 Right
OTU_SUMS$P17_RH <- OTU_SUMS$HV_011_08 + OTU_SUMS$HV_012_08 + OTU_SUMS$HV_013_08 + OTU_SUMS$HV_014_08 + OTU_SUMS$HV_015_08
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_08,HV_012_08,HV_013_08,HV_014_08,HV_015_08))
#P17 Scalp
OTU_SUMS$P17_SC <- OTU_SUMS$HV_011_09 + OTU_SUMS$HV_012_09 + OTU_SUMS$HV_013_09 + OTU_SUMS$HV_014_09 + OTU_SUMS$HV_015_09
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_09,HV_012_09,HV_013_09,HV_014_09,HV_015_09))

#P18 Left
OTU_SUMS$P18_LH <- OTU_SUMS$HV_011_10 + OTU_SUMS$HV_012_10 + OTU_SUMS$HV_013_10 + OTU_SUMS$HV_014_10 + OTU_SUMS$HV_015_10
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_10,HV_012_10,HV_013_10,HV_014_10,HV_015_10))
#P18 Right
OTU_SUMS$P18_RH <- OTU_SUMS$HV_011_11 + OTU_SUMS$HV_012_11 + OTU_SUMS$HV_013_11 + OTU_SUMS$HV_014_11 + OTU_SUMS$HV_015_11
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_11,HV_012_11,HV_013_11,HV_014_11,HV_015_11))
#P18 Scalp
OTU_SUMS$P18_SC <- OTU_SUMS$HV_011_12 + OTU_SUMS$HV_012_12 + OTU_SUMS$HV_013_12 + OTU_SUMS$HV_014_12 + OTU_SUMS$HV_015_12
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_12,HV_012_12,HV_013_12,HV_014_12,HV_015_12))

#P19 Left
OTU_SUMS$P19_LH <- OTU_SUMS$HV_011_13 + OTU_SUMS$HV_012_13 + OTU_SUMS$HV_013_13 + OTU_SUMS$HV_014_13 + OTU_SUMS$HV_015_13
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_13,HV_012_13,HV_013_13,HV_014_13,HV_015_13))
#P19 Right
OTU_SUMS$P19_RH <- OTU_SUMS$HV_011_14 + OTU_SUMS$HV_012_14 + OTU_SUMS$HV_013_14 + OTU_SUMS$HV_014_14 + OTU_SUMS$HV_015_14
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_14,HV_012_14,HV_013_14,HV_014_14,HV_015_14))
#P19 Scalp
OTU_SUMS$P19_SC <- OTU_SUMS$HV_011_15 + OTU_SUMS$HV_012_15 + OTU_SUMS$HV_013_15 + OTU_SUMS$HV_014_15 + OTU_SUMS$HV_015_15
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_15,HV_012_15,HV_013_15,HV_014_15,HV_015_15))

#P20 Left
OTU_SUMS$P20_LH <- OTU_SUMS$HV_011_16 + OTU_SUMS$HV_012_16 + OTU_SUMS$HV_013_16 + OTU_SUMS$HV_014_16 + OTU_SUMS$HV_015_16
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_16,HV_012_16,HV_013_16,HV_014_16,HV_015_16))
#P20 Right
OTU_SUMS$P20_RH <- OTU_SUMS$HV_011_18 + OTU_SUMS$HV_012_18 + OTU_SUMS$HV_013_18 + OTU_SUMS$HV_014_18 + OTU_SUMS$HV_015_18
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_18,HV_012_18,HV_013_18,HV_014_18,HV_015_18))
#P20 Scalp
OTU_SUMS$P20_SC <- OTU_SUMS$HV_011_19 + OTU_SUMS$HV_012_19 + OTU_SUMS$HV_013_19 + OTU_SUMS$HV_014_19 + OTU_SUMS$HV_015_19
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_19,HV_012_19,HV_013_19,HV_014_19,HV_015_19))

#P21 Left
OTU_SUMS$P21_LH <- OTU_SUMS$HV_011_20 + OTU_SUMS$HV_012_20 + OTU_SUMS$HV_013_20 + OTU_SUMS$HV_014_20
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_20,HV_012_20,HV_013_20,HV_014_20))
#P21 Right
OTU_SUMS$P21_RH <- OTU_SUMS$HV_011_21 + OTU_SUMS$HV_012_21 + OTU_SUMS$HV_013_21 + OTU_SUMS$HV_014_21
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_21,HV_012_21,HV_013_21,HV_014_21))
#P21 Scalp
OTU_SUMS$P21_SC <- OTU_SUMS$HV_011_22 + OTU_SUMS$HV_012_22 + OTU_SUMS$HV_013_22 + OTU_SUMS$HV_014_22
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_011_22,HV_012_22,HV_013_22,HV_014_22))

#P22 Left
OTU_SUMS$P22_LH <- OTU_SUMS$HV_021_02 + OTU_SUMS$HV_022_01 + OTU_SUMS$HV_023_01 + OTU_SUMS$HV_024_01 + OTU_SUMS$HV_025_02
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_02,HV_022_01,HV_023_01,HV_024_01,HV_025_02))
#P22 Right
OTU_SUMS$P22_RH <- OTU_SUMS$HV_026_01 + OTU_SUMS$HV_027_08 + OTU_SUMS$HV_028_01 + OTU_SUMS$HV_029_01 + OTU_SUMS$HV_030_01
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_01,HV_027_08,HV_028_01,HV_029_01,HV_030_01))
#P22 Scalp
OTU_SUMS$P22_SC <- OTU_SUMS$HV_016_01 + OTU_SUMS$HV_017_01 + OTU_SUMS$HV_018_01 + OTU_SUMS$HV_019_01 + OTU_SUMS$HV_020_01
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_01,HV_017_01,HV_018_01,HV_019_01,HV_020_01))

#P23 Left
OTU_SUMS$P23_LH <- OTU_SUMS$HV_021_03 + OTU_SUMS$HV_022_02 + OTU_SUMS$HV_023_02 + OTU_SUMS$HV_024_02 + OTU_SUMS$HV_025_03
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_03,HV_022_02,HV_023_02,HV_024_02,HV_025_03))
#P23 Right
OTU_SUMS$P23_RH <- OTU_SUMS$HV_026_02 + OTU_SUMS$HV_027_09 + OTU_SUMS$HV_028_02 + OTU_SUMS$HV_029_02 + OTU_SUMS$HV_030_02
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_02,HV_027_09,HV_028_02,HV_029_02,HV_030_02))
#P23 Scalp
OTU_SUMS$P23_SC <- OTU_SUMS$HV_016_02 + OTU_SUMS$HV_017_02 + OTU_SUMS$HV_018_02 + OTU_SUMS$HV_019_02 + OTU_SUMS$HV_020_02
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_02,HV_017_02,HV_018_02,HV_019_02,HV_020_02))

#P24 Left
OTU_SUMS$P24_LH <- OTU_SUMS$HV_021_04 + OTU_SUMS$HV_022_03 + OTU_SUMS$HV_023_03 + OTU_SUMS$HV_024_03 + OTU_SUMS$HV_025_04
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_04,HV_022_03,HV_023_03,HV_024_03,HV_025_04))
#P24 Right
OTU_SUMS$P24_RH <- OTU_SUMS$HV_026_03 + OTU_SUMS$HV_027_10 + OTU_SUMS$HV_028_03 + OTU_SUMS$HV_029_03 + OTU_SUMS$HV_030_03
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_03,HV_027_10,HV_028_03,HV_029_03,HV_030_03))
#P24 Scalp
OTU_SUMS$P24_SC <- OTU_SUMS$HV_016_03 + OTU_SUMS$HV_017_03 + OTU_SUMS$HV_018_03 + OTU_SUMS$HV_019_03 + OTU_SUMS$HV_021_01
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_03,HV_017_03,HV_018_03,HV_019_03,HV_021_01))

#P25 Left
OTU_SUMS$P25_LH <- OTU_SUMS$HV_021_05 + OTU_SUMS$HV_022_04 + OTU_SUMS$HV_023_04 + OTU_SUMS$HV_024_04 + OTU_SUMS$HV_025_05
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_05,HV_022_04,HV_023_04,HV_024_04,HV_025_05))
#P25 Right
OTU_SUMS$P25_RH <- OTU_SUMS$HV_026_04 + OTU_SUMS$HV_027_11 + OTU_SUMS$HV_028_04 + OTU_SUMS$HV_029_04 + OTU_SUMS$HV_030_04
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_04,HV_027_11,HV_028_04,HV_029_04,HV_030_04))
#P25 Scalp
OTU_SUMS$P25_SC <- OTU_SUMS$HV_016_04 + OTU_SUMS$HV_017_04 + OTU_SUMS$HV_018_04 + OTU_SUMS$HV_019_04 + OTU_SUMS$HV_020_03
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_04,HV_017_04,HV_018_04,HV_019_04,HV_020_03))

#P26 Left
OTU_SUMS$P26_LH <- OTU_SUMS$HV_021_06 + OTU_SUMS$HV_022_05 + OTU_SUMS$HV_023_05 + OTU_SUMS$HV_024_05 + OTU_SUMS$HV_025_06
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_06,HV_022_05,HV_023_05,HV_024_05,HV_025_06))
#P26 Right
OTU_SUMS$P26_RH <- OTU_SUMS$HV_026_05 + OTU_SUMS$HV_027_12 + OTU_SUMS$HV_028_05 + OTU_SUMS$HV_029_05 + OTU_SUMS$HV_030_05
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_05,HV_027_12,HV_028_05,HV_029_05,HV_030_05))
#P26 Scalp
OTU_SUMS$P26_SC <- OTU_SUMS$HV_016_05 + OTU_SUMS$HV_017_05 + OTU_SUMS$HV_018_05 + OTU_SUMS$HV_019_05 + OTU_SUMS$HV_020_04
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_05,HV_017_05,HV_018_05,HV_019_05,HV_020_04))

#P27 Left
OTU_SUMS$P27_LH <- OTU_SUMS$HV_021_07 + OTU_SUMS$HV_022_06 + OTU_SUMS$HV_023_06 + OTU_SUMS$HV_024_06 + OTU_SUMS$HV_025_07
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_07,HV_022_06,HV_023_06,HV_024_06,HV_025_07))
#P27 Right
OTU_SUMS$P27_RH <- OTU_SUMS$HV_026_06 + OTU_SUMS$HV_027_13 + OTU_SUMS$HV_028_06 + OTU_SUMS$HV_029_06 + OTU_SUMS$HV_030_06
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_06,HV_027_13,HV_028_06,HV_029_06,HV_030_06))
#P27 Scalp
OTU_SUMS$P27_SC <- OTU_SUMS$HV_016_06 + OTU_SUMS$HV_017_06 + OTU_SUMS$HV_018_06 + OTU_SUMS$HV_019_06 + OTU_SUMS$HV_020_05
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_06,HV_017_06,HV_018_06,HV_019_06,HV_020_05))

#P28 Left
OTU_SUMS$P28_LH <- OTU_SUMS$HV_021_08 + OTU_SUMS$HV_022_07 + OTU_SUMS$HV_023_07 + OTU_SUMS$HV_024_07 + OTU_SUMS$HV_025_08
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_08,HV_022_07,HV_023_07,HV_024_07,HV_025_08))
#P28 Right
OTU_SUMS$P28_RH <- OTU_SUMS$HV_026_07 + OTU_SUMS$HV_027_14 + OTU_SUMS$HV_028_07 + OTU_SUMS$HV_029_07 + OTU_SUMS$HV_030_07
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_07,HV_027_14,HV_028_07,HV_029_07,HV_030_07))
#P28 Scalp
OTU_SUMS$P28_SC <- OTU_SUMS$HV_016_07 + OTU_SUMS$HV_017_07 + OTU_SUMS$HV_018_07 + OTU_SUMS$HV_019_07 + OTU_SUMS$HV_020_06
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_07,HV_017_07,HV_018_07,HV_019_07,HV_020_06))

#P29 Left
OTU_SUMS$P29_LH <- OTU_SUMS$HV_021_09 + OTU_SUMS$HV_022_08 + OTU_SUMS$HV_023_08 + OTU_SUMS$HV_024_08 + OTU_SUMS$HV_025_09
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_09,HV_022_08,HV_023_08,HV_024_08,HV_025_09))
#P29 Right
OTU_SUMS$P29_RH <- OTU_SUMS$HV_026_08 + OTU_SUMS$HV_027_15 + OTU_SUMS$HV_028_08 + OTU_SUMS$HV_029_08 + OTU_SUMS$HV_030_08
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_08,HV_027_15,HV_028_08,HV_029_08,HV_030_08))
#P29 Scalp
OTU_SUMS$P29_SC <- OTU_SUMS$HV_016_08 + OTU_SUMS$HV_017_08 + OTU_SUMS$HV_018_08 + OTU_SUMS$HV_019_08 + OTU_SUMS$HV_020_07
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_08,HV_017_08,HV_018_08,HV_019_08,HV_020_07))

#P30 Left
OTU_SUMS$P30_LH <- OTU_SUMS$HV_021_10 + OTU_SUMS$HV_022_09 + OTU_SUMS$HV_023_09 + OTU_SUMS$HV_024_09 + OTU_SUMS$HV_025_10
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_10,HV_022_09,HV_023_09,HV_024_09,HV_025_10))
#P30 Right
OTU_SUMS$P30_RH <- OTU_SUMS$HV_026_09 + OTU_SUMS$HV_027_16 + OTU_SUMS$HV_028_09 + OTU_SUMS$HV_029_09 + OTU_SUMS$HV_030_09
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_09,HV_027_16,HV_028_09,HV_029_09,HV_030_09))
#P30 Scalp
OTU_SUMS$P30_SC <- OTU_SUMS$HV_016_09 + OTU_SUMS$HV_017_09 + OTU_SUMS$HV_018_09 + OTU_SUMS$HV_019_09 + OTU_SUMS$HV_020_08
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_09,HV_017_09,HV_018_09,HV_019_09,HV_020_08))

#P31 Left
OTU_SUMS$P31_LH <- OTU_SUMS$HV_021_11 + OTU_SUMS$HV_022_10 + OTU_SUMS$HV_023_10 + OTU_SUMS$HV_024_10
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_11,HV_022_10,HV_023_10,HV_024_10))
#P31 Right
OTU_SUMS$P31_RH <- OTU_SUMS$HV_026_10 + OTU_SUMS$HV_027_18 + OTU_SUMS$HV_028_10 + OTU_SUMS$HV_029_10
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_10,HV_027_18,HV_028_10,HV_029_10))
#P31 Scalp
OTU_SUMS$P31_SC <- OTU_SUMS$HV_016_10 + OTU_SUMS$HV_017_10 + OTU_SUMS$HV_018_10 + OTU_SUMS$HV_019_10
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_10,HV_017_10,HV_018_10,HV_019_10))

#P32 Left
OTU_SUMS$P32_LH <- OTU_SUMS$HV_021_12 + OTU_SUMS$HV_022_11 + OTU_SUMS$HV_023_11 + OTU_SUMS$HV_024_11 + OTU_SUMS$HV_025_11
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_12,HV_022_11,HV_023_11,HV_024_11,HV_025_11))
#P32 Right
OTU_SUMS$P32_RH <- OTU_SUMS$HV_026_11 + OTU_SUMS$HV_027_19 + OTU_SUMS$HV_028_11 + OTU_SUMS$HV_029_11 + OTU_SUMS$HV_030_10
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_11,HV_027_19,HV_028_11,HV_029_11,HV_030_10))
#P32 Scalp
OTU_SUMS$P32_SC <- OTU_SUMS$HV_016_11 + OTU_SUMS$HV_017_11 + OTU_SUMS$HV_018_11 + OTU_SUMS$HV_019_11 + OTU_SUMS$HV_020_09
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_11,HV_017_11,HV_018_11,HV_019_11,HV_020_09))

#P34 Left
OTU_SUMS$P34_LH <- OTU_SUMS$HV_021_14 + OTU_SUMS$HV_022_12 + OTU_SUMS$HV_023_12 + OTU_SUMS$HV_024_12 + OTU_SUMS$HV_025_12
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_14,HV_022_12,HV_023_12,HV_024_12,HV_025_12))
#P34 Right
OTU_SUMS$P34_RH <- OTU_SUMS$HV_026_12 + OTU_SUMS$HV_027_20 + OTU_SUMS$HV_028_12 + OTU_SUMS$HV_029_12 + OTU_SUMS$HV_030_11
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_12,HV_027_20,HV_028_12,HV_029_12,HV_030_11))
#P34 Scalp
OTU_SUMS$P34_SC <- OTU_SUMS$HV_016_12 + OTU_SUMS$HV_017_12 + OTU_SUMS$HV_018_12 + OTU_SUMS$HV_019_12 + OTU_SUMS$HV_020_11
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_12,HV_017_12,HV_018_12,HV_019_12,HV_020_11))

#P35 Left
OTU_SUMS$P35_LH <- OTU_SUMS$HV_021_15 + OTU_SUMS$HV_022_13 + OTU_SUMS$HV_023_13 + OTU_SUMS$HV_024_13 + OTU_SUMS$HV_025_13
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_15,HV_022_13,HV_023_13,HV_024_13,HV_025_13))
#P35 Right
OTU_SUMS$P35_RH <- OTU_SUMS$HV_026_13 + OTU_SUMS$HV_027_21 + OTU_SUMS$HV_028_13 + OTU_SUMS$HV_029_13 + OTU_SUMS$HV_030_12
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_13,HV_027_21,HV_028_13,HV_029_13,HV_030_12))
#P35 Scalp
OTU_SUMS$P35_SC <- OTU_SUMS$HV_016_13 + OTU_SUMS$HV_017_13 + OTU_SUMS$HV_018_13 + OTU_SUMS$HV_019_13 + OTU_SUMS$HV_020_12
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_13,HV_017_13,HV_018_13,HV_019_13,HV_020_12))

#P36 Left
OTU_SUMS$P36_LH <- OTU_SUMS$HV_021_16 + OTU_SUMS$HV_022_14 + OTU_SUMS$HV_023_14 + OTU_SUMS$HV_024_14 + OTU_SUMS$HV_025_14
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_16,HV_022_14,HV_023_14,HV_024_14,HV_025_14))
#P36 Right
OTU_SUMS$P36_RH <- OTU_SUMS$HV_026_14 + OTU_SUMS$HV_027_22 + OTU_SUMS$HV_028_14 + OTU_SUMS$HV_029_14 + OTU_SUMS$HV_030_13
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_14,HV_027_22,HV_028_14,HV_029_14,HV_030_13))
#P36 Scalp
OTU_SUMS$P36_SC <- OTU_SUMS$HV_016_14 + OTU_SUMS$HV_017_14 + OTU_SUMS$HV_018_14 + OTU_SUMS$HV_019_14 + OTU_SUMS$HV_020_13
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_14,HV_017_14,HV_018_14,HV_019_14,HV_020_13))

#P37 Left
OTU_SUMS$P37_LH <- OTU_SUMS$HV_021_18 + OTU_SUMS$HV_022_15 + OTU_SUMS$HV_023_15 + OTU_SUMS$HV_024_15 + OTU_SUMS$HV_025_15
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_18,HV_022_15,HV_023_15,HV_024_15,HV_025_15))
#P37 Right
OTU_SUMS$P37_RH <- OTU_SUMS$HV_026_15 + OTU_SUMS$HV_028_15 + OTU_SUMS$HV_029_15 + OTU_SUMS$HV_030_14 + OTU_SUMS$HV_030_22
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_15,HV_028_15,HV_029_15,HV_030_14,HV_030_22))
#P37 Scalp
OTU_SUMS$P37_SC <- OTU_SUMS$HV_016_15 + OTU_SUMS$HV_017_15 + OTU_SUMS$HV_018_15 + OTU_SUMS$HV_019_15 + OTU_SUMS$HV_020_14
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_15,HV_017_15,HV_018_15,HV_019_15,HV_020_14))

#P38 Left
OTU_SUMS$P38_LH <- OTU_SUMS$HV_021_19 + OTU_SUMS$HV_022_16 + OTU_SUMS$HV_023_16 + OTU_SUMS$HV_024_16 + OTU_SUMS$HV_025_16
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_19,HV_022_16,HV_023_16,HV_024_16,HV_025_16))
#P38 Right
OTU_SUMS$P38_RH <- OTU_SUMS$HV_026_16 + OTU_SUMS$HV_028_16 + OTU_SUMS$HV_029_16 + OTU_SUMS$HV_030_15 
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_16,HV_028_16,HV_029_16,HV_030_15))
#P38 Scalp
OTU_SUMS$P38_SC <- OTU_SUMS$HV_016_16 + OTU_SUMS$HV_017_16 + OTU_SUMS$HV_018_16 + OTU_SUMS$HV_019_16 + OTU_SUMS$HV_020_15
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_16,HV_017_16,HV_018_16,HV_019_16,HV_020_15))

#P39 Left
OTU_SUMS$P39_LH <- OTU_SUMS$HV_021_20 + OTU_SUMS$HV_022_18 + OTU_SUMS$HV_023_18 + OTU_SUMS$HV_024_18 + OTU_SUMS$HV_025_18
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_20,HV_022_18,HV_023_18,HV_024_18,HV_025_18))
#P39 Right
OTU_SUMS$P39_RH <- OTU_SUMS$HV_026_18 + OTU_SUMS$HV_028_18 + OTU_SUMS$HV_029_18 + OTU_SUMS$HV_030_16
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_18,HV_028_18,HV_029_18,HV_030_16))
#P39 Scalp
OTU_SUMS$P39_SC <- OTU_SUMS$HV_016_18 + OTU_SUMS$HV_017_18 + OTU_SUMS$HV_018_18 + OTU_SUMS$HV_019_18 + OTU_SUMS$HV_020_16
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_18,HV_017_18,HV_018_18,HV_019_18,HV_020_16))

#P40 Left
OTU_SUMS$P40_LH <- OTU_SUMS$HV_021_21 + OTU_SUMS$HV_022_19 + OTU_SUMS$HV_023_19 + OTU_SUMS$HV_024_19 + OTU_SUMS$HV_025_19
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_21,HV_022_19,HV_023_19,HV_024_19,HV_025_19))
#P40 Right
OTU_SUMS$P40_RH <- OTU_SUMS$HV_026_19 + OTU_SUMS$HV_028_19 + OTU_SUMS$HV_029_19 + OTU_SUMS$HV_030_18
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_19,HV_028_19,HV_029_19,HV_030_18))
#P40 Scalp
OTU_SUMS$P40_SC <- OTU_SUMS$HV_016_19 + OTU_SUMS$HV_017_19 + OTU_SUMS$HV_018_19 + OTU_SUMS$HV_019_19 + OTU_SUMS$HV_020_18
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_19,HV_017_19,HV_018_19,HV_019_19,HV_020_18))

#P41 Left
OTU_SUMS$P41_LH <- OTU_SUMS$HV_021_22 + OTU_SUMS$HV_022_20 + OTU_SUMS$HV_023_20 + OTU_SUMS$HV_024_20 + OTU_SUMS$HV_025_20
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_021_22,HV_022_20,HV_023_20,HV_024_20,HV_025_20))
#P41 Right
OTU_SUMS$P41_RH <- OTU_SUMS$HV_026_20 + OTU_SUMS$HV_028_20 + OTU_SUMS$HV_029_20 + OTU_SUMS$HV_030_19
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_20,HV_028_20,HV_029_20,HV_030_19))
#P41 Scalp
OTU_SUMS$P41_SC <- OTU_SUMS$HV_016_20 + OTU_SUMS$HV_017_20 + OTU_SUMS$HV_018_20 + OTU_SUMS$HV_019_20 + OTU_SUMS$HV_020_19
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_20,HV_017_20,HV_018_20,HV_019_20,HV_020_19))

#P42 Left
OTU_SUMS$P42_LH <- OTU_SUMS$HV_022_21 + OTU_SUMS$HV_023_21 + OTU_SUMS$HV_024_21 + OTU_SUMS$HV_025_21 
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_022_21,HV_023_21,HV_024_21,HV_025_21))
#P42 Right
OTU_SUMS$P42_RH <- OTU_SUMS$HV_026_21 + OTU_SUMS$HV_028_21 + OTU_SUMS$HV_029_21 + OTU_SUMS$HV_030_20
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_21,HV_028_21,HV_029_21,HV_030_20))
#P42 Scalp
OTU_SUMS$P42_SC <- OTU_SUMS$HV_016_21 + OTU_SUMS$HV_017_21 + OTU_SUMS$HV_018_21 + OTU_SUMS$HV_019_21 + OTU_SUMS$HV_020_20
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_21,HV_017_21,HV_018_21,HV_019_21,HV_020_20))

#P43 Left
OTU_SUMS$P43_LH <- OTU_SUMS$HV_022_22 + OTU_SUMS$HV_023_22 + OTU_SUMS$HV_024_22 + OTU_SUMS$HV_025_01 + OTU_SUMS$HV_025_22
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_022_22,HV_023_22,HV_024_22,HV_025_01,HV_025_22))
#P43 Right
OTU_SUMS$P43_RH <- OTU_SUMS$HV_026_22 + OTU_SUMS$HV_028_22 + OTU_SUMS$HV_029_22 + OTU_SUMS$HV_030_21
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_026_22,HV_028_22,HV_029_22,HV_030_21))
#P43 Scalp
OTU_SUMS$P43_SC <- OTU_SUMS$HV_016_22 + OTU_SUMS$HV_017_22 + OTU_SUMS$HV_018_22 + OTU_SUMS$HV_019_22 + OTU_SUMS$HV_020_21
OTU_SUMS <- subset(OTU_SUMS, select = -c(HV_016_22,HV_017_22,HV_018_22,HV_019_22,HV_020_21))






#genomo

```

#genomo
```{r}
#pap_counts_1 <- read_delim("Genomovir/counts2_genomovir_edited.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
#write_csv(pap_counts_1, 'Genomovir/counts2_genomovir_edited.csv')
GENOTU_counts <- read.csv("Genomovir/counts2_genomovir_edited.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
GENOTU_counts -> OTU
gen_taxa <- read.csv("Genomovir/genomovir_taxa.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
OTU_SUMS <- cbind(gen_taxa, OTU, by="row.names")
OTU_SUMS<- subset (OTU_SUMS, select = -c(Superkingdom, Realm, Kingdom, Phylum, Class, Order, Family, Subfamily, Genus))
OTU_SUMS<-ddply(OTU_SUMS,"Species",numcolwise(sum))
OTU_SUMS<- subset (OTU_SUMS, select = -c(HV_027_01,HV_027_02,HV_027_03,HV_027_04,HV_027_05,HV_027_06,HV_027_07,HV_015_20, HV_015_21, HV_020_10, HV_020_22, HV_021_13))
```


#baculo
```{r}
BACOTU_counts <- read.csv("Baculo/counts2_baculo_edited.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
BACOTU_counts -> OTU
OTU_SUMS <- OTU
bac_taxa <- read.csv("Baculo/baculo_taxa.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
OTU_SUMS <- cbind(bac_taxa, OTU_SUMS, by="row.names")
OTU_SUMS<- subset (OTU_SUMS, select = -c(Superkingdom, Realm, Kingdom, Phylum, Class, Order, Family, Subfamily, Genus, Isolate ))
OTU_SUMS<-ddply(OTU_SUMS,"Species",numcolwise(sum))
OTU_SUMS<- subset (OTU_SUMS, select = -c(HV_027_01,HV_027_02,HV_027_03,HV_027_04,HV_027_05,HV_027_06,HV_027_07,HV_015_20, HV_015_21, HV_020_10, HV_020_22, HV_021_13))

#heatmap

bac_overall<-c("Autographa californica multiple nucleopolyhedrovirus", "Chrysodeixis chalcites nucleopolyhedrovirus", "Cryptophlebia leucotreta granulovirus", "Dasychira pudibunda nucleopolyhedrovirus", "Malacosoma neustria nucleopolyhedrovirus", "Unclassified Baculoviridae")
Bac_overall_stable <- OTU_Stable
Bac_overall_stable$Species->row.names(Bac_overall_stable)
Bac_overall_stable<- subset (Bac_overall_stable, select = -c(Species))
Bac_overall_stable2 <- subset(Bac_overall_stable, rownames(Bac_overall_stable) %in% bac_overall)
Bac_overall_stable2<-as.matrix(Bac_overall_stable2)
Bac_overall_stable2<- t(Bac_overall_stable2)

Bac_overall_stable <- subset(Bac_overall_stable, select = c(P01_LH,P02_LH,P03_LH,P04_LH,P05_LH,P06_LH,P07_LH,P08_LH,P09_LH,P10_LH,P11_LH,P12_LH,P13_LH,P14_LH,P15_LH,P16_LH, P17_LH,P18_LH,P19_LH,P20_LH,P21_LH,P22_LH,P23_LH,P24_LH,P25_LH,P26_LH,P27_LH,P28_LH,P29_LH,P30_LH,P31_LH,P32_LH,P34_LH,P35_LH,P36_LH,P37_LH,P38_LH,P39_LH,P40_LH,P41_LH,P42_LH,P43_LH))


col_fun = colorRamp2(c(0, 4), c("white", "#000033"))
col_fun2 = colorRamp2(c(0, 4), c("#000033", "#66CCFF"))
Heatmap(Bac_overall_stable2, name = "Relative Abundance", column_title = "Subject", row_title = "Viral Contig", column_title_side = "bottom", row_dend_width = unit(2, "cm"), column_dend_height = unit(2, "cm"),  col = col_fun2)
Heatmap(Bac_overall_stable2, name = "Relative Abundance", column_title = "Subject", row_title = "Viral Contig", column_title_side = "bottom", row_dend_width = unit(2, "cm"), column_dend_height = unit(2, "cm"),  col = col_fun)
Heatmap(Bac_overall_stable2, name = "Relative Abundance", column_title = "Subject", row_title = "Viral Contig", column_title_side = "bottom", row_dend_width = unit(2, "cm"), column_dend_height = unit(2, "cm"))
```
#papilloma
```{r}
PAPOTU_counts <- read.csv("papilloma/PAPcounts.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
#PAPOTU_counts <- read.csv("papilloma/counts2_papilloma_1x.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
PAPOTU_counts -> OTU
OTU <- subset(OTU, select = -c(length))
OTU_SUMS <- OTU
#OTU_SUMS$ContigID <- row.names(OTU_SUMS)
#OTU_SUMS<- subset (OTU_SUMS, select = -c(HV_027_01,HV_027_02,HV_027_03,HV_027_04,HV_027_05,HV_027_06,HV_027_07,HV_001_01.sorted.bam))
#OTU_SUMS<- subset (OTU_SUMS, select = -c(HV_027_01,HV_027_02,HV_027_03,HV_027_04,HV_027_05,HV_027_06,HV_027_07,HV_001_01.sorted.bam, HV_015_20, HV_015_21, HV_020_10, HV_020_22, HV_021_13))

pap_taxa <- read.csv("papilloma/papilloma_taxa.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
OTU_SUMS <- cbind(pap_taxa, OTU, by="row.names")
OTU_SUMS<- subset (OTU_SUMS, select = -c(Superkingdom, Realm, Kingdom, Phylum, Class, Order, Genus, Subfamily, Family))
OTU_SUMS<-ddply(OTU_SUMS,"Species",numcolwise(sum))
OTU_SUMS<- subset (OTU_SUMS, select = -c(HV_027_01,HV_027_02,HV_027_03,HV_027_04,HV_027_05,HV_027_06,HV_027_07,HV_001_01.sorted.bam, HV_015_20, HV_015_21, HV_020_10, HV_020_22, HV_021_13))
#OTU_SUMS<- subset (OTU_SUMS, select = -c(HV_027_01,HV_027_02,HV_027_03,HV_027_04,HV_027_05,HV_027_06,HV_027_07, HV_015_20, HV_015_21, HV_020_10, HV_020_22, HV_021_13))

pap_overall<-c("Betapapillomavirus 1","Betapapillomavirus 2", "Betapapillomavirus 3", "Gammapapillomavirus 1", "Gammapapillomavirus 12", "Gammapapillomavirus 13", "Gammapapillomavirus 22", "Gammapapillomavirus 7", "Gammapapillomavirus 8")

pap_overall<-c("Betapapillomavirus 2", "Betapapillomavirus 3", "Gammapapillomavirus 7")

Papilloma_overall_stable <- OTU_Stable
Papilloma_overall_stable$Species->row.names(Papilloma_overall_stable)
Papilloma_overall_stable<- subset (Papilloma_overall_stable, select = -c(Species))
Papilloma_overall_stable2 <- subset(Papilloma_overall_stable, rownames(Papilloma_overall_stable) %in% pap_overall)
Papilloma_overall_stable2 <- subset(Papilloma_overall_stable2, select = c(P01_LH,P02_LH,P03_LH,P04_LH,P05_LH,P06_LH,P07_LH,P08_LH,P09_LH,P10_LH,P11_LH,P12_LH,P13_LH,P14_LH,P15_LH,P16_LH, P17_LH,P18_LH,P19_LH,P20_LH,P21_LH,P22_LH,P23_LH,P24_LH,P25_LH,P26_LH,P27_LH,P28_LH,P29_LH,P30_LH,P31_LH,P32_LH,P34_LH,P35_LH,P36_LH,P37_LH,P38_LH,P39_LH,P40_LH,P41_LH,P42_LH,P43_LH,P01_RH,P02_RH,P03_RH,P04_RH,P05_RH,P06_RH,P07_RH,P08_RH,P09_RH,P10_RH,P11_RH,P12_RH,P13_RH,P14_RH,P15_RH,P16_RH, P17_RH,P18_RH,P19_RH,P20_RH,P21_RH,P22_RH,P23_RH,P24_RH,P25_RH,P26_RH,P27_RH,P28_RH,P29_RH,P30_RH,P31_RH,P32_RH,P34_RH,P35_RH,P36_RH,P37_RH,P38_RH,P39_RH,P40_RH,P41_RH,P42_RH,P43_RH))
Papilloma_overall_stable2<-as.matrix(Papilloma_overall_stable2)
Papilloma_overall_stable2<- t(Papilloma_overall_stable2)

Heatmap(Papilloma_overall_stable2, name = "Presence Over Time", row_title = "Subject", column_title_side = "bottom", row_dend_width = unit(2, "cm"), cluster_columns = FALSE, col = col_fun2, column_names_rot = 45)

#Papilloma_overall_stable2 <- subset(Papilloma_overall_stable2, select = c(P01_LH,P02_LH,P03_LH,P04_LH,P05_LH,P06_LH,P07_LH,P08_LH,P09_LH,P10_LH,P11_LH,P12_LH,P13_LH,P14_LH,P15_LH,P16_LH, P17_LH,P18_LH,P19_LH,P20_LH,P21_LH,P22_LH,P23_LH,P24_LH,P25_LH,P26_LH,P27_LH,P28_LH,P29_LH,P30_LH,P31_LH,P32_LH,P34_LH,P35_LH,P36_LH,P37_LH,P38_LH,P39_LH,P40_LH,P41_LH,P42_LH,P43_LH,P01_RH,P02_RH,P03_RH,P04_RH,P05_RH,P06_RH,P07_RH,P08_RH,P09_RH,P10_RH,P11_RH,P12_RH,P13_RH,P14_RH,P15_RH,P16_RH, P17_RH,P18_RH,P19_RH,P20_RH,P21_RH,P22_RH,P23_RH,P24_RH,P25_RH,P26_RH,P27_RH,P28_RH,P29_RH,P30_RH,P31_RH,P32_RH,P34_RH,P35_RH,P36_RH,P37_RH,P38_RH,P39_RH,P40_RH,P41_RH,P42_RH,P43_RH))


pap_overall_genus<-c("Betapapillomavirus","Gammapapillomavirus")
Papilloma_overall_stable_genus <- OTU_Stable
Papilloma_overall_stable_genus$Genus->row.names(Papilloma_overall_stable_genus)
Papilloma_overall_stable_genus<- subset (Papilloma_overall_stable_genus, select = -c(Genus))
Papilloma_overall_stable2_genus <- subset(Papilloma_overall_stable_genus, rownames(Papilloma_overall_stable_genus) %in% pap_overall_genus)
Papilloma_overall_stable2_genus<-as.matrix(Papilloma_overall_stable2_genus)
Papilloma_overall_stable2_genus<- t(Papilloma_overall_stable2_genus)

col_fun = colorRamp2(c(0, 4), c("white", "#000033"))
col_fun2 = colorRamp2(c(0, 4), c("#000033", "#66CCFF"))

Heatmap(Papilloma_overall_stable2, name = "Presence Over Time", row_title = "Subject", column_title_side = "bottom", row_dend_width = unit(2, "cm"), cluster_columns = FALSE, col = col_fun2, column_names_rot = 45)

Heatmap(Papilloma_overall_stable2, name = "Relative Abundance", row_title = "Subject", column_title_side = "bottom", row_dend_width = unit(2, "cm"), cluster_columns = FALSE, col = col_fun2, column_names_rot = 45)
Heatmap(Papilloma_overall_stable2, name = "Relative Abundance", column_title = "Subject", row_title = "Viral Contig", column_title_side = "bottom", row_dend_width = unit(2, "cm"), column_dend_height = unit(2, "cm"),  col = col_fun)
Heatmap(Papilloma_overall_stable2, name = "Relative Abundance", column_title = "Subject", row_title = "Viral Contig", column_title_side = "bottom", row_dend_width = unit(2, "cm"), column_dend_height = unit(2, "cm"))
```
#CAUDO
```{r}
#PAPOTU_counts <- read.csv("counts2_CAUDO.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
#PAPOTU_counts -> OTU
OTU <- read.csv("CAUDO_counts2_1x_final.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
OTU <- subset(OTU, select = -c(length))
OTU_SUMS <- OTU
#OTU_SUMS$ContigID <- row.names(OTU_SUMS)
#View(caud_taxa)
caud_taxa <- read.csv("CAUDO_tax.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
OTU_SUMS <- merge(caud_taxa, OTU_SUMS, by.x="row.names", by.y="row.names")
OTU_SUMS<- subset (OTU_SUMS, select = -c(Superkingdom, Realm, Kingdom, Phylum, Class, Order, Family, Subfamily, Species))
OTU_SUMS<-ddply(OTU_SUMS,"Genus",numcolwise(sum))
OTU_SUMS<- subset (OTU_SUMS, select = -c(HV_027_01,HV_027_02,HV_027_03,HV_027_04,HV_027_05,HV_027_06,HV_027_07,HV_015_21, HV_015_20, HV_020_10, HV_020_22,HV_021_13, HV_015_20, HV_015_21, HV_020_10, HV_020_22, HV_021_13))

Caudo_overall_stable<- OTU_Stable[OTU_Stable$Species %in% c("Bacillus phage Stitch", "Cellulophaga phage phi47:1","Marine virus AFVG_250M104", "Marine virus AFVG_25M557", "Staphylococcus phage CNPH82", "Staphylococcus phage CNPx", "Staphylococcus phage HOB 14.1.R1", "Staphylococcus phage PhiSepi-HH3", "Staphylococcus phage Pike", "Staphylococcus phage SPbeta-like", "Staphylococcus phage vB_SauH_DELF3", "Staphylococcus virus IPLA5", "Staphylococcus virus IPLA7", "Staphylococcus virus IPLAC1C", "Staphylococcus virus PH15", "Staphylococcus virus vB_SepS_27", "Staphylococcus virus vB_SepS_459", "Staphylococcus virus vB_SepS_E72", "Streptococcus phage phi-SC181", "Uncultured Caudovirales phage","Streptococcus phage phiJH1301-2"),]

Caudo_overall_stable <- subset(Caudo_overall_stable, select = c(P01_LH,P02_LH,P03_LH,P04_LH,P05_LH,P06_LH,P07_LH,P08_LH,P09_LH,P10_LH,P11_LH,P12_LH,P13_LH,P14_LH,P15_LH,P16_LH, P17_LH,P18_LH,P19_LH,P20_LH,P21_LH,P22_LH,P23_LH,P24_LH,P25_LH,P26_LH,P27_LH,P28_LH,P29_LH,P30_LH,P31_LH,P32_LH,P34_LH,P35_LH,P36_LH,P37_LH,P38_LH,P39_LH,P40_LH,P41_LH,P42_LH,P43_LH))


Caudo_overall_stable2$Species->row.names(Caudo_overall_stable2)
Caudo_overall_stable2<- subset (Caudo_overall_stable2, select = -c(Species))
Caudo_overall_stable2<-as.matrix(Caudo_overall_stable)
Caudo_overall_stable2<- t(Caudo_overall_stable2)
col_fun = colorRamp2(c(0, 4), c("white", "#000033"))
col_fun2 = colorRamp2(c(0, 4), c("#000033", "#66CCFF"))
Heatmap(Caudo_overall_stable2, name = "Relative Abundance", column_title = "Subject", row_title = "Viral Contig", column_title_side = "bottom", row_dend_width = unit(2, "cm"), column_dend_height = unit(2, "cm"),  col = col_fun2)
Heatmap(Caudo_overall_stable2, name = "Relative Abundance", column_title = "Subject", row_title = "Viral Contig", column_title_side = "bottom", row_dend_width = unit(2, "cm"), column_dend_height = unit(2, "cm"),  col = col_fun)
Heatmap(Caudo_overall_stable2, name = "Relative Abundance", column_title = "Subject", row_title = "Viral Contig", column_title_side = "bottom", row_dend_width = unit(2, "cm"), column_dend_height = unit(2, "cm"))
#library(ComplexHeatmap)
#library(circlize)
```


```{r}
profile <- rbind(Caudo_overall_stable, Papilloma_overall_stable2,checkv_overall_stable2)
profile2<-as.matrix(profile)
profile2<- t(profile2)
col_fun = colorRamp2(c(0, 4), c("white", "#000033"))
col_fun2 = colorRamp2(c(0, 4), c("#000033", "#66CCFF"))
Heatmap(profile2, name = "Prescence in 5 Time Points", row_title = "Subject", column_title_side = "bottom", row_dend_width = unit(2, "cm"), column_dend_height = unit(2, "cm"),  col = col_fun2)
Heatmap(profile2, name = "Relative Abundance", column_title = "Subject", row_title = "Viral Contig", column_title_side = "bottom", row_dend_width = unit(2, "cm"), column_dend_height = unit(2, "cm"),  col = col_fun)
Heatmap(profile2, name = "Relative Abundance", column_title = "Subject", row_title = "Viral Contig", column_title_side = "bottom", row_dend_width = unit(2, "cm"), column_dend_height = unit(2, "cm"))

Heatmap(profile2, name = "Relative Abundance", row_title = "Subject", column_title_side = "bottom", row_dend_width = unit(2, "cm"), cluster_columns = FALSE, col = col_fun2, column_names_rot = 45)
```
#Stable Table
```{r}
OTU_Stable <- OTU
OTU_Stable<-as.data.frame(OTU_Stable)
OTU_Stable$ContigID <- row.names(OTU_Stable)
#tax_ann$ContigID <- row.names(tax_ann)
OTU_Stable<- subset (OTU_Stable, select = -c(HV_001_27,HV_004_27,HV_005_27,HV_006_27,HV_007_27,HV_008_27,HV_009_27,HV_010_27,HV_011_27,HV_012_27,HV_013_27,HV_014_27,HV_015_20,HV_015_27,HV_016_27,HV_017_27,HV_018_27,HV_019_27,HV_020_10,HV_020_22,HV_020_27,HV_021_13,HV_021_27,HV_022_27,HV_023_27,HV_024_27,HV_025_27,HV_026_27,HV_027_01,HV_027_02,HV_027_03,HV_027_04,HV_027_05,HV_027_06,HV_027_07,HV_027_27,HV_028_27,HV_029_27,HV_030_27))
#HV_001_27
#OTU_Stable <- merge(tax_ann,OTU_Stable, by="row.names")
#OTU_Stable<- subset (OTU_Stable, select = -c(Superkingdom, Realm, Kingdom, Phylum, Class, Order, Genus, Subfamily, Species))
#OTU_Stable<-ddply(OTU_Stable,"Family",numcolwise(sum))

#OTU_Stable[OTU_Stable < 100] <- 0
OTU_Stable <- OTU_Stable %>% mutate_if(is.numeric, ~1 * (. != 0))

#OTU_Stable$ContigID -> row.names(OTU_Stable)

#tax_ann <- read.csv("vc_tax.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)

```
#Papilloma
```{r}
OTU_SUMS -> OTU_Stable 
#OTU_Stable[OTU_Stable < 100] <- 0
OTU_Stable <- OTU_Stable %>% mutate_if(is.numeric, ~1 * (. != 0))
```
#CAUDO
```{r}
OTU_SUMS -> OTU_Stable 
#OTU_Stable[OTU_Stable < 10] <- 0
OTU_Stable <- OTU_Stable %>% mutate_if(is.numeric, ~1 * (. != 0))
```

```{r}

#P01 Left
OTU_Stable$P01_LH <- OTU_Stable$HV_001_01 + OTU_Stable$HV_002_01 + OTU_Stable$HV_003_01 + OTU_Stable$HV_004_01 + OTU_Stable$HV_005_01
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_01,HV_002_01,HV_003_01,HV_004_01,HV_005_01 ))
#P01 Right
OTU_Stable$P01_RH <- OTU_Stable$HV_001_02 + OTU_Stable$HV_002_02 + OTU_Stable$HV_003_02 + OTU_Stable$HV_004_02
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_02,HV_002_02,HV_003_02,HV_004_02 ))
#P01 Scalp
OTU_Stable$P01_SC <- OTU_Stable$HV_001_03 + OTU_Stable$HV_004_03 + OTU_Stable$HV_003_03 + OTU_Stable$HV_005_03 + OTU_Stable$HV_002_03
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_03,HV_002_03,HV_003_03,HV_004_03,HV_005_03 ))

#P02 Left
OTU_Stable$P02_LH <- OTU_Stable$HV_001_04 + OTU_Stable$HV_002_04 + OTU_Stable$HV_003_04 + OTU_Stable$HV_004_04 + OTU_Stable$HV_005_04
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_04,HV_002_04,HV_003_04,HV_004_04,HV_005_04 ))
#P02 Right
OTU_Stable$P02_RH <- OTU_Stable$HV_001_05 + OTU_Stable$HV_002_05 + OTU_Stable$HV_003_05 + OTU_Stable$HV_004_05 + OTU_Stable$HV_005_05
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_05,HV_002_05,HV_003_05,HV_004_05,HV_005_05 ))
#P02 Scalp
OTU_Stable$P02_SC <- OTU_Stable$HV_001_06 + OTU_Stable$HV_002_06 + OTU_Stable$HV_003_06 + OTU_Stable$HV_004_06 + OTU_Stable$HV_005_06
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_06,HV_002_06,HV_003_06,HV_004_06,HV_005_06 ))

#P03 Left
OTU_Stable$P03_LH <- OTU_Stable$HV_001_07 + OTU_Stable$HV_002_07 + OTU_Stable$HV_003_07 + OTU_Stable$HV_004_07 + OTU_Stable$HV_005_07
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_07,HV_002_07,HV_003_07,HV_004_07,HV_005_07 ))
#P03 Right
OTU_Stable$P03_RH <- OTU_Stable$HV_001_08 + OTU_Stable$HV_002_08 + OTU_Stable$HV_003_08 + OTU_Stable$HV_004_08 + OTU_Stable$HV_005_08
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_08,HV_002_08,HV_003_08,HV_004_08,HV_005_08 ))
#P03 Scalp
OTU_Stable$P03_SC <- OTU_Stable$HV_001_09 + OTU_Stable$HV_002_09 + OTU_Stable$HV_003_09 + OTU_Stable$HV_004_09 + OTU_Stable$HV_005_09
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_09,HV_002_09,HV_003_09,HV_004_09,HV_005_09 ))

#P04 Left
OTU_Stable$P04_LH <- OTU_Stable$HV_001_10 + OTU_Stable$HV_002_10 + OTU_Stable$HV_003_10 + OTU_Stable$HV_004_10 + OTU_Stable$HV_005_10
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_10,HV_002_10,HV_003_10,HV_004_10,HV_005_10 ))
#P04 Right
OTU_Stable$P04_RH <- OTU_Stable$HV_001_11 + OTU_Stable$HV_002_11 + OTU_Stable$HV_003_11 + OTU_Stable$HV_004_11 + OTU_Stable$HV_005_11
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_11,HV_002_11,HV_003_11,HV_004_11,HV_005_11 ))
#P04 Scalp
OTU_Stable$P04_SC <- OTU_Stable$HV_001_12 + OTU_Stable$HV_002_12 + OTU_Stable$HV_003_12 + OTU_Stable$HV_004_12 + OTU_Stable$HV_005_12
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_12,HV_002_12,HV_003_12,HV_004_12,HV_005_12 ))


#P05 Left
OTU_Stable$P05_LH <- OTU_Stable$HV_001_13 + OTU_Stable$HV_002_13 + OTU_Stable$HV_003_13 + OTU_Stable$HV_004_13 + OTU_Stable$HV_005_13
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_13,HV_002_13,HV_003_13,HV_004_13,HV_005_13 ))
#P05 Right
OTU_Stable$P05_RH <- OTU_Stable$HV_001_14 + OTU_Stable$HV_002_14 + OTU_Stable$HV_003_14 + OTU_Stable$HV_004_14 + OTU_Stable$HV_005_14
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_14,HV_002_14,HV_003_14,HV_004_14,HV_005_14 ))
#P05 Scalp
OTU_Stable$P05_SC <- OTU_Stable$HV_001_15 + OTU_Stable$HV_002_15  + OTU_Stable$HV_004_15+OTU_Stable$HV_003_15 + OTU_Stable$HV_005_15
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_15,HV_002_15,HV_004_15,HV_005_15,HV_003_15 ))
# removed OTU_Stable$HV_003_15

#P06 Left
OTU_Stable$P06_LH <- OTU_Stable$HV_001_16 + OTU_Stable$HV_003_16 + OTU_Stable$HV_004_16 + OTU_Stable$HV_005_16
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_16,HV_003_16,HV_004_16,HV_005_16 ))
#P06 Right
OTU_Stable$P06_RH <- OTU_Stable$HV_001_18 + OTU_Stable$HV_002_18 + OTU_Stable$HV_003_18 + OTU_Stable$HV_004_18 + OTU_Stable$HV_005_18
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_18,HV_002_18,HV_003_18,HV_004_18,HV_005_18 ))
#P06 Scalp
OTU_Stable$P06_SC <- OTU_Stable$HV_001_19 + OTU_Stable$HV_002_19 + OTU_Stable$HV_003_19 + OTU_Stable$HV_004_19 + OTU_Stable$HV_005_19
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_19,HV_002_19,HV_003_19,HV_004_19,HV_005_19 ))

#P07 Left
OTU_Stable$P07_LH <- OTU_Stable$HV_001_20 + OTU_Stable$HV_002_20 + OTU_Stable$HV_003_20 + OTU_Stable$HV_004_20 + OTU_Stable$HV_005_20
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_20,HV_002_20,HV_003_20,HV_004_20,HV_005_20 ))
#P07 Right
OTU_Stable$P07_RH <- OTU_Stable$HV_001_21 + OTU_Stable$HV_002_21 + OTU_Stable$HV_003_21 + OTU_Stable$HV_004_21 
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_21,HV_002_21,HV_003_21,HV_004_21 ))
#P07 Scalp
OTU_Stable$P07_SC <- OTU_Stable$HV_001_22 + OTU_Stable$HV_002_22 + OTU_Stable$HV_003_22 + OTU_Stable$HV_004_22 + OTU_Stable$HV_005_22
OTU_Stable <- subset(OTU_Stable, select = -c(HV_001_22,HV_002_22,HV_003_22,HV_004_22,HV_005_22 ))


#P08 Left
OTU_Stable$P08_LH <- OTU_Stable$HV_006_01 + OTU_Stable$HV_007_01 + OTU_Stable$HV_008_01 + OTU_Stable$HV_009_01 + OTU_Stable$HV_010_01
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_01,HV_007_01,HV_008_01,HV_009_01,HV_010_01))
#P08 Right
OTU_Stable$P08_RH <- OTU_Stable$HV_006_02 + OTU_Stable$HV_007_02 + OTU_Stable$HV_008_02 + OTU_Stable$HV_010_02
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_02,HV_007_02,HV_008_02,HV_010_02))
#P08 Scalp
OTU_Stable$P08_SC <- OTU_Stable$HV_006_03 + OTU_Stable$HV_007_03 + OTU_Stable$HV_008_03 + OTU_Stable$HV_009_03 + OTU_Stable$HV_010_03
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_03,HV_007_03,HV_008_03,HV_009_03,HV_010_03))

#P09 Left
OTU_Stable$P09_LH <- OTU_Stable$HV_006_04 + OTU_Stable$HV_007_04 + OTU_Stable$HV_008_04 + OTU_Stable$HV_009_04 + OTU_Stable$HV_010_04
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_04,HV_007_04,HV_008_04,HV_009_04,HV_010_04))
#P09 Right
OTU_Stable$P09_RH <- OTU_Stable$HV_006_05 + OTU_Stable$HV_007_05 + OTU_Stable$HV_008_05 + OTU_Stable$HV_009_05 + OTU_Stable$HV_010_05
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_05,HV_007_05,HV_008_05,HV_009_05,HV_010_05))
#P09 Scalp
OTU_Stable$P09_SC <- OTU_Stable$HV_006_06 + OTU_Stable$HV_007_06 + OTU_Stable$HV_008_06 + OTU_Stable$HV_009_06 + OTU_Stable$HV_010_06
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_06,HV_007_06,HV_008_06,HV_009_06,HV_010_06))

#P10 Left
OTU_Stable$P10_LH <- OTU_Stable$HV_006_07 + OTU_Stable$HV_007_07 + OTU_Stable$HV_008_07 + OTU_Stable$HV_009_07 + OTU_Stable$HV_010_07
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_07,HV_007_07,HV_008_07,HV_009_07,HV_010_07))
#P10 Right
OTU_Stable$P10_RH <- OTU_Stable$HV_006_08 + OTU_Stable$HV_007_08 + OTU_Stable$HV_008_08 + OTU_Stable$HV_009_08 + OTU_Stable$HV_010_08
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_08,HV_007_08,HV_008_08,HV_009_08,HV_010_08))
#P10 Scalp
OTU_Stable$P10_SC <- OTU_Stable$HV_006_09 + OTU_Stable$HV_007_09 + OTU_Stable$HV_008_09 + OTU_Stable$HV_009_09 + OTU_Stable$HV_010_09
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_09,HV_007_09,HV_008_09,HV_009_09,HV_010_09))

#P11 Left
OTU_Stable$P11_LH <- OTU_Stable$HV_006_10 + OTU_Stable$HV_007_10 + OTU_Stable$HV_008_10 + OTU_Stable$HV_009_10 + OTU_Stable$HV_010_10
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_10,HV_007_10,HV_008_10,HV_009_10,HV_010_10))
#P11 Right
OTU_Stable$P11_RH <- OTU_Stable$HV_006_11 + OTU_Stable$HV_007_11 + OTU_Stable$HV_008_11 + OTU_Stable$HV_009_11 + OTU_Stable$HV_010_11
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_11,HV_007_11,HV_008_11,HV_009_11,HV_010_11))
#P11 Scalp
OTU_Stable$P11_SC <- OTU_Stable$HV_006_12 + OTU_Stable$HV_007_12 + OTU_Stable$HV_008_12 + OTU_Stable$HV_009_12 + OTU_Stable$HV_010_12
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_12,HV_007_12,HV_008_12,HV_009_12,HV_010_12))

#P12 Left
OTU_Stable$P12_LH <- OTU_Stable$HV_006_13 + OTU_Stable$HV_007_13 + OTU_Stable$HV_008_13 + OTU_Stable$HV_009_13 + OTU_Stable$HV_010_13
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_13,HV_007_13,HV_008_13,HV_009_13,HV_010_13))
#P12 Right
OTU_Stable$P12_RH <- OTU_Stable$HV_006_14 + OTU_Stable$HV_007_14 + OTU_Stable$HV_008_14 + OTU_Stable$HV_009_14 + OTU_Stable$HV_010_14
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_14,HV_007_14,HV_008_14,HV_009_14,HV_010_14))
#P12 Scalp
OTU_Stable$P12_SC <- OTU_Stable$HV_006_15 + OTU_Stable$HV_007_15 + OTU_Stable$HV_008_15 + OTU_Stable$HV_009_15 + OTU_Stable$HV_010_15
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_15,HV_007_15,HV_008_15,HV_009_15,HV_010_15))

#P13 Left
OTU_Stable$P13_LH <- OTU_Stable$HV_006_16 + OTU_Stable$HV_007_16 + OTU_Stable$HV_008_16 + OTU_Stable$HV_009_16 + OTU_Stable$HV_010_16
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_16,HV_007_16,HV_008_16,HV_009_16,HV_010_16))
#P13 Right
OTU_Stable$P13_RH <- OTU_Stable$HV_006_18 + OTU_Stable$HV_007_18 + OTU_Stable$HV_008_18 + OTU_Stable$HV_009_18 + OTU_Stable$HV_010_18
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_18,HV_007_18,HV_008_18,HV_009_18,HV_010_18))
#P13 Scalp
OTU_Stable$P13_SC <- OTU_Stable$HV_006_19 + OTU_Stable$HV_007_19 + OTU_Stable$HV_008_19 + OTU_Stable$HV_009_19 + OTU_Stable$HV_010_19
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_19,HV_007_19,HV_008_19,HV_009_19,HV_010_19))

#P14 Left
OTU_Stable$P14_LH <- OTU_Stable$HV_006_20 + OTU_Stable$HV_007_20 + OTU_Stable$HV_008_20 + OTU_Stable$HV_009_20 + OTU_Stable$HV_010_20
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_20,HV_007_20,HV_008_20,HV_009_20,HV_010_20))
#P14 Right
OTU_Stable$P14_RH <- OTU_Stable$HV_006_21 + OTU_Stable$HV_007_21 + OTU_Stable$HV_008_21 + OTU_Stable$HV_009_21 + OTU_Stable$HV_010_21
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_21,HV_007_21,HV_008_21,HV_009_21,HV_010_21))
#P14 Scalp
OTU_Stable$P14_SC <- OTU_Stable$HV_006_22 + OTU_Stable$HV_007_22 + OTU_Stable$HV_008_22 + OTU_Stable$HV_009_22 + OTU_Stable$HV_010_22
OTU_Stable <- subset(OTU_Stable, select = -c(HV_006_22,HV_007_22,HV_008_22,HV_009_22,HV_010_22))

#P15 Left
OTU_Stable$P15_LH <- OTU_Stable$HV_011_01 + OTU_Stable$HV_012_01 + OTU_Stable$HV_013_01 + OTU_Stable$HV_014_01 + OTU_Stable$HV_015_01
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_01,HV_012_01,HV_013_01,HV_014_01,HV_015_01))
#P15 Right
OTU_Stable$P15_RH <- OTU_Stable$HV_011_02 + OTU_Stable$HV_012_02 + OTU_Stable$HV_013_02 + OTU_Stable$HV_014_02 + OTU_Stable$HV_015_02
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_02,HV_012_02,HV_013_02,HV_014_02,HV_015_02))
#P15 Scalp
OTU_Stable$P15_SC <- OTU_Stable$HV_011_03 + OTU_Stable$HV_012_03 + OTU_Stable$HV_013_03 + OTU_Stable$HV_014_03 + OTU_Stable$HV_015_03
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_03,HV_012_03,HV_013_03,HV_014_03,HV_015_03))

#P16 Left
OTU_Stable$P16_LH <- OTU_Stable$HV_011_04 + OTU_Stable$HV_012_04 + OTU_Stable$HV_013_04 + OTU_Stable$HV_014_04 + OTU_Stable$HV_015_04
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_04,HV_012_04,HV_013_04,HV_014_04,HV_015_04))
#P16 Right
OTU_Stable$P16_RH <- OTU_Stable$HV_011_05 + OTU_Stable$HV_012_05 + OTU_Stable$HV_013_05 + OTU_Stable$HV_014_05 + OTU_Stable$HV_015_05
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_05,HV_012_05,HV_013_05,HV_014_05,HV_015_05))
#P16 Scalp
OTU_Stable$P16_SC <- OTU_Stable$HV_011_06 + OTU_Stable$HV_012_06 ++ OTU_Stable$HV_014_06 + OTU_Stable$HV_015_06
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_06,HV_012_06,HV_014_06,HV_015_06))

#P17 Left
OTU_Stable$P17_LH <- OTU_Stable$HV_011_07 + OTU_Stable$HV_012_07 + OTU_Stable$HV_013_07 + OTU_Stable$HV_014_07 + OTU_Stable$HV_015_07
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_07,HV_012_07,HV_013_07,HV_014_07,HV_015_07))
#P17 Right
OTU_Stable$P17_RH <- OTU_Stable$HV_011_08 + OTU_Stable$HV_012_08 + OTU_Stable$HV_013_08 + OTU_Stable$HV_014_08 + OTU_Stable$HV_015_08
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_08,HV_012_08,HV_013_08,HV_014_08,HV_015_08))
#P17 Scalp
OTU_Stable$P17_SC <- OTU_Stable$HV_011_09 + OTU_Stable$HV_012_09 + OTU_Stable$HV_013_09 + OTU_Stable$HV_014_09 + OTU_Stable$HV_015_09
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_09,HV_012_09,HV_013_09,HV_014_09,HV_015_09))

#P18 Left
OTU_Stable$P18_LH <- OTU_Stable$HV_011_10 + OTU_Stable$HV_012_10 + OTU_Stable$HV_013_10 + OTU_Stable$HV_014_10 + OTU_Stable$HV_015_10
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_10,HV_012_10,HV_013_10,HV_014_10,HV_015_10))
#P18 Right
OTU_Stable$P18_RH <- OTU_Stable$HV_011_11 + OTU_Stable$HV_012_11 + OTU_Stable$HV_013_11 + OTU_Stable$HV_014_11 + OTU_Stable$HV_015_11
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_11,HV_012_11,HV_013_11,HV_014_11,HV_015_11))
#P18 Scalp
OTU_Stable$P18_SC <- OTU_Stable$HV_011_12 + OTU_Stable$HV_012_12 + OTU_Stable$HV_013_12 + OTU_Stable$HV_014_12 + OTU_Stable$HV_015_12
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_12,HV_012_12,HV_013_12,HV_014_12,HV_015_12))

#P19 Left
OTU_Stable$P19_LH <- OTU_Stable$HV_011_13 + OTU_Stable$HV_012_13 + OTU_Stable$HV_013_13 + OTU_Stable$HV_014_13 + OTU_Stable$HV_015_13
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_13,HV_012_13,HV_013_13,HV_014_13,HV_015_13))
#P19 Right
OTU_Stable$P19_RH <- OTU_Stable$HV_011_14 + OTU_Stable$HV_012_14 + OTU_Stable$HV_013_14 + OTU_Stable$HV_014_14 + OTU_Stable$HV_015_14
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_14,HV_012_14,HV_013_14,HV_014_14,HV_015_14))
#P19 Scalp
OTU_Stable$P19_SC <- OTU_Stable$HV_011_15 + OTU_Stable$HV_012_15 + OTU_Stable$HV_013_15 + OTU_Stable$HV_014_15 + OTU_Stable$HV_015_15
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_15,HV_012_15,HV_013_15,HV_014_15,HV_015_15))

#P20 Left
OTU_Stable$P20_LH <- OTU_Stable$HV_011_16 + OTU_Stable$HV_012_16 + OTU_Stable$HV_013_16 + OTU_Stable$HV_014_16 + OTU_Stable$HV_015_16
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_16,HV_012_16,HV_013_16,HV_014_16,HV_015_16))
#P20 Right
OTU_Stable$P20_RH <- OTU_Stable$HV_011_18 + OTU_Stable$HV_012_18 + OTU_Stable$HV_013_18 + OTU_Stable$HV_014_18 + OTU_Stable$HV_015_18
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_18,HV_012_18,HV_013_18,HV_014_18,HV_015_18))
#P20 Scalp
OTU_Stable$P20_SC <- OTU_Stable$HV_011_19 + OTU_Stable$HV_012_19 + OTU_Stable$HV_013_19 + OTU_Stable$HV_014_19 + OTU_Stable$HV_015_19
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_19,HV_012_19,HV_013_19,HV_014_19,HV_015_19))

#P21 Left
OTU_Stable$P21_LH <- OTU_Stable$HV_011_20 + OTU_Stable$HV_012_20 + OTU_Stable$HV_013_20 + OTU_Stable$HV_014_20
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_20,HV_012_20,HV_013_20,HV_014_20))
#P21 Right
OTU_Stable$P21_RH <- OTU_Stable$HV_011_21 + OTU_Stable$HV_012_21 + OTU_Stable$HV_013_21 + OTU_Stable$HV_014_21
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_21,HV_012_21,HV_013_21,HV_014_21))
#P21 Scalp
OTU_Stable$P21_SC <- OTU_Stable$HV_011_22 + OTU_Stable$HV_012_22 + OTU_Stable$HV_013_22 + OTU_Stable$HV_014_22
OTU_Stable <- subset(OTU_Stable, select = -c(HV_011_22,HV_012_22,HV_013_22,HV_014_22))

#P22 Left
OTU_Stable$P22_LH <- OTU_Stable$HV_021_02 + OTU_Stable$HV_022_01 + OTU_Stable$HV_023_01 + OTU_Stable$HV_024_01 + OTU_Stable$HV_025_02
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_02,HV_022_01,HV_023_01,HV_024_01,HV_025_02))
#P22 Right
OTU_Stable$P22_RH <- OTU_Stable$HV_026_01 + OTU_Stable$HV_027_08 + OTU_Stable$HV_028_01 + OTU_Stable$HV_029_01 + OTU_Stable$HV_030_01
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_01,HV_027_08,HV_028_01,HV_029_01,HV_030_01))
#P22 Scalp
OTU_Stable$P22_SC <- OTU_Stable$HV_016_01 + OTU_Stable$HV_017_01 + OTU_Stable$HV_018_01 + OTU_Stable$HV_019_01 + OTU_Stable$HV_020_01
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_01,HV_017_01,HV_018_01,HV_019_01,HV_020_01))

#P23 Left
OTU_Stable$P23_LH <- OTU_Stable$HV_021_03 + OTU_Stable$HV_022_02 + OTU_Stable$HV_023_02 + OTU_Stable$HV_024_02 + OTU_Stable$HV_025_03
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_03,HV_022_02,HV_023_02,HV_024_02,HV_025_03))
#P23 Right
OTU_Stable$P23_RH <- OTU_Stable$HV_026_02 + OTU_Stable$HV_027_09 + OTU_Stable$HV_028_02 + OTU_Stable$HV_029_02 + OTU_Stable$HV_030_02
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_02,HV_027_09,HV_028_02,HV_029_02,HV_030_02))
#P23 Scalp
OTU_Stable$P23_SC <- OTU_Stable$HV_016_02 + OTU_Stable$HV_017_02 + OTU_Stable$HV_018_02 + OTU_Stable$HV_019_02 + OTU_Stable$HV_020_02
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_02,HV_017_02,HV_018_02,HV_019_02,HV_020_02))

#P24 Left
OTU_Stable$P24_LH <- OTU_Stable$HV_021_04 + OTU_Stable$HV_022_03 + OTU_Stable$HV_023_03 + OTU_Stable$HV_024_03 + OTU_Stable$HV_025_04
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_04,HV_022_03,HV_023_03,HV_024_03,HV_025_04))
#P24 Right
OTU_Stable$P24_RH <- OTU_Stable$HV_026_03 + OTU_Stable$HV_027_10 + OTU_Stable$HV_028_03 + OTU_Stable$HV_029_03 + OTU_Stable$HV_030_03
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_03,HV_027_10,HV_028_03,HV_029_03,HV_030_03))
#P24 Scalp
OTU_Stable$P24_SC <- OTU_Stable$HV_016_03 + OTU_Stable$HV_017_03 + OTU_Stable$HV_018_03 + OTU_Stable$HV_019_03 + OTU_Stable$HV_021_01
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_03,HV_017_03,HV_018_03,HV_019_03,HV_021_01))

#P25 Left
OTU_Stable$P25_LH <- OTU_Stable$HV_021_05 + OTU_Stable$HV_022_04 + OTU_Stable$HV_023_04 + OTU_Stable$HV_024_04 + OTU_Stable$HV_025_05
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_05,HV_022_04,HV_023_04,HV_024_04,HV_025_05))
#P25 Right
OTU_Stable$P25_RH <- OTU_Stable$HV_026_04 + OTU_Stable$HV_027_11 + OTU_Stable$HV_028_04 + OTU_Stable$HV_029_04 + OTU_Stable$HV_030_04
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_04,HV_027_11,HV_028_04,HV_029_04,HV_030_04))
#P25 Scalp
OTU_Stable$P25_SC <- OTU_Stable$HV_016_04 + OTU_Stable$HV_017_04 + OTU_Stable$HV_018_04 + OTU_Stable$HV_019_04 + OTU_Stable$HV_020_03
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_04,HV_017_04,HV_018_04,HV_019_04,HV_020_03))

#P26 Left
OTU_Stable$P26_LH <- OTU_Stable$HV_021_06 + OTU_Stable$HV_022_05 + OTU_Stable$HV_023_05 + OTU_Stable$HV_024_05 + OTU_Stable$HV_025_06
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_06,HV_022_05,HV_023_05,HV_024_05,HV_025_06))
#P26 Right
OTU_Stable$P26_RH <- OTU_Stable$HV_026_05 + OTU_Stable$HV_027_12 + OTU_Stable$HV_028_05 + OTU_Stable$HV_029_05 + OTU_Stable$HV_030_05
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_05,HV_027_12,HV_028_05,HV_029_05,HV_030_05))
#P26 Scalp
OTU_Stable$P26_SC <- OTU_Stable$HV_016_05 + OTU_Stable$HV_017_05 + OTU_Stable$HV_018_05 + OTU_Stable$HV_019_05 + OTU_Stable$HV_020_04
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_05,HV_017_05,HV_018_05,HV_019_05,HV_020_04))

#P27 Left
OTU_Stable$P27_LH <- OTU_Stable$HV_021_07 + OTU_Stable$HV_022_06 + OTU_Stable$HV_023_06 + OTU_Stable$HV_024_06 + OTU_Stable$HV_025_07
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_07,HV_022_06,HV_023_06,HV_024_06,HV_025_07))
#P27 Right
OTU_Stable$P27_RH <- OTU_Stable$HV_026_06 + OTU_Stable$HV_027_13 + OTU_Stable$HV_028_06 + OTU_Stable$HV_029_06 + OTU_Stable$HV_030_06
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_06,HV_027_13,HV_028_06,HV_029_06,HV_030_06))
#P27 Scalp
OTU_Stable$P27_SC <- OTU_Stable$HV_016_06 + OTU_Stable$HV_017_06 + OTU_Stable$HV_018_06 + OTU_Stable$HV_019_06 + OTU_Stable$HV_020_05
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_06,HV_017_06,HV_018_06,HV_019_06,HV_020_05))

#P28 Left
OTU_Stable$P28_LH <- OTU_Stable$HV_021_08 + OTU_Stable$HV_022_07 + OTU_Stable$HV_023_07 + OTU_Stable$HV_024_07 + OTU_Stable$HV_025_08
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_08,HV_022_07,HV_023_07,HV_024_07,HV_025_08))
#P28 Right
OTU_Stable$P28_RH <- OTU_Stable$HV_026_07 + OTU_Stable$HV_027_14 + OTU_Stable$HV_028_07 + OTU_Stable$HV_029_07 + OTU_Stable$HV_030_07
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_07,HV_027_14,HV_028_07,HV_029_07,HV_030_07))
#P28 Scalp
OTU_Stable$P28_SC <- OTU_Stable$HV_016_07 + OTU_Stable$HV_017_07 + OTU_Stable$HV_018_07 + OTU_Stable$HV_019_07 + OTU_Stable$HV_020_06
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_07,HV_017_07,HV_018_07,HV_019_07,HV_020_06))

#P29 Left
OTU_Stable$P29_LH <- OTU_Stable$HV_021_09 + OTU_Stable$HV_022_08 + OTU_Stable$HV_023_08 + OTU_Stable$HV_024_08 + OTU_Stable$HV_025_09
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_09,HV_022_08,HV_023_08,HV_024_08,HV_025_09))
#P29 Right
OTU_Stable$P29_RH <- OTU_Stable$HV_026_08 + OTU_Stable$HV_027_15 + OTU_Stable$HV_028_08 + OTU_Stable$HV_029_08 + OTU_Stable$HV_030_08
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_08,HV_027_15,HV_028_08,HV_029_08,HV_030_08))
#P29 Scalp
OTU_Stable$P29_SC <- OTU_Stable$HV_016_08 + OTU_Stable$HV_017_08 + OTU_Stable$HV_018_08 + OTU_Stable$HV_019_08 + OTU_Stable$HV_020_07
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_08,HV_017_08,HV_018_08,HV_019_08,HV_020_07))

#P30 Left
OTU_Stable$P30_LH <- OTU_Stable$HV_021_10 + OTU_Stable$HV_022_09 + OTU_Stable$HV_023_09 + OTU_Stable$HV_024_09 + OTU_Stable$HV_025_10
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_10,HV_022_09,HV_023_09,HV_024_09,HV_025_10))
#P30 Right
OTU_Stable$P30_RH <- OTU_Stable$HV_026_09 + OTU_Stable$HV_027_16 + OTU_Stable$HV_028_09 + OTU_Stable$HV_029_09 + OTU_Stable$HV_030_09
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_09,HV_027_16,HV_028_09,HV_029_09,HV_030_09))
#P30 Scalp
OTU_Stable$P30_SC <- OTU_Stable$HV_016_09 + OTU_Stable$HV_017_09 + OTU_Stable$HV_018_09 + OTU_Stable$HV_019_09 + OTU_Stable$HV_020_08
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_09,HV_017_09,HV_018_09,HV_019_09,HV_020_08))

#P31 Left
OTU_Stable$P31_LH <- OTU_Stable$HV_021_11 + OTU_Stable$HV_022_10 + OTU_Stable$HV_023_10 + OTU_Stable$HV_024_10
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_11,HV_022_10,HV_023_10,HV_024_10))
#P31 Right
OTU_Stable$P31_RH <- OTU_Stable$HV_026_10 + OTU_Stable$HV_027_18 + OTU_Stable$HV_028_10 + OTU_Stable$HV_029_10
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_10,HV_027_18,HV_028_10,HV_029_10))
#P31 Scalp
OTU_Stable$P31_SC <- OTU_Stable$HV_016_10 + OTU_Stable$HV_017_10 + OTU_Stable$HV_018_10 + OTU_Stable$HV_019_10
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_10,HV_017_10,HV_018_10,HV_019_10))

#P32 Left
OTU_Stable$P32_LH <- OTU_Stable$HV_021_12 + OTU_Stable$HV_022_11 + OTU_Stable$HV_023_11 + OTU_Stable$HV_024_11 + OTU_Stable$HV_025_11
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_12,HV_022_11,HV_023_11,HV_024_11,HV_025_11))
#P32 Right
OTU_Stable$P32_RH <- OTU_Stable$HV_026_11 + OTU_Stable$HV_027_19 + OTU_Stable$HV_028_11 + OTU_Stable$HV_029_11 + OTU_Stable$HV_030_10
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_11,HV_027_19,HV_028_11,HV_029_11,HV_030_10))
#P32 Scalp
OTU_Stable$P32_SC <- OTU_Stable$HV_016_11 + OTU_Stable$HV_017_11 + OTU_Stable$HV_018_11 + OTU_Stable$HV_019_11 + OTU_Stable$HV_020_09
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_11,HV_017_11,HV_018_11,HV_019_11,HV_020_09))

#P34 Left
OTU_Stable$P34_LH <- OTU_Stable$HV_021_14 + OTU_Stable$HV_022_12 + OTU_Stable$HV_023_12 + OTU_Stable$HV_024_12 + OTU_Stable$HV_025_12
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_14,HV_022_12,HV_023_12,HV_024_12,HV_025_12))
#P34 Right
OTU_Stable$P34_RH <- OTU_Stable$HV_026_12 + OTU_Stable$HV_027_20 + OTU_Stable$HV_028_12 + OTU_Stable$HV_029_12 + OTU_Stable$HV_030_11
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_12,HV_027_20,HV_028_12,HV_029_12,HV_030_11))
#P34 Scalp
OTU_Stable$P34_SC <- OTU_Stable$HV_016_12 + OTU_Stable$HV_017_12 + OTU_Stable$HV_018_12 + OTU_Stable$HV_019_12 + OTU_Stable$HV_020_11
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_12,HV_017_12,HV_018_12,HV_019_12,HV_020_11))

#P35 Left
OTU_Stable$P35_LH <- OTU_Stable$HV_021_15 + OTU_Stable$HV_022_13 + OTU_Stable$HV_023_13 + OTU_Stable$HV_024_13 + OTU_Stable$HV_025_13
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_15,HV_022_13,HV_023_13,HV_024_13,HV_025_13))
#P35 Right
OTU_Stable$P35_RH <- OTU_Stable$HV_026_13 + OTU_Stable$HV_027_21 + OTU_Stable$HV_028_13 + OTU_Stable$HV_029_13 + OTU_Stable$HV_030_12
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_13,HV_027_21,HV_028_13,HV_029_13,HV_030_12))
#P35 Scalp
OTU_Stable$P35_SC <- OTU_Stable$HV_016_13 + OTU_Stable$HV_017_13 + OTU_Stable$HV_018_13 + OTU_Stable$HV_019_13 + OTU_Stable$HV_020_12
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_13,HV_017_13,HV_018_13,HV_019_13,HV_020_12))

#P36 Left
OTU_Stable$P36_LH <- OTU_Stable$HV_021_16 + OTU_Stable$HV_022_14 + OTU_Stable$HV_023_14 + OTU_Stable$HV_024_14 + OTU_Stable$HV_025_14
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_16,HV_022_14,HV_023_14,HV_024_14,HV_025_14))
#P36 Right
OTU_Stable$P36_RH <- OTU_Stable$HV_026_14 + OTU_Stable$HV_027_22 + OTU_Stable$HV_028_14 + OTU_Stable$HV_029_14 + OTU_Stable$HV_030_13
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_14,HV_027_22,HV_028_14,HV_029_14,HV_030_13))
#P36 Scalp
OTU_Stable$P36_SC <- OTU_Stable$HV_016_14 + OTU_Stable$HV_017_14 + OTU_Stable$HV_018_14 + OTU_Stable$HV_019_14 + OTU_Stable$HV_020_13
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_14,HV_017_14,HV_018_14,HV_019_14,HV_020_13))

#P37 Left
OTU_Stable$P37_LH <- OTU_Stable$HV_021_18 + OTU_Stable$HV_022_15 + OTU_Stable$HV_023_15 + OTU_Stable$HV_024_15 + OTU_Stable$HV_025_15
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_18,HV_022_15,HV_023_15,HV_024_15,HV_025_15))
#P37 Right
OTU_Stable$P37_RH <- OTU_Stable$HV_026_15 + OTU_Stable$HV_028_15 + OTU_Stable$HV_029_15 + OTU_Stable$HV_030_14 + OTU_Stable$HV_030_22
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_15,HV_028_15,HV_029_15,HV_030_14,HV_030_22))
#P37 Scalp
OTU_Stable$P37_SC <- OTU_Stable$HV_016_15 + OTU_Stable$HV_017_15 + OTU_Stable$HV_018_15 + OTU_Stable$HV_019_15 + OTU_Stable$HV_020_14
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_15,HV_017_15,HV_018_15,HV_019_15,HV_020_14))

#P38 Left
OTU_Stable$P38_LH <- OTU_Stable$HV_021_19 + OTU_Stable$HV_022_16 + OTU_Stable$HV_023_16 + OTU_Stable$HV_024_16 + OTU_Stable$HV_025_16
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_19,HV_022_16,HV_023_16,HV_024_16,HV_025_16))
#P38 Right
OTU_Stable$P38_RH <- OTU_Stable$HV_026_16 + OTU_Stable$HV_028_16 + OTU_Stable$HV_029_16 + OTU_Stable$HV_030_15 
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_16,HV_028_16,HV_029_16,HV_030_15))
#P38 Scalp
OTU_Stable$P38_SC <- OTU_Stable$HV_016_16 + OTU_Stable$HV_017_16 + OTU_Stable$HV_018_16 + OTU_Stable$HV_019_16 + OTU_Stable$HV_020_15
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_16,HV_017_16,HV_018_16,HV_019_16,HV_020_15))

#P39 Left
OTU_Stable$P39_LH <- OTU_Stable$HV_021_20 + OTU_Stable$HV_022_18 + OTU_Stable$HV_023_18 + OTU_Stable$HV_024_18 + OTU_Stable$HV_025_18
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_20,HV_022_18,HV_023_18,HV_024_18,HV_025_18))
#P39 Right
OTU_Stable$P39_RH <- OTU_Stable$HV_026_18 + OTU_Stable$HV_028_18 + OTU_Stable$HV_029_18 + OTU_Stable$HV_030_16
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_18,HV_028_18,HV_029_18,HV_030_16))
#P39 Scalp
OTU_Stable$P39_SC <- OTU_Stable$HV_016_18 + OTU_Stable$HV_017_18 + OTU_Stable$HV_018_18 + OTU_Stable$HV_019_18 + OTU_Stable$HV_020_16
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_18,HV_017_18,HV_018_18,HV_019_18,HV_020_16))

#P40 Left
OTU_Stable$P40_LH <- OTU_Stable$HV_021_21 + OTU_Stable$HV_022_19 + OTU_Stable$HV_023_19 + OTU_Stable$HV_024_19 + OTU_Stable$HV_025_19
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_21,HV_022_19,HV_023_19,HV_024_19,HV_025_19))
#P40 Right
OTU_Stable$P40_RH <- OTU_Stable$HV_026_19 + OTU_Stable$HV_028_19 + OTU_Stable$HV_029_19 + OTU_Stable$HV_030_18
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_19,HV_028_19,HV_029_19,HV_030_18))
#P40 Scalp
OTU_Stable$P40_SC <- OTU_Stable$HV_016_19 + OTU_Stable$HV_017_19 + OTU_Stable$HV_018_19 + OTU_Stable$HV_019_19 + OTU_Stable$HV_020_18
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_19,HV_017_19,HV_018_19,HV_019_19,HV_020_18))

#P41 Left
OTU_Stable$P41_LH <- OTU_Stable$HV_021_22 + OTU_Stable$HV_022_20 + OTU_Stable$HV_023_20 + OTU_Stable$HV_024_20 + OTU_Stable$HV_025_20
OTU_Stable <- subset(OTU_Stable, select = -c(HV_021_22,HV_022_20,HV_023_20,HV_024_20,HV_025_20))
#P41 Right
OTU_Stable$P41_RH <- OTU_Stable$HV_026_20 + OTU_Stable$HV_028_20 + OTU_Stable$HV_029_20 + OTU_Stable$HV_030_19
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_20,HV_028_20,HV_029_20,HV_030_19))
#P41 Scalp
OTU_Stable$P41_SC <- OTU_Stable$HV_016_20 + OTU_Stable$HV_017_20 + OTU_Stable$HV_018_20 + OTU_Stable$HV_019_20 + OTU_Stable$HV_020_19
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_20,HV_017_20,HV_018_20,HV_019_20,HV_020_19))

#P42 Left
OTU_Stable$P42_LH <- OTU_Stable$HV_022_21 + OTU_Stable$HV_023_21 + OTU_Stable$HV_024_21 + OTU_Stable$HV_025_21 
OTU_Stable <- subset(OTU_Stable, select = -c(HV_022_21,HV_023_21,HV_024_21,HV_025_21))
#P42 Right
OTU_Stable$P42_RH <- OTU_Stable$HV_026_21 + OTU_Stable$HV_028_21 + OTU_Stable$HV_029_21 + OTU_Stable$HV_030_20
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_21,HV_028_21,HV_029_21,HV_030_20))
#P42 Scalp
OTU_Stable$P42_SC <- OTU_Stable$HV_016_21 + OTU_Stable$HV_017_21 + OTU_Stable$HV_018_21 + OTU_Stable$HV_019_21 + OTU_Stable$HV_020_20
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_21,HV_017_21,HV_018_21,HV_019_21,HV_020_20))

#P43 Left
OTU_Stable$P43_LH <- OTU_Stable$HV_022_22 + OTU_Stable$HV_023_22 + OTU_Stable$HV_024_22 + OTU_Stable$HV_025_01 + OTU_Stable$HV_025_22
OTU_Stable <- subset(OTU_Stable, select = -c(HV_022_22,HV_023_22,HV_024_22,HV_025_01,HV_025_22))
#P43 Right
OTU_Stable$P43_RH <- OTU_Stable$HV_026_22 + OTU_Stable$HV_028_22 + OTU_Stable$HV_029_22 + OTU_Stable$HV_030_21
OTU_Stable <- subset(OTU_Stable, select = -c(HV_026_22,HV_028_22,HV_029_22,HV_030_21))
#P43 Scalp
OTU_Stable$P43_SC <- OTU_Stable$HV_016_22 + OTU_Stable$HV_017_22 + OTU_Stable$HV_018_22 + OTU_Stable$HV_019_22 + OTU_Stable$HV_020_21
OTU_Stable <- subset(OTU_Stable, select = -c(HV_016_22,HV_017_22,HV_018_22,HV_019_22,HV_020_21))

```


#Stable Avg Table
```{r}
OTU_Avg <- OTU
OTU_Avg$ContigID <- row.names(OTU_Avg)

OTU_Avg<- subset (OTU_Avg, select = -c(HV_001_27,HV_004_27,HV_005_27,HV_006_27,HV_007_27,HV_008_27,HV_009_27,HV_010_27,HV_011_27,HV_012_27,HV_013_27,HV_014_27,HV_015_20,HV_015_21,HV_015_27,HV_016_27,HV_017_27,HV_018_27,HV_019_27,HV_020_10,HV_020_22,HV_020_27,HV_021_13,HV_021_27,HV_022_27,HV_023_27,HV_024_27,HV_025_27,HV_026_27,HV_027_01,HV_027_02,HV_027_03,HV_027_04,HV_027_05,HV_027_06,HV_027_07,HV_027_27,HV_028_27,HV_029_27,HV_030_27))

OTU_Avg[OTU_Avg < 2] <- 0
OTU_Avg <- OTU_Avg %>% mutate_if(is.numeric, ~1 * (. != 0))

OTU_Avg$ContigID -> row.names(OTU_Avg)

#P01 Left
OTU_Avg$P01_LH <- (OTU_Avg$HV_001_01 + OTU_Avg$HV_002_01 + OTU_Avg$HV_003_01 + OTU_Avg$HV_004_01 + OTU_Avg$HV_005_01)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_01,HV_002_01,HV_003_01,HV_004_01,HV_005_01 ))
#P01 Right
OTU_Avg$P01_RH <- (OTU_Avg$HV_001_02 + OTU_Avg$HV_002_02 + OTU_Avg$HV_003_02 + OTU_Avg$HV_004_02)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_02,HV_002_02,HV_003_02,HV_004_02 ))
#P01 Scalp
OTU_Avg$P01_SC <- (OTU_Avg$HV_001_03 + OTU_Avg$HV_004_03 + OTU_Avg$HV_003_03 + OTU_Avg$HV_005_03 + OTU_Avg$HV_002_03)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_03,HV_002_03,HV_003_03,HV_004_03,HV_005_03 ))

#P02 Left
OTU_Avg$P02_LH <- (OTU_Avg$HV_001_04 + OTU_Avg$HV_002_04 + OTU_Avg$HV_003_04 + OTU_Avg$HV_004_04 + OTU_Avg$HV_005_04)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_04,HV_002_04,HV_003_04,HV_004_04,HV_005_04 ))
#P02 Right
OTU_Avg$P02_RH <- (OTU_Avg$HV_001_05 + OTU_Avg$HV_002_05 + OTU_Avg$HV_003_05 + OTU_Avg$HV_004_05 + OTU_Avg$HV_005_05)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_05,HV_002_05,HV_003_05,HV_004_05,HV_005_05 ))
#P02 Scalp
OTU_Avg$P02_SC <- (OTU_Avg$HV_001_06 + OTU_Avg$HV_002_06 + OTU_Avg$HV_003_06 + OTU_Avg$HV_004_06 + OTU_Avg$HV_005_06)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_06,HV_002_06,HV_003_06,HV_004_06,HV_005_06 ))

#P03 Left
OTU_Avg$P03_LH <- (OTU_Avg$HV_001_07 + OTU_Avg$HV_002_07 + OTU_Avg$HV_003_07 + OTU_Avg$HV_004_07 + OTU_Avg$HV_005_07)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_07,HV_002_07,HV_003_07,HV_004_07,HV_005_07 ))
#P03 Right
OTU_Avg$P03_RH <- (OTU_Avg$HV_001_08 + OTU_Avg$HV_002_08 + OTU_Avg$HV_003_08 + OTU_Avg$HV_004_08 + OTU_Avg$HV_005_08)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_08,HV_002_08,HV_003_08,HV_004_08,HV_005_08 ))
#P03 Scalp
OTU_Avg$P03_SC <- (OTU_Avg$HV_001_09 + OTU_Avg$HV_002_09 + OTU_Avg$HV_003_09 + OTU_Avg$HV_004_09 + OTU_Avg$HV_005_09)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_09,HV_002_09,HV_003_09,HV_004_09,HV_005_09 ))

#P04 Left
OTU_Avg$P04_LH <- (OTU_Avg$HV_001_10 + OTU_Avg$HV_002_10 + OTU_Avg$HV_003_10 + OTU_Avg$HV_004_10 + OTU_Avg$HV_005_10)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_10,HV_002_10,HV_003_10,HV_004_10,HV_005_10 ))
#P04 Right
OTU_Avg$P04_RH <- (OTU_Avg$HV_001_11 + OTU_Avg$HV_002_11 + OTU_Avg$HV_003_11 + OTU_Avg$HV_004_11 + OTU_Avg$HV_005_11)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_11,HV_002_11,HV_003_11,HV_004_11,HV_005_11 ))
#P04 Scalp
OTU_Avg$P04_SC <- (OTU_Avg$HV_001_12 + OTU_Avg$HV_002_12 + OTU_Avg$HV_003_12 + OTU_Avg$HV_004_12 + OTU_Avg$HV_005_12)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_12,HV_002_12,HV_003_12,HV_004_12,HV_005_12 ))

#P05 Left
OTU_Avg$P05_LH <- (OTU_Avg$HV_001_13 + OTU_Avg$HV_002_13 + OTU_Avg$HV_003_13 + OTU_Avg$HV_004_13 + OTU_Avg$HV_005_13)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_13,HV_002_13,HV_003_13,HV_004_13,HV_005_13 ))
#P05 Right
OTU_Avg$P05_RH <- (OTU_Avg$HV_001_14 + OTU_Avg$HV_002_14 + OTU_Avg$HV_003_14 + OTU_Avg$HV_004_14 + OTU_Avg$HV_005_14)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_14,HV_002_14,HV_003_14,HV_004_14,HV_005_14 ))
#P05 Scalp
OTU_Avg$P05_SC <- (OTU_Avg$HV_001_15 + OTU_Avg$HV_002_15  + OTU_Avg$HV_004_15 + OTU_Avg$HV_003_15 + OTU_Avg$HV_005_15)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_15,HV_002_15,HV_004_15,HV_005_15,HV_003_15 ))
# removed OTU_Avg$HV_003_15

#P06 Left
OTU_Avg$P06_LH <- (OTU_Avg$HV_001_16 + OTU_Avg$HV_003_16 + OTU_Avg$HV_004_16 + OTU_Avg$HV_005_16)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_16,HV_003_16,HV_004_16,HV_005_16 ))
#P06 Right
OTU_Avg$P06_RH <- (OTU_Avg$HV_001_18 + OTU_Avg$HV_002_18 + OTU_Avg$HV_003_18 + OTU_Avg$HV_004_18 + OTU_Avg$HV_005_18)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_18,HV_002_18,HV_003_18,HV_004_18,HV_005_18 ))
#P06 Scalp
OTU_Avg$P06_SC <- (OTU_Avg$HV_001_19 + OTU_Avg$HV_002_19 + OTU_Avg$HV_003_19 + OTU_Avg$HV_004_19 + OTU_Avg$HV_005_19)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_19,HV_002_19,HV_003_19,HV_004_19,HV_005_19 ))

#P07 Left
OTU_Avg$P07_LH <- (OTU_Avg$HV_001_20 + OTU_Avg$HV_002_20 + OTU_Avg$HV_003_20 + OTU_Avg$HV_004_20 + OTU_Avg$HV_005_20)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_20,HV_002_20,HV_003_20,HV_004_20,HV_005_20 ))
#P07 Right
OTU_Avg$P07_RH <- (OTU_Avg$HV_001_21 + OTU_Avg$HV_002_21 + OTU_Avg$HV_003_21 + OTU_Avg$HV_004_21)/4 
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_21,HV_002_21,HV_003_21,HV_004_21 ))
#P07 Scalp
OTU_Avg$P07_SC <- (OTU_Avg$HV_001_22 + OTU_Avg$HV_002_22 + OTU_Avg$HV_003_22 + OTU_Avg$HV_004_22 + OTU_Avg$HV_005_22)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_001_22,HV_002_22,HV_003_22,HV_004_22,HV_005_22 ))


#P08 Left
OTU_Avg$P08_LH <- (OTU_Avg$HV_006_01 + OTU_Avg$HV_007_01 + OTU_Avg$HV_008_01 + OTU_Avg$HV_009_01 + OTU_Avg$HV_010_01)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_01,HV_007_01,HV_008_01,HV_009_01,HV_010_01))
#P08 Right
OTU_Avg$P08_RH <- (OTU_Avg$HV_006_02 + OTU_Avg$HV_007_02 + OTU_Avg$HV_008_02 + OTU_Avg$HV_010_02)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_02,HV_007_02,HV_008_02,HV_010_02))
#P08 Scalp
OTU_Avg$P08_SC <- (OTU_Avg$HV_006_03 + OTU_Avg$HV_007_03 + OTU_Avg$HV_008_03 + OTU_Avg$HV_009_03 + OTU_Avg$HV_010_03)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_03,HV_007_03,HV_008_03,HV_009_03,HV_010_03))

#P09 Left
OTU_Avg$P09_LH <- (OTU_Avg$HV_006_04 + OTU_Avg$HV_007_04 + OTU_Avg$HV_008_04 + OTU_Avg$HV_009_04 + OTU_Avg$HV_010_04)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_04,HV_007_04,HV_008_04,HV_009_04,HV_010_04))
#P09 Right
OTU_Avg$P09_RH <- (OTU_Avg$HV_006_05 + OTU_Avg$HV_007_05 + OTU_Avg$HV_008_05 + OTU_Avg$HV_009_05 + OTU_Avg$HV_010_05)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_05,HV_007_05,HV_008_05,HV_009_05,HV_010_05))
#P09 Scalp
OTU_Avg$P09_SC <- (OTU_Avg$HV_006_06 + OTU_Avg$HV_007_06 + OTU_Avg$HV_008_06 + OTU_Avg$HV_009_06 + OTU_Avg$HV_010_06)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_06,HV_007_06,HV_008_06,HV_009_06,HV_010_06))

#P10 Left
OTU_Avg$P10_LH <- (OTU_Avg$HV_006_07 + OTU_Avg$HV_007_07 + OTU_Avg$HV_008_07 + OTU_Avg$HV_009_07 + OTU_Avg$HV_010_07)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_07,HV_007_07,HV_008_07,HV_009_07,HV_010_07))
#P10 Right
OTU_Avg$P10_RH <- (OTU_Avg$HV_006_08 + OTU_Avg$HV_007_08 + OTU_Avg$HV_008_08 + OTU_Avg$HV_009_08 + OTU_Avg$HV_010_08)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_08,HV_007_08,HV_008_08,HV_009_08,HV_010_08))
#P10 Scalp
OTU_Avg$P10_SC <- (OTU_Avg$HV_006_09 + OTU_Avg$HV_007_09 + OTU_Avg$HV_008_09 + OTU_Avg$HV_009_09 + OTU_Avg$HV_010_09)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_09,HV_007_09,HV_008_09,HV_009_09,HV_010_09))

#P11 Left
OTU_Avg$P11_LH <- (OTU_Avg$HV_006_10 + OTU_Avg$HV_007_10 + OTU_Avg$HV_008_10 + OTU_Avg$HV_009_10 + OTU_Avg$HV_010_10)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_10,HV_007_10,HV_008_10,HV_009_10,HV_010_10))
#P11 Right
OTU_Avg$P11_RH <- (OTU_Avg$HV_006_11 + OTU_Avg$HV_007_11 + OTU_Avg$HV_008_11 + OTU_Avg$HV_009_11 + OTU_Avg$HV_010_11)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_11,HV_007_11,HV_008_11,HV_009_11,HV_010_11))
#P11 Scalp
OTU_Avg$P11_SC <- (OTU_Avg$HV_006_12 + OTU_Avg$HV_007_12 + OTU_Avg$HV_008_12 + OTU_Avg$HV_009_12 + OTU_Avg$HV_010_12)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_12,HV_007_12,HV_008_12,HV_009_12,HV_010_12))

#P12 Left
OTU_Avg$P12_LH <- (OTU_Avg$HV_006_13 + OTU_Avg$HV_007_13 + OTU_Avg$HV_008_13 + OTU_Avg$HV_009_13 + OTU_Avg$HV_010_13)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_13,HV_007_13,HV_008_13,HV_009_13,HV_010_13))
#P12 Right
OTU_Avg$P12_RH <- (OTU_Avg$HV_006_14 + OTU_Avg$HV_007_14 + OTU_Avg$HV_008_14 + OTU_Avg$HV_009_14 + OTU_Avg$HV_010_14)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_14,HV_007_14,HV_008_14,HV_009_14,HV_010_14))
#P12 Scalp
OTU_Avg$P12_SC <- (OTU_Avg$HV_006_15 + OTU_Avg$HV_007_15 + OTU_Avg$HV_008_15 + OTU_Avg$HV_009_15 + OTU_Avg$HV_010_15)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_15,HV_007_15,HV_008_15,HV_009_15,HV_010_15))

#P13 Left
OTU_Avg$P13_LH <- (OTU_Avg$HV_006_16 + OTU_Avg$HV_007_16 + OTU_Avg$HV_008_16 + OTU_Avg$HV_009_16 + OTU_Avg$HV_010_16)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_16,HV_007_16,HV_008_16,HV_009_16,HV_010_16))
#P13 Right
OTU_Avg$P13_RH <- (OTU_Avg$HV_006_18 + OTU_Avg$HV_007_18 + OTU_Avg$HV_008_18 + OTU_Avg$HV_009_18 + OTU_Avg$HV_010_18)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_18,HV_007_18,HV_008_18,HV_009_18,HV_010_18))
#P13 Scalp
OTU_Avg$P13_SC <- (OTU_Avg$HV_006_19 + OTU_Avg$HV_007_19 + OTU_Avg$HV_008_19 + OTU_Avg$HV_009_19 + OTU_Avg$HV_010_19)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_19,HV_007_19,HV_008_19,HV_009_19,HV_010_19))

#P14 Left
OTU_Avg$P14_LH <- (OTU_Avg$HV_006_20 + OTU_Avg$HV_007_20 + OTU_Avg$HV_008_20 + OTU_Avg$HV_009_20 + OTU_Avg$HV_010_20)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_20,HV_007_20,HV_008_20,HV_009_20,HV_010_20))
#P14 Right
OTU_Avg$P14_RH <- (OTU_Avg$HV_006_21 + OTU_Avg$HV_007_21 + OTU_Avg$HV_008_21 + OTU_Avg$HV_009_21 + OTU_Avg$HV_010_21)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_21,HV_007_21,HV_008_21,HV_009_21,HV_010_21))
#P14 Scalp
OTU_Avg$P14_SC <- (OTU_Avg$HV_006_22 + OTU_Avg$HV_007_22 + OTU_Avg$HV_008_22 + OTU_Avg$HV_009_22 + OTU_Avg$HV_010_22)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_006_22,HV_007_22,HV_008_22,HV_009_22,HV_010_22))

#P15 Left
OTU_Avg$P15_LH <- (OTU_Avg$HV_011_01 + OTU_Avg$HV_012_01 + OTU_Avg$HV_013_01 + OTU_Avg$HV_014_01 + OTU_Avg$HV_015_01)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_01,HV_012_01,HV_013_01,HV_014_01,HV_015_01))
#P15 Right
OTU_Avg$P15_RH <- (OTU_Avg$HV_011_02 + OTU_Avg$HV_012_02 + OTU_Avg$HV_013_02 + OTU_Avg$HV_014_02 + OTU_Avg$HV_015_02)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_02,HV_012_02,HV_013_02,HV_014_02,HV_015_02))
#P15 Scalp
OTU_Avg$P15_SC <- (OTU_Avg$HV_011_03 + OTU_Avg$HV_012_03 + OTU_Avg$HV_013_03 + OTU_Avg$HV_014_03 + OTU_Avg$HV_015_03)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_03,HV_012_03,HV_013_03,HV_014_03,HV_015_03))

#P16 Left
OTU_Avg$P16_LH <- (OTU_Avg$HV_011_04 + OTU_Avg$HV_012_04 + OTU_Avg$HV_013_04 + OTU_Avg$HV_014_04 + OTU_Avg$HV_015_04)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_04,HV_012_04,HV_013_04,HV_014_04,HV_015_04))
#P16 Right
OTU_Avg$P16_RH <- (OTU_Avg$HV_011_05 + OTU_Avg$HV_012_05 + OTU_Avg$HV_013_05 + OTU_Avg$HV_014_05 + OTU_Avg$HV_015_05)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_05,HV_012_05,HV_013_05,HV_014_05,HV_015_05))
#P16 Scalp
OTU_Avg$P16_SC <- (OTU_Avg$HV_011_06 + OTU_Avg$HV_012_06 + OTU_Avg$HV_014_06 + OTU_Avg$HV_015_06)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_06,HV_012_06,HV_014_06,HV_015_06))

#P17 Left
OTU_Avg$P17_LH <- (OTU_Avg$HV_011_07 + OTU_Avg$HV_012_07 + OTU_Avg$HV_013_07 + OTU_Avg$HV_014_07 + OTU_Avg$HV_015_07)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_07,HV_012_07,HV_013_07,HV_014_07,HV_015_07))
#P17 Right
OTU_Avg$P17_RH <- (OTU_Avg$HV_011_08 + OTU_Avg$HV_012_08 + OTU_Avg$HV_013_08 + OTU_Avg$HV_014_08 + OTU_Avg$HV_015_08)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_08,HV_012_08,HV_013_08,HV_014_08,HV_015_08))
#P17 Scalp
OTU_Avg$P17_SC <- (OTU_Avg$HV_011_09 + OTU_Avg$HV_012_09 + OTU_Avg$HV_013_09 + OTU_Avg$HV_014_09 + OTU_Avg$HV_015_09)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_09,HV_012_09,HV_013_09,HV_014_09,HV_015_09))

#P18 Left
OTU_Avg$P18_LH <- (OTU_Avg$HV_011_10 + OTU_Avg$HV_012_10 + OTU_Avg$HV_013_10 + OTU_Avg$HV_014_10 + OTU_Avg$HV_015_10)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_10,HV_012_10,HV_013_10,HV_014_10,HV_015_10))
#P18 Right
OTU_Avg$P18_RH <- (OTU_Avg$HV_011_11 + OTU_Avg$HV_012_11 + OTU_Avg$HV_013_11 + OTU_Avg$HV_014_11 + OTU_Avg$HV_015_11)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_11,HV_012_11,HV_013_11,HV_014_11,HV_015_11))
#P18 Scalp
OTU_Avg$P18_SC <- (OTU_Avg$HV_011_12 + OTU_Avg$HV_012_12 + OTU_Avg$HV_013_12 + OTU_Avg$HV_014_12 + OTU_Avg$HV_015_12)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_12,HV_012_12,HV_013_12,HV_014_12,HV_015_12))

#P19 Left
OTU_Avg$P19_LH <- (OTU_Avg$HV_011_13 + OTU_Avg$HV_012_13 + OTU_Avg$HV_013_13 + OTU_Avg$HV_014_13 + OTU_Avg$HV_015_13)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_13,HV_012_13,HV_013_13,HV_014_13,HV_015_13))
#P19 Right
OTU_Avg$P19_RH <- (OTU_Avg$HV_011_14 + OTU_Avg$HV_012_14 + OTU_Avg$HV_013_14 + OTU_Avg$HV_014_14 + OTU_Avg$HV_015_14)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_14,HV_012_14,HV_013_14,HV_014_14,HV_015_14))
#P19 Scalp
OTU_Avg$P19_SC <- (OTU_Avg$HV_011_15 + OTU_Avg$HV_012_15 + OTU_Avg$HV_013_15 + OTU_Avg$HV_014_15 + OTU_Avg$HV_015_15)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_15,HV_012_15,HV_013_15,HV_014_15,HV_015_15))

#P20 Left
OTU_Avg$P20_LH <- (OTU_Avg$HV_011_16 + OTU_Avg$HV_012_16 + OTU_Avg$HV_013_16 + OTU_Avg$HV_014_16 + OTU_Avg$HV_015_16)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_16,HV_012_16,HV_013_16,HV_014_16,HV_015_16))
#P20 Right
OTU_Avg$P20_RH <- (OTU_Avg$HV_011_18 + OTU_Avg$HV_012_18 + OTU_Avg$HV_013_18 + OTU_Avg$HV_014_18 + OTU_Avg$HV_015_18)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_18,HV_012_18,HV_013_18,HV_014_18,HV_015_18))
#P20 Scalp
OTU_Avg$P20_SC <- (OTU_Avg$HV_011_19 + OTU_Avg$HV_012_19 + OTU_Avg$HV_013_19 + OTU_Avg$HV_014_19 + OTU_Avg$HV_015_19)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_19,HV_012_19,HV_013_19,HV_014_19,HV_015_19))

#P21 Left
OTU_Avg$P21_LH <- (OTU_Avg$HV_011_20 + OTU_Avg$HV_012_20 + OTU_Avg$HV_013_20 + OTU_Avg$HV_014_20)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_20,HV_012_20,HV_013_20,HV_014_20))
#P21 Right
OTU_Avg$P21_RH <- (OTU_Avg$HV_011_21 + OTU_Avg$HV_012_21 + OTU_Avg$HV_013_21 + OTU_Avg$HV_014_21)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_21,HV_012_21,HV_013_21,HV_014_21))
#P21 Scalp
OTU_Avg$P21_SC <- (OTU_Avg$HV_011_22 + OTU_Avg$HV_012_22 + OTU_Avg$HV_013_22 + OTU_Avg$HV_014_22)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_011_22,HV_012_22,HV_013_22,HV_014_22))

#P22 Left
OTU_Avg$P22_LH <- (OTU_Avg$HV_021_02 + OTU_Avg$HV_022_01 + OTU_Avg$HV_023_01 + OTU_Avg$HV_024_01 + OTU_Avg$HV_025_02)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_02,HV_022_01,HV_023_01,HV_024_01,HV_025_02))
#P22 Right
OTU_Avg$P22_RH <- (OTU_Avg$HV_026_01 + OTU_Avg$HV_027_08 + OTU_Avg$HV_028_01 + OTU_Avg$HV_029_01 + OTU_Avg$HV_030_01)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_01,HV_027_08,HV_028_01,HV_029_01,HV_030_01))
#P22 Scalp
OTU_Avg$P22_SC <- (OTU_Avg$HV_016_01 + OTU_Avg$HV_017_01 + OTU_Avg$HV_018_01 + OTU_Avg$HV_019_01 + OTU_Avg$HV_020_01)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_01,HV_017_01,HV_018_01,HV_019_01,HV_020_01))

#P23 Left
OTU_Avg$P23_LH <- (OTU_Avg$HV_021_03 + OTU_Avg$HV_022_02 + OTU_Avg$HV_023_02 + OTU_Avg$HV_024_02 + OTU_Avg$HV_025_03)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_03,HV_022_02,HV_023_02,HV_024_02,HV_025_03))
#P23 Right
OTU_Avg$P23_RH <- (OTU_Avg$HV_026_02 + OTU_Avg$HV_027_09 + OTU_Avg$HV_028_02 + OTU_Avg$HV_029_02 + OTU_Avg$HV_030_02)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_02,HV_027_09,HV_028_02,HV_029_02,HV_030_02))
#P23 Scalp
OTU_Avg$P23_SC <- (OTU_Avg$HV_016_02 + OTU_Avg$HV_017_02 + OTU_Avg$HV_018_02 + OTU_Avg$HV_019_02 + OTU_Avg$HV_020_02)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_02,HV_017_02,HV_018_02,HV_019_02,HV_020_02))

#P24 Left
OTU_Avg$P24_LH <- (OTU_Avg$HV_021_04 + OTU_Avg$HV_022_03 + OTU_Avg$HV_023_03 + OTU_Avg$HV_024_03 + OTU_Avg$HV_025_04)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_04,HV_022_03,HV_023_03,HV_024_03,HV_025_04))
#P24 Right
OTU_Avg$P24_RH <- (OTU_Avg$HV_026_03 + OTU_Avg$HV_027_10 + OTU_Avg$HV_028_03 + OTU_Avg$HV_029_03 + OTU_Avg$HV_030_03)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_03,HV_027_10,HV_028_03,HV_029_03,HV_030_03))
#P24 Scalp
OTU_Avg$P24_SC <- (OTU_Avg$HV_016_03 + OTU_Avg$HV_017_03 + OTU_Avg$HV_018_03 + OTU_Avg$HV_019_03 + OTU_Avg$HV_021_01)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_03,HV_017_03,HV_018_03,HV_019_03,HV_021_01))

#P25 Left
OTU_Avg$P25_LH <- (OTU_Avg$HV_021_05 + OTU_Avg$HV_022_04 + OTU_Avg$HV_023_04 + OTU_Avg$HV_024_04 + OTU_Avg$HV_025_05)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_05,HV_022_04,HV_023_04,HV_024_04,HV_025_05))
#P25 Right
OTU_Avg$P25_RH <- (OTU_Avg$HV_026_04 + OTU_Avg$HV_027_11 + OTU_Avg$HV_028_04 + OTU_Avg$HV_029_04 + OTU_Avg$HV_030_04)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_04,HV_027_11,HV_028_04,HV_029_04,HV_030_04))
#P25 Scalp
OTU_Avg$P25_SC <- (OTU_Avg$HV_016_04 + OTU_Avg$HV_017_04 + OTU_Avg$HV_018_04 + OTU_Avg$HV_019_04 + OTU_Avg$HV_020_03)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_04,HV_017_04,HV_018_04,HV_019_04,HV_020_03))

#P26 Left
OTU_Avg$P26_LH <- (OTU_Avg$HV_021_06 + OTU_Avg$HV_022_05 + OTU_Avg$HV_023_05 + OTU_Avg$HV_024_05 + OTU_Avg$HV_025_06)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_06,HV_022_05,HV_023_05,HV_024_05,HV_025_06))
#P26 Right
OTU_Avg$P26_RH <- (OTU_Avg$HV_026_05 + OTU_Avg$HV_027_12 + OTU_Avg$HV_028_05 + OTU_Avg$HV_029_05 + OTU_Avg$HV_030_05)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_05,HV_027_12,HV_028_05,HV_029_05,HV_030_05))
#P26 Scalp
OTU_Avg$P26_SC <- (OTU_Avg$HV_016_05 + OTU_Avg$HV_017_05 + OTU_Avg$HV_018_05 + OTU_Avg$HV_019_05 + OTU_Avg$HV_020_04)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_05,HV_017_05,HV_018_05,HV_019_05,HV_020_04))

#P27 Left
OTU_Avg$P27_LH <- (OTU_Avg$HV_021_07 + OTU_Avg$HV_022_06 + OTU_Avg$HV_023_06 + OTU_Avg$HV_024_06 + OTU_Avg$HV_025_07)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_07,HV_022_06,HV_023_06,HV_024_06,HV_025_07))
#P27 Right
OTU_Avg$P27_RH <- (OTU_Avg$HV_026_06 + OTU_Avg$HV_027_13 + OTU_Avg$HV_028_06 + OTU_Avg$HV_029_06 + OTU_Avg$HV_030_06)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_06,HV_027_13,HV_028_06,HV_029_06,HV_030_06))
#P27 Scalp
OTU_Avg$P27_SC <- (OTU_Avg$HV_016_06 + OTU_Avg$HV_017_06 + OTU_Avg$HV_018_06 + OTU_Avg$HV_019_06 + OTU_Avg$HV_020_05)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_06,HV_017_06,HV_018_06,HV_019_06,HV_020_05))

#P28 Left
OTU_Avg$P28_LH <- (OTU_Avg$HV_021_08 + OTU_Avg$HV_022_07 + OTU_Avg$HV_023_07 + OTU_Avg$HV_024_07 + OTU_Avg$HV_025_08)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_08,HV_022_07,HV_023_07,HV_024_07,HV_025_08))
#P28 Right
OTU_Avg$P28_RH <- (OTU_Avg$HV_026_07 + OTU_Avg$HV_027_14 + OTU_Avg$HV_028_07 + OTU_Avg$HV_029_07 + OTU_Avg$HV_030_07)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_07,HV_027_14,HV_028_07,HV_029_07,HV_030_07))
#P28 Scalp
OTU_Avg$P28_SC <- (OTU_Avg$HV_016_07 + OTU_Avg$HV_017_07 + OTU_Avg$HV_018_07 + OTU_Avg$HV_019_07 + OTU_Avg$HV_020_06)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_07,HV_017_07,HV_018_07,HV_019_07,HV_020_06))

#P29 Left
OTU_Avg$P29_LH <- (OTU_Avg$HV_021_09 + OTU_Avg$HV_022_08 + OTU_Avg$HV_023_08 + OTU_Avg$HV_024_08 + OTU_Avg$HV_025_09)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_09,HV_022_08,HV_023_08,HV_024_08,HV_025_09))
#P29 Right
OTU_Avg$P29_RH <- (OTU_Avg$HV_026_08 + OTU_Avg$HV_027_15 + OTU_Avg$HV_028_08 + OTU_Avg$HV_029_08 + OTU_Avg$HV_030_08)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_08,HV_027_15,HV_028_08,HV_029_08,HV_030_08))
#P29 Scalp
OTU_Avg$P29_SC <- (OTU_Avg$HV_016_08 + OTU_Avg$HV_017_08 + OTU_Avg$HV_018_08 + OTU_Avg$HV_019_08 + OTU_Avg$HV_020_07)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_08,HV_017_08,HV_018_08,HV_019_08,HV_020_07))

#P30 Left
OTU_Avg$P30_LH <- (OTU_Avg$HV_021_10 + OTU_Avg$HV_022_09 + OTU_Avg$HV_023_09 + OTU_Avg$HV_024_09 + OTU_Avg$HV_025_10)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_10,HV_022_09,HV_023_09,HV_024_09,HV_025_10))
#P30 Right
OTU_Avg$P30_RH <- (OTU_Avg$HV_026_09 + OTU_Avg$HV_027_16 + OTU_Avg$HV_028_09 + OTU_Avg$HV_029_09 + OTU_Avg$HV_030_09)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_09,HV_027_16,HV_028_09,HV_029_09,HV_030_09))
#P30 Scalp
OTU_Avg$P30_SC <- (OTU_Avg$HV_016_09 + OTU_Avg$HV_017_09 + OTU_Avg$HV_018_09 + OTU_Avg$HV_019_09 + OTU_Avg$HV_020_08)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_09,HV_017_09,HV_018_09,HV_019_09,HV_020_08))

#P31 Left
OTU_Avg$P31_LH <- (OTU_Avg$HV_021_11 + OTU_Avg$HV_022_10 + OTU_Avg$HV_023_10 + OTU_Avg$HV_024_10)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_11,HV_022_10,HV_023_10,HV_024_10))
#P31 Right
OTU_Avg$P31_RH <- (OTU_Avg$HV_026_10 + OTU_Avg$HV_027_18 + OTU_Avg$HV_028_10 + OTU_Avg$HV_029_10)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_10,HV_027_18,HV_028_10,HV_029_10))
#P31 Scalp
OTU_Avg$P31_SC <- (OTU_Avg$HV_016_10 + OTU_Avg$HV_017_10 + OTU_Avg$HV_018_10 + OTU_Avg$HV_019_10)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_10,HV_017_10,HV_018_10,HV_019_10))

#P32 Left
OTU_Avg$P32_LH <- (OTU_Avg$HV_021_12 + OTU_Avg$HV_022_11 + OTU_Avg$HV_023_11 + OTU_Avg$HV_024_11 + OTU_Avg$HV_025_11)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_12,HV_022_11,HV_023_11,HV_024_11,HV_025_11))
#P32 Right
OTU_Avg$P32_RH <- (OTU_Avg$HV_026_11 + OTU_Avg$HV_027_19 + OTU_Avg$HV_028_11 + OTU_Avg$HV_029_11 + OTU_Avg$HV_030_10)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_11,HV_027_19,HV_028_11,HV_029_11,HV_030_10))
#P32 Scalp
OTU_Avg$P32_SC <- (OTU_Avg$HV_016_11 + OTU_Avg$HV_017_11 + OTU_Avg$HV_018_11 + OTU_Avg$HV_019_11 + OTU_Avg$HV_020_09)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_11,HV_017_11,HV_018_11,HV_019_11,HV_020_09))

#P34 Left
OTU_Avg$P34_LH <- (OTU_Avg$HV_021_14 + OTU_Avg$HV_022_12 + OTU_Avg$HV_023_12 + OTU_Avg$HV_024_12 + OTU_Avg$HV_025_12)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_14,HV_022_12,HV_023_12,HV_024_12,HV_025_12))
#P34 Right
OTU_Avg$P34_RH <- (OTU_Avg$HV_026_12 + OTU_Avg$HV_027_20 + OTU_Avg$HV_028_12 + OTU_Avg$HV_029_12 + OTU_Avg$HV_030_11)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_12,HV_027_20,HV_028_12,HV_029_12,HV_030_11))
#P34 Scalp
OTU_Avg$P34_SC <- (OTU_Avg$HV_016_12 + OTU_Avg$HV_017_12 + OTU_Avg$HV_018_12 + OTU_Avg$HV_019_12 + OTU_Avg$HV_020_11)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_12,HV_017_12,HV_018_12,HV_019_12,HV_020_11))

#P35 Left
OTU_Avg$P35_LH <- (OTU_Avg$HV_021_15 + OTU_Avg$HV_022_13 + OTU_Avg$HV_023_13 + OTU_Avg$HV_024_13 + OTU_Avg$HV_025_13)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_15,HV_022_13,HV_023_13,HV_024_13,HV_025_13))
#P35 Right
OTU_Avg$P35_RH <- (OTU_Avg$HV_026_13 + OTU_Avg$HV_027_21 + OTU_Avg$HV_028_13 + OTU_Avg$HV_029_13 + OTU_Avg$HV_030_12)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_13,HV_027_21,HV_028_13,HV_029_13,HV_030_12))
#P35 Scalp
OTU_Avg$P35_SC <- (OTU_Avg$HV_016_13 + OTU_Avg$HV_017_13 + OTU_Avg$HV_018_13 + OTU_Avg$HV_019_13 + OTU_Avg$HV_020_12)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_13,HV_017_13,HV_018_13,HV_019_13,HV_020_12))

#P36 Left
OTU_Avg$P36_LH <- (OTU_Avg$HV_021_16 + OTU_Avg$HV_022_14 + OTU_Avg$HV_023_14 + OTU_Avg$HV_024_14 + OTU_Avg$HV_025_14)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_16,HV_022_14,HV_023_14,HV_024_14,HV_025_14))
#P36 Right
OTU_Avg$P36_RH <- (OTU_Avg$HV_026_14 + OTU_Avg$HV_027_22 + OTU_Avg$HV_028_14 + OTU_Avg$HV_029_14 + OTU_Avg$HV_030_13)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_14,HV_027_22,HV_028_14,HV_029_14,HV_030_13))
#P36 Scalp
OTU_Avg$P36_SC <- (OTU_Avg$HV_016_14 + OTU_Avg$HV_017_14 + OTU_Avg$HV_018_14 + OTU_Avg$HV_019_14 + OTU_Avg$HV_020_13)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_14,HV_017_14,HV_018_14,HV_019_14,HV_020_13))

#P37 Left
OTU_Avg$P37_LH <- (OTU_Avg$HV_021_18 + OTU_Avg$HV_022_15 + OTU_Avg$HV_023_15 + OTU_Avg$HV_024_15 + OTU_Avg$HV_025_15)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_18,HV_022_15,HV_023_15,HV_024_15,HV_025_15))
#P37 Right
OTU_Avg$P37_RH <- (OTU_Avg$HV_026_15 + OTU_Avg$HV_028_15 + OTU_Avg$HV_029_15 + OTU_Avg$HV_030_14 + OTU_Avg$HV_030_22)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_15,HV_028_15,HV_029_15,HV_030_14,HV_030_22))
#P37 Scalp
OTU_Avg$P37_SC <- (OTU_Avg$HV_016_15 + OTU_Avg$HV_017_15 + OTU_Avg$HV_018_15 + OTU_Avg$HV_019_15 + OTU_Avg$HV_020_14)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_15,HV_017_15,HV_018_15,HV_019_15,HV_020_14))

#P38 Left
OTU_Avg$P38_LH <- (OTU_Avg$HV_021_19 + OTU_Avg$HV_022_16 + OTU_Avg$HV_023_16 + OTU_Avg$HV_024_16 + OTU_Avg$HV_025_16)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_19,HV_022_16,HV_023_16,HV_024_16,HV_025_16))
#P38 Right
OTU_Avg$P38_RH <- (OTU_Avg$HV_026_16 + OTU_Avg$HV_028_16 + OTU_Avg$HV_029_16 + OTU_Avg$HV_030_15)/4 
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_16,HV_028_16,HV_029_16,HV_030_15))
#P38 Scalp
OTU_Avg$P38_SC <- (OTU_Avg$HV_016_16 + OTU_Avg$HV_017_16 + OTU_Avg$HV_018_16 + OTU_Avg$HV_019_16 + OTU_Avg$HV_020_15)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_16,HV_017_16,HV_018_16,HV_019_16,HV_020_15))

#P39 Left
OTU_Avg$P39_LH <- (OTU_Avg$HV_021_20 + OTU_Avg$HV_022_18 + OTU_Avg$HV_023_18 + OTU_Avg$HV_024_18 + OTU_Avg$HV_025_18)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_20,HV_022_18,HV_023_18,HV_024_18,HV_025_18))
#P39 Right
OTU_Avg$P39_RH <- (OTU_Avg$HV_026_18 + OTU_Avg$HV_028_18 + OTU_Avg$HV_029_18 + OTU_Avg$HV_030_16)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_18,HV_028_18,HV_029_18,HV_030_16))
#P39 Scalp
OTU_Avg$P39_SC <- (OTU_Avg$HV_016_18 + OTU_Avg$HV_017_18 + OTU_Avg$HV_018_18 + OTU_Avg$HV_019_18 + OTU_Avg$HV_020_16)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_18,HV_017_18,HV_018_18,HV_019_18,HV_020_16))

#P40 Left
OTU_Avg$P40_LH <- (OTU_Avg$HV_021_21 + OTU_Avg$HV_022_19 + OTU_Avg$HV_023_19 + OTU_Avg$HV_024_19 + OTU_Avg$HV_025_19)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_21,HV_022_19,HV_023_19,HV_024_19,HV_025_19))
#P40 Right
OTU_Avg$P40_RH <- (OTU_Avg$HV_026_19 + OTU_Avg$HV_028_19 + OTU_Avg$HV_029_19 + OTU_Avg$HV_030_18)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_19,HV_028_19,HV_029_19,HV_030_18))
#P40 Scalp
OTU_Avg$P40_SC <- (OTU_Avg$HV_016_19 + OTU_Avg$HV_017_19 + OTU_Avg$HV_018_19 + OTU_Avg$HV_019_19 + OTU_Avg$HV_020_18)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_19,HV_017_19,HV_018_19,HV_019_19,HV_020_18))

#P41 Left
OTU_Avg$P41_LH <- (OTU_Avg$HV_021_22 + OTU_Avg$HV_022_20 + OTU_Avg$HV_023_20 + OTU_Avg$HV_024_20 + OTU_Avg$HV_025_20)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_021_22,HV_022_20,HV_023_20,HV_024_20,HV_025_20))
#P41 Right
OTU_Avg$P41_RH <- (OTU_Avg$HV_026_20 + OTU_Avg$HV_028_20 + OTU_Avg$HV_029_20 + OTU_Avg$HV_030_19)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_20,HV_028_20,HV_029_20,HV_030_19))
#P41 Scalp
OTU_Avg$P41_SC <- (OTU_Avg$HV_016_20 + OTU_Avg$HV_017_20 + OTU_Avg$HV_018_20 + OTU_Avg$HV_019_20 + OTU_Avg$HV_020_19)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_20,HV_017_20,HV_018_20,HV_019_20,HV_020_19))

#P42 Left
OTU_Avg$P42_LH <- (OTU_Avg$HV_022_21 + OTU_Avg$HV_023_21 + OTU_Avg$HV_024_21 + OTU_Avg$HV_025_21)/4 
OTU_Avg <- subset(OTU_Avg, select = -c(HV_022_21,HV_023_21,HV_024_21,HV_025_21))
#P42 Right
OTU_Avg$P42_RH <- (OTU_Avg$HV_026_21 + OTU_Avg$HV_028_21 + OTU_Avg$HV_029_21 + OTU_Avg$HV_030_20)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_21,HV_028_21,HV_029_21,HV_030_20))
#P42 Scalp
OTU_Avg$P42_SC <- (OTU_Avg$HV_016_21 + OTU_Avg$HV_017_21 + OTU_Avg$HV_018_21 + OTU_Avg$HV_019_21 + OTU_Avg$HV_020_20)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_21,HV_017_21,HV_018_21,HV_019_21,HV_020_20))

#P43 Left
OTU_Avg$P43_LH <- (OTU_Avg$HV_022_22 + OTU_Avg$HV_023_22 + OTU_Avg$HV_024_22 + OTU_Avg$HV_025_01 + OTU_Avg$HV_025_22)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_022_22,HV_023_22,HV_024_22,HV_025_01,HV_025_22))
#P43 Right
OTU_Avg$P43_RH <- (OTU_Avg$HV_026_22 + OTU_Avg$HV_028_22 + OTU_Avg$HV_029_22 + OTU_Avg$HV_030_21)/4
OTU_Avg <- subset(OTU_Avg, select = -c(HV_026_22,HV_028_22,HV_029_22,HV_030_21))
#P43 Scalp
OTU_Avg$P43_SC <- (OTU_Avg$HV_016_22 + OTU_Avg$HV_017_22 + OTU_Avg$HV_018_22 + OTU_Avg$HV_019_22 + OTU_Avg$HV_020_21)/5
OTU_Avg <- subset(OTU_Avg, select = -c(HV_016_22,HV_017_22,HV_018_22,HV_019_22,HV_020_21))
```


#Stable left hand
```{r}
OTU_LH <- subset(OTU_Stable, select = c(P01_LH,P02_LH,P03_LH,P04_LH,P05_LH,P06_LH,P07_LH,P08_LH,P09_LH,P10_LH,P11_LH,P12_LH,P13_LH,P14_LH,P15_LH,P16_LH, P17_LH,P18_LH,P19_LH,P20_LH,P21_LH,P22_LH,P23_LH,P24_LH,P25_LH,P26_LH,P27_LH,P28_LH,P29_LH,P30_LH,P31_LH,P32_LH,P34_LH,P35_LH,P36_LH,P37_LH,P38_LH,P39_LH,P40_LH,P41_LH,P42_LH,P43_LH,Species))
row.names(OTU_LH) <- OTU_LH$Species
OTU_ALL_LH <- OTU_LH %>% mutate_if(is.numeric, ~1 * (. != 0))
#OTU_ALL_LH <- OTU_LH %>% mutate_if(is.numeric, ~1 * (. > 5))
row.names(OTU_ALL_LH) <- OTU_ALL_LH$Species
OTU_ALL_LH <- subset (OTU_ALL_LH, select = -c(Species))
OTU_ALL_LH$Mean <- rowMeans(OTU_ALL_LH)
OTU_ALL_LH$Species <- row.names(OTU_ALL_LH)
OTU_Stable_LH <- OTU_LH %>% mutate_if(is.numeric, ~1 * (. > 3 ))
row.names(OTU_Stable_LH) <- OTU_Stable_LH$Species
OTU_Stable_LH <- subset (OTU_Stable_LH, select = -c(Species))
OTU_Stable_LH$Mean_Stable <- rowMeans(OTU_Stable_LH)
OTU_Stable_LH$Species <- row.names(OTU_Stable_LH)
OTU_LH_Compare<- subset (OTU_Stable_LH, select = c(Mean_Stable,Species))
OTU_LH_Compare<- merge(OTU_ALL_LH, OTU_LH_Compare, by= "Species")
OTU_LH_Compare$Mean_temp <- OTU_LH_Compare$Mean - OTU_LH_Compare$Mean_Stable

LH_Stable <- subset(OTU_LH_Compare, Mean_temp < Mean_Stable)
LH_Stable2 <- subset(OTU_LH_Compare, 0 < Mean_Stable)
LH_Stable_Markers <- subset(LH_Stable, Mean <= 0.80)

LH_Stable_Markers$Species

LH_Markers <- LH_Stable_Markers$Species
LH_Markers2 <- LH_Stable2$Species

LH_SNP <- subset(LH_Stable, Mean > 0.80)
LH_SNP_Markers <- LH_SNP$Species


```

#Stable Right Hand
```{r}
OTU_RH <- subset(OTU_Stable, select = c(P01_RH,P02_RH,P03_RH,P04_RH,P05_RH,P06_RH,P07_RH,P08_RH,P09_RH,P10_RH,P11_RH,P12_RH,P13_RH,P14_RH,P15_RH,P16_RH, P17_RH,P18_RH,P19_RH,P20_RH,P21_RH,P22_RH,P23_RH,P24_RH,P25_RH,P26_RH,P27_RH,P28_RH,P29_RH,P30_RH,P31_RH,P32_RH,P34_RH,P35_RH,P36_RH,P37_RH,P38_RH,P39_RH,P40_RH,P41_RH,P42_RH,P43_RH,ContigID))
#OTU_RH <- subset(OTU_Stable, select = c(P22_RH,P23_RH,P24_RH,P25_RH,P26_RH,P27_RH,P28_RH,P29_RH,P30_RH,P31_RH,P32_RH,P34_RH,P35_RH,P36_RH,P37_RH,P38_RH,P39_RH,P40_RH,P41_RH,P42_RH,P43_RH,ContigID))
row.names(OTU_RH) <- OTU_RH$ContigID
OTU_ALL_RH <- OTU_RH %>% mutate_if(is.numeric, ~1 * (. != 0))
#OTU_ALL_RH <- OTU_RH %>% mutate_if(is.numeric, ~1 * (. > 10))
row.names(OTU_ALL_RH) <- OTU_ALL_RH$ContigID
OTU_ALL_RH <- subset (OTU_ALL_RH, select = -c(ContigID))
OTU_ALL_RH$Mean <- rowMeans(OTU_ALL_RH)
OTU_ALL_RH$ContigID <- row.names(OTU_ALL_RH)
OTU_Stable_RH <- OTU_RH %>% mutate_if(is.numeric, ~1 * (. > 3))
row.names(OTU_Stable_RH) <- OTU_Stable_RH$ContigID
OTU_Stable_RH <- subset (OTU_Stable_RH, select = -c(ContigID))
OTU_Stable_RH$Mean_Stable <- rowMeans(OTU_Stable_RH)
OTU_Stable_RH$ContigID <- row.names(OTU_Stable_RH)
OTU_RH_Compare<- subset (OTU_Stable_RH, select = c(Mean_Stable,ContigID))
OTU_RH_Compare<- merge(OTU_ALL_RH, OTU_RH_Compare, by= "ContigID")
OTU_RH_Compare$Mean_temp <- OTU_RH_Compare$Mean - OTU_RH_Compare$Mean_Stable

RH_Stable <- subset(OTU_RH_Compare, Mean_temp < Mean_Stable)
RH_Stable2 <- subset(OTU_RH_Compare, 0 < Mean_Stable)

RH_Stable_Markers <- subset(RH_Stable, Mean <= 0.80)

RH_Stable_Markers$ContigID

RH_Markers <- RH_Stable_Markers$ContigID
RH_Markers2 <- RH_Stable2$ContigID

Hand_Markers_Shared <- LH_Markers[LH_Markers %in% RH_Markers]
Hand_Markers_Shared2 <- LH_Markers2[LH_Markers2 %in% RH_Markers2]

RH_SNP <- subset(RH_Stable, Mean > 0.80)
RH_SNP_Markers <- RH_SNP$ContigID
Hand_SNP_Markers_Shared <- LH_SNP_Markers[LH_SNP_Markers %in% RH_SNP_Markers]
Hand_SNP_Markers_Shared <- as.data.frame(Hand_SNP_Markers_Shared)
#write_csv(Hand_SNP_Markers_Shared, 'SNP_contig_markers.csv')


RH_Markers <- RH_Stable_Markers$ContigID
LH_Markers <- LH_Stable_Markers$ContigID

Hand_Markers_Shared <- LH_Markers[LH_Markers %in% RH_Markers]

#RH_SNP <- subset(RH_Stable, Mean > 0.71)
#RH_SNP_Markers <- RH_SNP$ContigID
Hand_SNP_Markers_Shared <- LH_SNP_Markers[LH_SNP_Markers %in% RH_SNP_Markers]
Hand_SNP_Markers_Shared <- as.data.frame(Hand_SNP_Markers_Shared)
#write_csv(Hand_SNP_Markers_Shared, 'SNP_contig_markers.csv')

```

```{r}
p<-ggplot(data=LH_Stable2, aes(x=Family, y=Mean)) + geom_bar(stat="identity")
p + coord_flip()
p2<-ggplot(data=RH_Stable2, aes(x=Family, y=Mean)) + geom_bar(stat="identity")
p2 + coord_flip()
data <- read.table(text="
Location,Family,OverallMean, StableMean
Left Hand,Baculoviridae,1.0000000,0.59523810
Left Hand,Genomoviridae,0.9523810,0.23809524
Left Hand,Herelleviridae,0.9047619,0.02380952
Left Hand,Myoviridae,0.7380952,0.02380952
Left Hand,Papillomaviridae,0.5952381,0.14285714
Left Hand,Podoviridae,0.4047619,0.07142857
Left Hand,Siphoviridae,0.9761905,0.38095238
Left Hand,Unclassified Caudovirales,0.9523810,0.26190476	
Left Hand,Unclassified Homo sapiens like virus,0.5238095,0.07142857
Left Hand,Unclassified Staphylococcus warneri like virus,0,0
Left Hand,Caulimoviridae,0,0
Right Hand,Baculoviridae,1.0000000,0.30952381
Right Hand,Caulimoviridae,1.0000000,0.02380952
Right Hand,Genomoviridae,0.6190476,0.14285714
Right Hand,Herelleviridae,0.7380952,0.02380952
Right Hand,Myoviridae,0.5714286,0.02380952
Right Hand,Papillomaviridae,0.8333333,0.14285714
Right Hand,Podoviridae,0.5476190,0.02380952
Right Hand,Siphoviridae,0.9761905,0.42857143
Right Hand,Unclassified Caudovirales,1.0000000,0.28571429
Right Hand,Unclassified Homo sapiens like virus,0.8095238,0.04761905
Right Hand,Unclassified Staphylococcus warneri like virus,0.2857143,0.02380952", header=TRUE, sep=",")	

data$OverallSum<-round(data$OverallMean*42)
data$StableSum<-round(data$StableMean*42)
data$PercentStable<-(data$StableSum/data$OverallSum)


#p <-ggplot(data, aes(x=Family, y=OverallMean, fill=Location)) +
    #geom_bar(stat="identity", position="dodge")

#plot <- ggplot(data, aes(x = Family, y = OverallMean, fill = Location)) +
       # geom_bar(stat = "identity", position = "dodge", color = "grey40")+
        #scale_fill_manual(values = c("#a1d99b", "#31a354"))
data <- data %>%
        mutate(PercentStable = paste0(round(PercentStable*100, 1), "%"))
data[is.na(data)] <- 0

data[11, "PercentStable"] <- ""
data[10, "PercentStable"] <- ""
data[12, "PercentStable"] <- ""
data[13, "PercentStable"] <- ""
data[14, "PercentStable"] <- ""
data[15, "PercentStable"] <- ""
data[27, "PercentStable"] <- ""
data[28, "PercentStable"] <- ""
data[29, "PercentStable"] <- ""
data[30, "PercentStable"] <- ""
data[42, "PercentStable"] <- ""
data[43, "PercentStable"] <- ""
data[44, "PercentStable"] <- ""

plot <- ggplot(data, aes(x = Family, y = OverallMean, fill = Location)) +
        geom_bar(stat = "identity", position = "dodge", color = "grey40") +
        scale_fill_manual(values = c("#a1d99b", "#31a354","#24cbd1")) +
        geom_text(aes(label = PercentStable), position = position_dodge(0.9),
                 hjust = 1.2, color = "black", family = "Georgia") + labs(x="Viral Family", y = "Proportion Present in Population")



plot +coord_flip()+theme_minimal()

plot <- plot +coord_flip()+  theme_minimal() +
        scale_y_continuous(labels = scales::percent) +
        labs(title = "Distribution of Adults by Income in Dayton, OH",
             subtitle = "The percentage of adults in the middle class eroded by 5.3% from 2000 to 2014. Although a small \nfraction of these individuals moved into the upper class (+0.5%), the majority of these middle class \nindividuals moved into the lower income class (+4.8%).",
             caption = "Source: Pew Research Center analysis of the \n2000 decennial census and 2014 American \nCommunity Survey (IPUMS)")

plot +
        theme_minimal() +
        theme(axis.title = element_blank(),
              panel.grid.major.x = element_blank(),
              panel.grid.minor = element_blank(),
              legend.position = c(1,1), legend.justification = c(1,1),
              legend.background = element_blank(),
              legend.direction="horizontal",
              legend.title = element_blank(),
              text = element_text(family = "Georgia"),
              plot.title = element_text(size = 20, margin = margin(b = 10)),
              plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)),
              plot.caption = element_text(size = 8, margin = margin(t = 10), color = "grey70", hjust = 0))

```


```{r}
data2 <- read.table(text="
Location,Family,OverallMean, StableMean
Hand,Baculoviridae,1.0000000,0.452381
Hand,Genomoviridae,0.7857143,0.1904762
Hand,Herelleviridae,0.8214286,0.02380952
Hand,Myoviridae,0.6547619,0.02380952
Hand,Papillomaviridae,0.7142857,0.1428571
Hand,Podoviridae,0.4761904,0.04761904
Hand,Siphoviridae,0.9761905,0.4047619
Hand,Unclassified Caudovirales,0.9761905,0.2738095	
Hand,Unclassified Homo sapiens like virus,0.6666667,0.05952381
Hand,Unclassified Staphylococcus like virus,0,0
Hand,Unclassified Staphylococcus capitis like virus,0,0
Hand,Unclassified Eukaryotic like virus,0,0
Hand,Microviridae,0,0
Scalp,Baculoviridae,0.9761905,0.40476190
Scalp,Genomoviridae,0.9523810,0.33333333
Scalp,Herelleviridae,0.9285714,0.04761905	
Scalp,Microviridae,0.9523810,0.02380952
Scalp,Papillomaviridae,0.8571429,0.21428571	
Scalp,Podoviridae,0.9285714,0.11904762
Scalp,Siphoviridae,1.0000000,0.57142857
Scalp,Unclassified Caudovirales,1.0000000,0.52380952	
Scalp,Unclassified Eukaryotic like virus,0.2857143,0.02380952	
Scalp,Unclassified Homo sapiens like virus,0.9523810,0.09523810
Scalp,Unclassified Staphylococcus capitis like virus,0.6190476,0.02380952	
Scalp,Myoviridae,0,0
Scalp,Unclassified Staphylococcus like virus,0.8571429,0.02380952", header=TRUE, sep=",")	

data2$OverallSum<-round(data2$OverallMean*42)
data2$StableSum<-round(data2$StableMean*42)
data2$PercentStable<-(data2$StableSum/data2$OverallSum)
data2 <- data2 %>%
        mutate(PercentStable = paste0(round(PercentStable*100, 1), "%"))
data2[10, "PercentStable"] <- ""
data2[11, "PercentStable"] <- ""
data2[12, "PercentStable"] <- ""
data2[13, "PercentStable"] <- ""
data2[25, "PercentStable"] <- ""


plot <- ggplot(data2, aes(x = Family, y = OverallMean, fill = Location)) +
        geom_bar(stat = "identity", position = "dodge", color = "grey40") +
        scale_fill_manual(values = c("#9bd5d9", "#318ea3")) +
        geom_text(aes(label = PercentStable), position = position_dodge(0.9),
                 hjust = 1.2, color = "black", family = "Georgia") + labs(x="Viral Family", y = "Proportion Present in Population")



plot +coord_flip()+theme_minimal()

```
#FFFFFFINNALLLLL MARKERS BOWTIE2
```{r}
#species
papilloma_LH_MARKERS <- c
papilloma_RH_MARKERS <- c
papilloma_LH_SNP_MARKERS <- c
papilloma_RH_SNP_MARKERS <- c
papilloma_HAND_MARKERS <- c
papilloma_HAND_SNP_MARKERS <- c

overall_LH_MARKERS #<- LH_Markers
overall_RH_MARKERS #<- RH_Markers
overall_LH_SNP_MARKERS #<- LH_SNP_Markers
overall_RH_SNP_MARKERS #<- RH_SNP_Markers
overall_HAND_MARKERS #<- Hand_Markers_Shared
overall_HAND_SNP_MARKERS #<- Hand_SNP_Markers_Shared 

Final_Markers <- c(overall_LH_MARKERS,overall_RH_MARKERS,overall_LH_SNP_MARKERS,overall_RH_SNP_MARKERS,overall_HAND_MARKERS,overall_HAND_SNP_MARKERS)

Final_Markers <- as.data.frame(Final_Markers)
write_csv(Final_Markers, 'FINAL_markers.csv')




```

```{r}
Test_Markers <- RH_Stable$Species
Test_Markers2 <- LH_Stable$Species
Test_Markers <- c(Test_Markers, Test_Markers2)
Test_Markers <- unique(Test_Markers)

OTU_Hand_Sums <- subset(OTU_Stable, select = c(P01_RH,P02_RH,P03_RH,P04_RH,P05_RH,P06_RH,P07_RH,P08_RH,P09_RH,P10_RH,P11_RH,P12_RH,P13_RH,P14_RH,P15_RH,P16_RH, P17_RH,P18_RH,P19_RH,P20_RH,P21_RH,P22_RH,P23_RH,P24_RH,P25_RH,P26_RH,P27_RH,P28_RH,P29_RH,P30_RH,P31_RH,P32_RH,P34_RH,P35_RH,P36_RH,P37_RH,P38_RH,P39_RH,P40_RH,P41_RH,P42_RH,P43_RH,P01_LH,P02_LH,P03_LH,P04_LH,P05_LH,P06_LH,P07_LH,P08_LH,P09_LH,P10_LH,P11_LH,P12_LH,P13_LH,P14_LH,P15_LH,P16_LH,P17_LH,P18_LH,P19_LH,P20_LH,P21_LH,P22_LH,P23_LH,P24_LH,P25_LH,P26_LH,P27_LH,P28_LH,P29_LH,P30_LH,P31_LH,P32_LH,P34_LH,P35_LH,P36_LH,P37_LH,P38_LH,P39_LH,P40_LH,P41_LH,P42_LH,P43_LH))
OTU_Hand_Sums <- subset(OTU_Hand_Sums, rownames(OTU_Hand_Sums) %in% Test_Markers)
OTU_Hand_Sums_M <- as.matrix(OTU_Hand_Sums)
col_fun = colorRamp2(c(0, 2.5, 5), c("blue", "white", "red"))
Heatmap(OTU_Hand_Sums_M, name = "Persistence Across Time Points", column_title = "Subject", row_title = "Viral Contig", column_title_side = "bottom",row_dend_width = unit(2, "cm"), column_dend_height = unit(2, "cm"),  col = col_fun)

```

```{r}
OTU_Hand_Avg <- subset(OTU_Avg, select = c(P01_RH,P02_RH,P03_RH,P04_RH,P05_RH,P06_RH,P07_RH,P08_RH,P09_RH,P10_RH,P11_RH,P12_RH,P13_RH,P14_RH,P15_RH,P16_RH, P17_RH,P18_RH,P19_RH,P20_RH,P21_RH,P22_RH,P23_RH,P24_RH,P25_RH,P26_RH,P27_RH,P28_RH,P29_RH,P30_RH,P31_RH,P32_RH,P34_RH,P35_RH,P36_RH,P37_RH,P38_RH,P39_RH,P40_RH,P41_RH,P42_RH,P43_RH,P01_LH,P02_LH,P03_LH,P04_LH,P05_LH,P06_LH,P07_LH,P08_LH,P09_LH,P10_LH,P11_LH,P12_LH,P13_LH,P14_LH,P15_LH,P16_LH,P17_LH,P18_LH,P19_LH,P20_LH,P21_LH,P22_LH,P23_LH,P24_LH,P25_LH,P26_LH,P27_LH,P28_LH,P29_LH,P30_LH,P31_LH,P32_LH,P34_LH,P35_LH,P36_LH,P37_LH,P38_LH,P39_LH,P40_LH,P41_LH,P42_LH,P43_LH))
OTU_Hand_Avg <- subset(OTU_Hand_Avg, rownames(OTU_Hand_Avg) %in% Test_Markers)
OTU_Hand_Avg_M <- as.matrix(OTU_Hand_Avg)
#col_fun = colorRamp2(c(0, 2.5, 5), c("blue", "white", "red"))
Heatmap(OTU_Hand_Avg_M, name = "Presence Across All Time Points", column_title = "Subject", row_title = "Viral Contig", column_title_side = "bottom",row_dend_width = unit(2, "cm"), column_dend_height = unit(2, "cm"))

```
#Stable Scalp
```{r}
OTU_SC <- subset(OTU_Stable, select = c(P01_SC,P02_SC,P03_SC,P04_SC,P05_SC,P06_SC,P07_SC,P08_SC,P09_SC,P10_SC,P11_SC,P12_SC,P13_SC,P14_SC,P15_SC,P16_SC, P17_SC,P18_SC,P19_SC,P20_SC,P21_SC,P22_SC,P23_SC,P24_SC,P25_SC,P26_SC,P27_SC,P28_SC,P29_SC,P30_SC,P31_SC,P32_SC,P34_SC,P35_SC,P36_SC,P37_SC,P38_SC,P39_SC,P40_SC,P41_SC,P42_SC,P43_SC,Species))
row.names(OTU_SC) <- OTU_SC$Species
OTU_ALL_SC <- OTU_SC %>% mutate_if(is.numeric, ~1 * (. != 0))
#OTU_ALL_SC <- OTU_SC %>% mutate_if(is.numeric, ~1 * (. > 10))
row.names(OTU_ALL_SC) <- OTU_ALL_SC$Species
OTU_ALL_SC <- subset (OTU_ALL_SC, select = -c(Species))
OTU_ALL_SC$Mean <- rowMeans(OTU_ALL_SC)
OTU_ALL_SC$Species <- row.names(OTU_ALL_SC)
OTU_Stable_SC <- OTU_SC %>% mutate_if(is.numeric, ~1 * (. > 3))
row.names(OTU_Stable_SC) <- OTU_Stable_SC$Species
OTU_Stable_SC <- subset (OTU_Stable_SC, select = -c(Species))
OTU_Stable_SC$Mean_Stable <- rowMeans(OTU_Stable_SC)
OTU_Stable_SC$Species <- row.names(OTU_Stable_SC)
OTU_SC_Compare<- subset (OTU_Stable_SC, select = c(Mean_Stable,Species))
OTU_SC_Compare<- merge(OTU_ALL_SC, OTU_SC_Compare, by= "Species")
OTU_SC_Compare$Mean_temp <- OTU_SC_Compare$Mean - OTU_SC_Compare$Mean_Stable

SC_Stable <- subset(OTU_SC_Compare, Mean_temp < Mean_Stable)

SC_Stable_Markers <- subset(SC_Stable, Mean < 0.6)

SC_Stable_Markers$Species
SC_Markers <- SC_Stable_Markers$Species

Test_Markers <- RH_Stable$Species
Test_Markers2 <- LH_Stable$Species
Test_Markers3 <- SC_Stable$Species
Test_Markers_all <- c(Test_Markers, Test_Markers2, Test_Markers3)
Test_Markers_all <- unique(Test_Markers_all)

SC_Stable2 <- subset(OTU_SC_Compare, 0 < Mean_Stable)
SC_Markers2 <- SC_Stable2$Species

Overall_Markers_Shared2 <- Hand_Markers_Shared2[Hand_Markers_Shared2  %in% SC_Markers2]



```

```{r}
norm_Marker <-  transform_sample_counts(PHY2, function(x) x / sum(x) )
```

```{r}
SNP_Marker_1 <- subset_taxa(norm_Marker, phylum=="k127_8579181")
#SNP_Marker_1 <- subset_taxa(PHY2, phylum=="k127_8579181")
SNP_Marker_1<-psmelt(SNP_Marker_1)
#SNP_Marker_1$log_Abundance<-log(SNP_Marker_1$Abundance)
SNP_Marker_1_LH <- SNP_Marker_1[grep("left", SNP_Marker_1$Location), ]
ggplot(SNP_Marker_1_LH, aes(x=Time_Week, y=Abundance, color=Subject)) + geom_point() + geom_line()
ggplot(SNP_Marker_1, aes(x=Time_Week, y=Abundance, color=Location)) + geom_point() + geom_line() + facet_wrap(~Subject)
```

```{r}
SNP_Marker_2 <- subset_taxa(norm_Marker, phylum=="k127_885656")
#SNP_Marker_2 <- subset_taxa(PHY2, phylum=="k127_885656")
SNP_Marker_2<-psmelt(SNP_Marker_2)
#SNP_Marker_2$log_Abundance<-log(SNP_Marker_2$Abundance)
SNP_Marker_2_LH <- SNP_Marker_2[grep("left", SNP_Marker_2$Location), ]
ggplot(SNP_Marker_2_LH, aes(x=Time_Week, y=Abundance, color=Subject)) + geom_point() + geom_line()
ggplot(SNP_Marker_2, aes(x=Time_Week, y=Abundance, color=Location)) + geom_point() + geom_line() + facet_wrap(~Subject)
```

```{r}
SNP_Marker_3 <- subset_taxa(norm_Marker, phylum=="k127_911284")
#SNP_Marker_3 <- subset_taxa(PHY2, phylum=="k127_911284")
SNP_Marker_3<-psmelt(SNP_Marker_3)
#SNP_Marker_3$log_Abundance<-log(SNP_Marker_3$Abundance)
SNP_Marker_3_LH <- SNP_Marker_3[grep("left", SNP_Marker_3$Location), ]
ggplot(SNP_Marker_3_LH, aes(x=Time_Week, y=Abundance, color=Subject)) + geom_point() + geom_line()
ggplot(SNP_Marker_3, aes(x=Time_Week, y=Abundance, color=Location)) + geom_point() + geom_line() + facet_wrap(~Subject)
```

```{r}
Stable_Marker_1 <- subset_taxa(norm_Marker, phylum=="k127_1182587")
#Stable_Marker_1 <- subset_taxa(PHY2, phylum=="k127_1182587")
Stable_Marker_1<-psmelt(Stable_Marker_1)
#Stable_Marker_1$log_Abundance<-log(Stable_Marker_1$Abundance)
Stable_Marker_1_LH <- Stable_Marker_1[grep("left", Stable_Marker_1$Location), ]
ggplot(Stable_Marker_1_LH, aes(x=Time_Week, y=Abundance, color=Subject)) + geom_point() + geom_line()
ggplot(Stable_Marker_1, aes(x=Time_Week, y=Abundance, color=Location)) + geom_point() + geom_line() + facet_wrap(~Subject)
```
```{r}
Hnd_Stable_Markers<-subset_taxa(PHY2, (phylum %in% Hand_Markers_Shared) )
Hnd_Stable_Markers<-psmelt(Hnd_Stable_Markers)
Hnd_Stable_Markers_LH <- Hnd_Stable_Markers[grep("left", Hnd_Stable_Markers$Location), ]
Hnd_Stable_Markers_RH <- Hnd_Stable_Markers[grep("right", Hnd_Stable_Markers$Location), ]
Hnd_Stable_Markers_SC <- Hnd_Stable_Markers[grep("scalp", Hnd_Stable_Markers$Location), ]
ggplot(Hnd_Stable_Markers_LH, aes(x=Time_Week, y=Abundance, color=OTU)) + geom_point() + geom_line() + facet_wrap(~Subject)
ggplot(Hnd_Stable_Markers_RH, aes(x=Time_Week, y=Abundance, color=OTU)) + geom_point() + geom_line() + facet_wrap(~Subject) +ylim(1,max(Hnd_Stable_Markers_RH$Abundance))
ggplot(Hnd_Stable_Markers_SC, aes(x=Time_Week, y=Abundance, color=OTU)) + geom_point() + geom_line() + facet_wrap(~Subject) +ylim(1,max(Hnd_Stable_Markers_SC$Abundance))

```

Hand_Markers_Shared



