---
title: "paper_heatmap"
output: html_document
---

```{r setup, include=FALSE}
library(NRES803)
library(tidyverse)
library(GGally)
library(readr)
library(mgcv)
library(broom)
library(gridExtra)
library(lme4)
library(lmerTest)
library(broom.mixed)
library(readr)
library(phyloseq)
library(dplyr)
library(tidyr)
library(ggplot2)
library(phyloseq)
library(tidyverse)
library(microbiome)
library(readr)
library("ggpubr")
library("tidyverse")
library(vegan)
library(ComplexHeatmap)
library(gridBase)
library(metagenomeSeq)
library(bbmle)
library(glmmTMB)
library(circlize)
library(plyr)
```

Merge the reference Papillomaviridae taxonomy file and the count abundance table of reads mapped to the reference Papillomaviridae genomes
```{r,message=FALSE,warning=FALSE,results="hide"}
PAP_counts <- read.csv("papilloma/PAPcounts.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
PAP_counts <- subset(PAP_counts, select = -c(length))
PAP_tax <- read.csv("papilloma/papilloma_taxa.csv", quote = "", header = TRUE, stringsAsFactors = FALSE, row.names = 1)
PAP_tax <- subset(PAP_tax, select = -c(Serotype,Isolate))
PAP_OTU <- merge(PAP_tax, PAP_counts, by.x="row.names", by.y="row.names")
PAP_OTU<- subset (PAP_OTU, select = -c(Row.names))
```
Subset by species and sum across species for each sample to get the total abundance of each Papillomaviridae species per sample
```{r,message=FALSE,warning=FALSE,results="hide"}
PAP_OTU_SUMS<- subset (PAP_OTU, select = -c(Superkingdom, Realm, Kingdom, Phylum, Class, Order, Family, Subfamily, Genus))
PAP_OTU_SUMS<-ddply(PAP_OTU_SUMS,"Species",numcolwise(sum))
PAP_OTU_SUMS<- subset (PAP_OTU_SUMS, select = -c(HV_027_01,HV_027_02,HV_027_03,HV_027_04,HV_027_05,HV_027_06,HV_027_07, HV_015_20, HV_015_21, HV_020_10, HV_020_22, HV_021_13))
PAPStable <- PAP_OTU_SUMS
```
Convert abundance into binary presence/absence 
```{r,message=FALSE,warning=FALSE,results="hide"}
PAPStable <- PAPStable %>% mutate_if(is.numeric, ~1 * (. != 0))
```
Determine Papillomaviridae species prevalence over the five time points by location within a subject
```{r,message=FALSE,warning=FALSE,results="hide"}
#P01 Left
PAPStable$P01_LH <- PAPStable$HV_001_01 + PAPStable$HV_002_01 + PAPStable$HV_003_01 + PAPStable$HV_004_01 + PAPStable$HV_005_01
PAPStable <- subset(PAPStable, select = -c(HV_001_01,HV_002_01,HV_003_01,HV_004_01,HV_005_01 ))
#P01 Right
PAPStable$P01_RH <- PAPStable$HV_001_02 + PAPStable$HV_002_02 + PAPStable$HV_003_02 + PAPStable$HV_004_02
PAPStable <- subset(PAPStable, select = -c(HV_001_02,HV_002_02,HV_003_02,HV_004_02 ))
#P01 Scalp
PAPStable$P01_SC <- PAPStable$HV_001_03 + PAPStable$HV_004_03 + PAPStable$HV_003_03 + PAPStable$HV_005_03 + PAPStable$HV_002_03
PAPStable <- subset(PAPStable, select = -c(HV_001_03,HV_002_03,HV_003_03,HV_004_03,HV_005_03 ))
#P02 Left
PAPStable$P02_LH <- PAPStable$HV_001_04 + PAPStable$HV_002_04 + PAPStable$HV_003_04 + PAPStable$HV_004_04 + PAPStable$HV_005_04
PAPStable <- subset(PAPStable, select = -c(HV_001_04,HV_002_04,HV_003_04,HV_004_04,HV_005_04 ))
#P02 Right
PAPStable$P02_RH <- PAPStable$HV_001_05 + PAPStable$HV_002_05 + PAPStable$HV_003_05 + PAPStable$HV_004_05 + PAPStable$HV_005_05
PAPStable <- subset(PAPStable, select = -c(HV_001_05,HV_002_05,HV_003_05,HV_004_05,HV_005_05 ))
#P02 Scalp
PAPStable$P02_SC <- PAPStable$HV_001_06 + PAPStable$HV_002_06 + PAPStable$HV_003_06 + PAPStable$HV_004_06 + PAPStable$HV_005_06
PAPStable <- subset(PAPStable, select = -c(HV_001_06,HV_002_06,HV_003_06,HV_004_06,HV_005_06 ))
#P03 Left
PAPStable$P03_LH <- PAPStable$HV_001_07 + PAPStable$HV_002_07 + PAPStable$HV_003_07 + PAPStable$HV_004_07 + PAPStable$HV_005_07
PAPStable <- subset(PAPStable, select = -c(HV_001_07,HV_002_07,HV_003_07,HV_004_07,HV_005_07 ))
#P03 Right
PAPStable$P03_RH <- PAPStable$HV_001_08 + PAPStable$HV_002_08 + PAPStable$HV_003_08 + PAPStable$HV_004_08 + PAPStable$HV_005_08
PAPStable <- subset(PAPStable, select = -c(HV_001_08,HV_002_08,HV_003_08,HV_004_08,HV_005_08 ))
#P03 Scalp
PAPStable$P03_SC <- PAPStable$HV_001_09 + PAPStable$HV_002_09 + PAPStable$HV_003_09 + PAPStable$HV_004_09 + PAPStable$HV_005_09
PAPStable <- subset(PAPStable, select = -c(HV_001_09,HV_002_09,HV_003_09,HV_004_09,HV_005_09 ))
#P04 Left
PAPStable$P04_LH <- PAPStable$HV_001_10 + PAPStable$HV_002_10 + PAPStable$HV_003_10 + PAPStable$HV_004_10 + PAPStable$HV_005_10
PAPStable <- subset(PAPStable, select = -c(HV_001_10,HV_002_10,HV_003_10,HV_004_10,HV_005_10 ))
#P04 Right
PAPStable$P04_RH <- PAPStable$HV_001_11 + PAPStable$HV_002_11 + PAPStable$HV_003_11 + PAPStable$HV_004_11 + PAPStable$HV_005_11
PAPStable <- subset(PAPStable, select = -c(HV_001_11,HV_002_11,HV_003_11,HV_004_11,HV_005_11 ))
#P04 Scalp
PAPStable$P04_SC <- PAPStable$HV_001_12 + PAPStable$HV_002_12 + PAPStable$HV_003_12 + PAPStable$HV_004_12 + PAPStable$HV_005_12
PAPStable <- subset(PAPStable, select = -c(HV_001_12,HV_002_12,HV_003_12,HV_004_12,HV_005_12 ))
#P05 Left
PAPStable$P05_LH <- PAPStable$HV_001_13 + PAPStable$HV_002_13 + PAPStable$HV_003_13 + PAPStable$HV_004_13 + PAPStable$HV_005_13
PAPStable <- subset(PAPStable, select = -c(HV_001_13,HV_002_13,HV_003_13,HV_004_13,HV_005_13 ))
#P05 Right
PAPStable$P05_RH <- PAPStable$HV_001_14 + PAPStable$HV_002_14 + PAPStable$HV_003_14 + PAPStable$HV_004_14 + PAPStable$HV_005_14
PAPStable <- subset(PAPStable, select = -c(HV_001_14,HV_002_14,HV_003_14,HV_004_14,HV_005_14 ))
#P05 Scalp
PAPStable$P05_SC <- PAPStable$HV_001_15 + PAPStable$HV_002_15  + PAPStable$HV_004_15+PAPStable$HV_003_15 + PAPStable$HV_005_15
PAPStable <- subset(PAPStable, select = -c(HV_001_15,HV_002_15,HV_004_15,HV_005_15,HV_003_15 ))
#P06 Left
PAPStable$P06_LH <- PAPStable$HV_001_16 + PAPStable$HV_003_16 + PAPStable$HV_004_16 + PAPStable$HV_005_16
PAPStable <- subset(PAPStable, select = -c(HV_001_16,HV_003_16,HV_004_16,HV_005_16 ))
#P06 Right
PAPStable$P06_RH <- PAPStable$HV_001_18 + PAPStable$HV_002_18 + PAPStable$HV_003_18 + PAPStable$HV_004_18 + PAPStable$HV_005_18
PAPStable <- subset(PAPStable, select = -c(HV_001_18,HV_002_18,HV_003_18,HV_004_18,HV_005_18 ))
#P06 Scalp
PAPStable$P06_SC <- PAPStable$HV_001_19 + PAPStable$HV_002_19 + PAPStable$HV_003_19 + PAPStable$HV_004_19 + PAPStable$HV_005_19
PAPStable <- subset(PAPStable, select = -c(HV_001_19,HV_002_19,HV_003_19,HV_004_19,HV_005_19 ))
#P07 Left
PAPStable$P07_LH <- PAPStable$HV_001_20 + PAPStable$HV_002_20 + PAPStable$HV_003_20 + PAPStable$HV_004_20 + PAPStable$HV_005_20
PAPStable <- subset(PAPStable, select = -c(HV_001_20,HV_002_20,HV_003_20,HV_004_20,HV_005_20 ))
#P07 Right
PAPStable$P07_RH <- PAPStable$HV_001_21 + PAPStable$HV_002_21 + PAPStable$HV_003_21 + PAPStable$HV_004_21 
PAPStable <- subset(PAPStable, select = -c(HV_001_21,HV_002_21,HV_003_21,HV_004_21 ))
#P07 Scalp
PAPStable$P07_SC <- PAPStable$HV_001_22 + PAPStable$HV_002_22 + PAPStable$HV_003_22 + PAPStable$HV_004_22 + PAPStable$HV_005_22
PAPStable <- subset(PAPStable, select = -c(HV_001_22,HV_002_22,HV_003_22,HV_004_22,HV_005_22 ))
#P08 Left
PAPStable$P08_LH <- PAPStable$HV_006_01 + PAPStable$HV_007_01 + PAPStable$HV_008_01 + PAPStable$HV_009_01 + PAPStable$HV_010_01
PAPStable <- subset(PAPStable, select = -c(HV_006_01,HV_007_01,HV_008_01,HV_009_01,HV_010_01))
#P08 Right
PAPStable$P08_RH <- PAPStable$HV_006_02 + PAPStable$HV_007_02 + PAPStable$HV_008_02 + PAPStable$HV_010_02
PAPStable <- subset(PAPStable, select = -c(HV_006_02,HV_007_02,HV_008_02,HV_010_02))
#P08 Scalp
PAPStable$P08_SC <- PAPStable$HV_006_03 + PAPStable$HV_007_03 + PAPStable$HV_008_03 + PAPStable$HV_009_03 + PAPStable$HV_010_03
PAPStable <- subset(PAPStable, select = -c(HV_006_03,HV_007_03,HV_008_03,HV_009_03,HV_010_03))
#P09 Left
PAPStable$P09_LH <- PAPStable$HV_006_04 + PAPStable$HV_007_04 + PAPStable$HV_008_04 + PAPStable$HV_009_04 + PAPStable$HV_010_04
PAPStable <- subset(PAPStable, select = -c(HV_006_04,HV_007_04,HV_008_04,HV_009_04,HV_010_04))
#P09 Right
PAPStable$P09_RH <- PAPStable$HV_006_05 + PAPStable$HV_007_05 + PAPStable$HV_008_05 + PAPStable$HV_009_05 + PAPStable$HV_010_05
PAPStable <- subset(PAPStable, select = -c(HV_006_05,HV_007_05,HV_008_05,HV_009_05,HV_010_05))
#P09 Scalp
PAPStable$P09_SC <- PAPStable$HV_006_06 + PAPStable$HV_007_06 + PAPStable$HV_008_06 + PAPStable$HV_009_06 + PAPStable$HV_010_06
PAPStable <- subset(PAPStable, select = -c(HV_006_06,HV_007_06,HV_008_06,HV_009_06,HV_010_06))
#P10 Left
PAPStable$P10_LH <- PAPStable$HV_006_07 + PAPStable$HV_007_07 + PAPStable$HV_008_07 + PAPStable$HV_009_07 + PAPStable$HV_010_07
PAPStable <- subset(PAPStable, select = -c(HV_006_07,HV_007_07,HV_008_07,HV_009_07,HV_010_07))
#P10 Right
PAPStable$P10_RH <- PAPStable$HV_006_08 + PAPStable$HV_007_08 + PAPStable$HV_008_08 + PAPStable$HV_009_08 + PAPStable$HV_010_08
PAPStable <- subset(PAPStable, select = -c(HV_006_08,HV_007_08,HV_008_08,HV_009_08,HV_010_08))
#P10 Scalp
PAPStable$P10_SC <- PAPStable$HV_006_09 + PAPStable$HV_007_09 + PAPStable$HV_008_09 + PAPStable$HV_009_09 + PAPStable$HV_010_09
PAPStable <- subset(PAPStable, select = -c(HV_006_09,HV_007_09,HV_008_09,HV_009_09,HV_010_09))
#P11 Left
PAPStable$P11_LH <- PAPStable$HV_006_10 + PAPStable$HV_007_10 + PAPStable$HV_008_10 + PAPStable$HV_009_10 + PAPStable$HV_010_10
PAPStable <- subset(PAPStable, select = -c(HV_006_10,HV_007_10,HV_008_10,HV_009_10,HV_010_10))
#P11 Right
PAPStable$P11_RH <- PAPStable$HV_006_11 + PAPStable$HV_007_11 + PAPStable$HV_008_11 + PAPStable$HV_009_11 + PAPStable$HV_010_11
PAPStable <- subset(PAPStable, select = -c(HV_006_11,HV_007_11,HV_008_11,HV_009_11,HV_010_11))
#P11 Scalp
PAPStable$P11_SC <- PAPStable$HV_006_12 + PAPStable$HV_007_12 + PAPStable$HV_008_12 + PAPStable$HV_009_12 + PAPStable$HV_010_12
PAPStable <- subset(PAPStable, select = -c(HV_006_12,HV_007_12,HV_008_12,HV_009_12,HV_010_12))
#P12 Left
PAPStable$P12_LH <- PAPStable$HV_006_13 + PAPStable$HV_007_13 + PAPStable$HV_008_13 + PAPStable$HV_009_13 + PAPStable$HV_010_13
PAPStable <- subset(PAPStable, select = -c(HV_006_13,HV_007_13,HV_008_13,HV_009_13,HV_010_13))
#P12 Right
PAPStable$P12_RH <- PAPStable$HV_006_14 + PAPStable$HV_007_14 + PAPStable$HV_008_14 + PAPStable$HV_009_14 + PAPStable$HV_010_14
PAPStable <- subset(PAPStable, select = -c(HV_006_14,HV_007_14,HV_008_14,HV_009_14,HV_010_14))
#P12 Scalp
PAPStable$P12_SC <- PAPStable$HV_006_15 + PAPStable$HV_007_15 + PAPStable$HV_008_15 + PAPStable$HV_009_15 + PAPStable$HV_010_15
PAPStable <- subset(PAPStable, select = -c(HV_006_15,HV_007_15,HV_008_15,HV_009_15,HV_010_15))
#P13 Left
PAPStable$P13_LH <- PAPStable$HV_006_16 + PAPStable$HV_007_16 + PAPStable$HV_008_16 + PAPStable$HV_009_16 + PAPStable$HV_010_16
PAPStable <- subset(PAPStable, select = -c(HV_006_16,HV_007_16,HV_008_16,HV_009_16,HV_010_16))
#P13 Right
PAPStable$P13_RH <- PAPStable$HV_006_18 + PAPStable$HV_007_18 + PAPStable$HV_008_18 + PAPStable$HV_009_18 + PAPStable$HV_010_18
PAPStable <- subset(PAPStable, select = -c(HV_006_18,HV_007_18,HV_008_18,HV_009_18,HV_010_18))
#P13 Scalp
PAPStable$P13_SC <- PAPStable$HV_006_19 + PAPStable$HV_007_19 + PAPStable$HV_008_19 + PAPStable$HV_009_19 + PAPStable$HV_010_19
PAPStable <- subset(PAPStable, select = -c(HV_006_19,HV_007_19,HV_008_19,HV_009_19,HV_010_19))
#P14 Left
PAPStable$P14_LH <- PAPStable$HV_006_20 + PAPStable$HV_007_20 + PAPStable$HV_008_20 + PAPStable$HV_009_20 + PAPStable$HV_010_20
PAPStable <- subset(PAPStable, select = -c(HV_006_20,HV_007_20,HV_008_20,HV_009_20,HV_010_20))
#P14 Right
PAPStable$P14_RH <- PAPStable$HV_006_21 + PAPStable$HV_007_21 + PAPStable$HV_008_21 + PAPStable$HV_009_21 + PAPStable$HV_010_21
PAPStable <- subset(PAPStable, select = -c(HV_006_21,HV_007_21,HV_008_21,HV_009_21,HV_010_21))
#P14 Scalp
PAPStable$P14_SC <- PAPStable$HV_006_22 + PAPStable$HV_007_22 + PAPStable$HV_008_22 + PAPStable$HV_009_22 + PAPStable$HV_010_22
PAPStable <- subset(PAPStable, select = -c(HV_006_22,HV_007_22,HV_008_22,HV_009_22,HV_010_22))
#P15 Left
PAPStable$P15_LH <- PAPStable$HV_011_01 + PAPStable$HV_012_01 + PAPStable$HV_013_01 + PAPStable$HV_014_01 + PAPStable$HV_015_01
PAPStable <- subset(PAPStable, select = -c(HV_011_01,HV_012_01,HV_013_01,HV_014_01,HV_015_01))
#P15 Right
PAPStable$P15_RH <- PAPStable$HV_011_02 + PAPStable$HV_012_02 + PAPStable$HV_013_02 + PAPStable$HV_014_02 + PAPStable$HV_015_02
PAPStable <- subset(PAPStable, select = -c(HV_011_02,HV_012_02,HV_013_02,HV_014_02,HV_015_02))
#P15 Scalp
PAPStable$P15_SC <- PAPStable$HV_011_03 + PAPStable$HV_012_03 + PAPStable$HV_013_03 + PAPStable$HV_014_03 + PAPStable$HV_015_03
PAPStable <- subset(PAPStable, select = -c(HV_011_03,HV_012_03,HV_013_03,HV_014_03,HV_015_03))
#P16 Left
PAPStable$P16_LH <- PAPStable$HV_011_04 + PAPStable$HV_012_04 + PAPStable$HV_013_04 + PAPStable$HV_014_04 + PAPStable$HV_015_04
PAPStable <- subset(PAPStable, select = -c(HV_011_04,HV_012_04,HV_013_04,HV_014_04,HV_015_04))
#P16 Right
PAPStable$P16_RH <- PAPStable$HV_011_05 + PAPStable$HV_012_05 + PAPStable$HV_013_05 + PAPStable$HV_014_05 + PAPStable$HV_015_05
PAPStable <- subset(PAPStable, select = -c(HV_011_05,HV_012_05,HV_013_05,HV_014_05,HV_015_05))
#P16 Scalp
PAPStable$P16_SC <- PAPStable$HV_011_06 + PAPStable$HV_012_06 ++ PAPStable$HV_014_06 + PAPStable$HV_015_06
PAPStable <- subset(PAPStable, select = -c(HV_011_06,HV_012_06,HV_014_06,HV_015_06))
#P17 Left
PAPStable$P17_LH <- PAPStable$HV_011_07 + PAPStable$HV_012_07 + PAPStable$HV_013_07 + PAPStable$HV_014_07 + PAPStable$HV_015_07
PAPStable <- subset(PAPStable, select = -c(HV_011_07,HV_012_07,HV_013_07,HV_014_07,HV_015_07))
#P17 Right
PAPStable$P17_RH <- PAPStable$HV_011_08 + PAPStable$HV_012_08 + PAPStable$HV_013_08 + PAPStable$HV_014_08 + PAPStable$HV_015_08
PAPStable <- subset(PAPStable, select = -c(HV_011_08,HV_012_08,HV_013_08,HV_014_08,HV_015_08))
#P17 Scalp
PAPStable$P17_SC <- PAPStable$HV_011_09 + PAPStable$HV_012_09 + PAPStable$HV_013_09 + PAPStable$HV_014_09 + PAPStable$HV_015_09
PAPStable <- subset(PAPStable, select = -c(HV_011_09,HV_012_09,HV_013_09,HV_014_09,HV_015_09))
#P18 Left
PAPStable$P18_LH <- PAPStable$HV_011_10 + PAPStable$HV_012_10 + PAPStable$HV_013_10 + PAPStable$HV_014_10 + PAPStable$HV_015_10
PAPStable <- subset(PAPStable, select = -c(HV_011_10,HV_012_10,HV_013_10,HV_014_10,HV_015_10))
#P18 Right
PAPStable$P18_RH <- PAPStable$HV_011_11 + PAPStable$HV_012_11 + PAPStable$HV_013_11 + PAPStable$HV_014_11 + PAPStable$HV_015_11
PAPStable <- subset(PAPStable, select = -c(HV_011_11,HV_012_11,HV_013_11,HV_014_11,HV_015_11))
#P18 Scalp
PAPStable$P18_SC <- PAPStable$HV_011_12 + PAPStable$HV_012_12 + PAPStable$HV_013_12 + PAPStable$HV_014_12 + PAPStable$HV_015_12
PAPStable <- subset(PAPStable, select = -c(HV_011_12,HV_012_12,HV_013_12,HV_014_12,HV_015_12))
#P19 Left
PAPStable$P19_LH <- PAPStable$HV_011_13 + PAPStable$HV_012_13 + PAPStable$HV_013_13 + PAPStable$HV_014_13 + PAPStable$HV_015_13
PAPStable <- subset(PAPStable, select = -c(HV_011_13,HV_012_13,HV_013_13,HV_014_13,HV_015_13))
#P19 Right
PAPStable$P19_RH <- PAPStable$HV_011_14 + PAPStable$HV_012_14 + PAPStable$HV_013_14 + PAPStable$HV_014_14 + PAPStable$HV_015_14
PAPStable <- subset(PAPStable, select = -c(HV_011_14,HV_012_14,HV_013_14,HV_014_14,HV_015_14))
#P19 Scalp
PAPStable$P19_SC <- PAPStable$HV_011_15 + PAPStable$HV_012_15 + PAPStable$HV_013_15 + PAPStable$HV_014_15 + PAPStable$HV_015_15
PAPStable <- subset(PAPStable, select = -c(HV_011_15,HV_012_15,HV_013_15,HV_014_15,HV_015_15))
#P20 Left
PAPStable$P20_LH <- PAPStable$HV_011_16 + PAPStable$HV_012_16 + PAPStable$HV_013_16 + PAPStable$HV_014_16 + PAPStable$HV_015_16
PAPStable <- subset(PAPStable, select = -c(HV_011_16,HV_012_16,HV_013_16,HV_014_16,HV_015_16))
#P20 Right
PAPStable$P20_RH <- PAPStable$HV_011_18 + PAPStable$HV_012_18 + PAPStable$HV_013_18 + PAPStable$HV_014_18 + PAPStable$HV_015_18
PAPStable <- subset(PAPStable, select = -c(HV_011_18,HV_012_18,HV_013_18,HV_014_18,HV_015_18))
#P20 Scalp
PAPStable$P20_SC <- PAPStable$HV_011_19 + PAPStable$HV_012_19 + PAPStable$HV_013_19 + PAPStable$HV_014_19 + PAPStable$HV_015_19
PAPStable <- subset(PAPStable, select = -c(HV_011_19,HV_012_19,HV_013_19,HV_014_19,HV_015_19))
#P21 Left
PAPStable$P21_LH <- PAPStable$HV_011_20 + PAPStable$HV_012_20 + PAPStable$HV_013_20 + PAPStable$HV_014_20
PAPStable <- subset(PAPStable, select = -c(HV_011_20,HV_012_20,HV_013_20,HV_014_20))
#P21 Right
PAPStable$P21_RH <- PAPStable$HV_011_21 + PAPStable$HV_012_21 + PAPStable$HV_013_21 + PAPStable$HV_014_21
PAPStable <- subset(PAPStable, select = -c(HV_011_21,HV_012_21,HV_013_21,HV_014_21))
#P21 Scalp
PAPStable$P21_SC <- PAPStable$HV_011_22 + PAPStable$HV_012_22 + PAPStable$HV_013_22 + PAPStable$HV_014_22
PAPStable <- subset(PAPStable, select = -c(HV_011_22,HV_012_22,HV_013_22,HV_014_22))
#P22 Left
PAPStable$P22_LH <- PAPStable$HV_021_02 + PAPStable$HV_022_01 + PAPStable$HV_023_01 + PAPStable$HV_024_01 + PAPStable$HV_025_02
PAPStable <- subset(PAPStable, select = -c(HV_021_02,HV_022_01,HV_023_01,HV_024_01,HV_025_02))
#P22 Right
PAPStable$P22_RH <- PAPStable$HV_026_01 + PAPStable$HV_027_08 + PAPStable$HV_028_01 + PAPStable$HV_029_01 + PAPStable$HV_030_01
PAPStable <- subset(PAPStable, select = -c(HV_026_01,HV_027_08,HV_028_01,HV_029_01,HV_030_01))
#P22 Scalp
PAPStable$P22_SC <- PAPStable$HV_016_01 + PAPStable$HV_017_01 + PAPStable$HV_018_01 + PAPStable$HV_019_01 + PAPStable$HV_020_01
PAPStable <- subset(PAPStable, select = -c(HV_016_01,HV_017_01,HV_018_01,HV_019_01,HV_020_01))
#P23 Left
PAPStable$P23_LH <- PAPStable$HV_021_03 + PAPStable$HV_022_02 + PAPStable$HV_023_02 + PAPStable$HV_024_02 + PAPStable$HV_025_03
PAPStable <- subset(PAPStable, select = -c(HV_021_03,HV_022_02,HV_023_02,HV_024_02,HV_025_03))
#P23 Right
PAPStable$P23_RH <- PAPStable$HV_026_02 + PAPStable$HV_027_09 + PAPStable$HV_028_02 + PAPStable$HV_029_02 + PAPStable$HV_030_02
PAPStable <- subset(PAPStable, select = -c(HV_026_02,HV_027_09,HV_028_02,HV_029_02,HV_030_02))
#P23 Scalp
PAPStable$P23_SC <- PAPStable$HV_016_02 + PAPStable$HV_017_02 + PAPStable$HV_018_02 + PAPStable$HV_019_02 + PAPStable$HV_020_02
PAPStable <- subset(PAPStable, select = -c(HV_016_02,HV_017_02,HV_018_02,HV_019_02,HV_020_02))
#P24 Left
PAPStable$P24_LH <- PAPStable$HV_021_04 + PAPStable$HV_022_03 + PAPStable$HV_023_03 + PAPStable$HV_024_03 + PAPStable$HV_025_04
PAPStable <- subset(PAPStable, select = -c(HV_021_04,HV_022_03,HV_023_03,HV_024_03,HV_025_04))
#P24 Right
PAPStable$P24_RH <- PAPStable$HV_026_03 + PAPStable$HV_027_10 + PAPStable$HV_028_03 + PAPStable$HV_029_03 + PAPStable$HV_030_03
PAPStable <- subset(PAPStable, select = -c(HV_026_03,HV_027_10,HV_028_03,HV_029_03,HV_030_03))
#P24 Scalp
PAPStable$P24_SC <- PAPStable$HV_016_03 + PAPStable$HV_017_03 + PAPStable$HV_018_03 + PAPStable$HV_019_03 + PAPStable$HV_021_01
PAPStable <- subset(PAPStable, select = -c(HV_016_03,HV_017_03,HV_018_03,HV_019_03,HV_021_01))
#P25 Left
PAPStable$P25_LH <- PAPStable$HV_021_05 + PAPStable$HV_022_04 + PAPStable$HV_023_04 + PAPStable$HV_024_04 + PAPStable$HV_025_05
PAPStable <- subset(PAPStable, select = -c(HV_021_05,HV_022_04,HV_023_04,HV_024_04,HV_025_05))
#P25 Right
PAPStable$P25_RH <- PAPStable$HV_026_04 + PAPStable$HV_027_11 + PAPStable$HV_028_04 + PAPStable$HV_029_04 + PAPStable$HV_030_04
PAPStable <- subset(PAPStable, select = -c(HV_026_04,HV_027_11,HV_028_04,HV_029_04,HV_030_04))
#P25 Scalp
PAPStable$P25_SC <- PAPStable$HV_016_04 + PAPStable$HV_017_04 + PAPStable$HV_018_04 + PAPStable$HV_019_04 + PAPStable$HV_020_03
PAPStable <- subset(PAPStable, select = -c(HV_016_04,HV_017_04,HV_018_04,HV_019_04,HV_020_03))
#P26 Left
PAPStable$P26_LH <- PAPStable$HV_021_06 + PAPStable$HV_022_05 + PAPStable$HV_023_05 + PAPStable$HV_024_05 + PAPStable$HV_025_06
PAPStable <- subset(PAPStable, select = -c(HV_021_06,HV_022_05,HV_023_05,HV_024_05,HV_025_06))
#P26 Right
PAPStable$P26_RH <- PAPStable$HV_026_05 + PAPStable$HV_027_12 + PAPStable$HV_028_05 + PAPStable$HV_029_05 + PAPStable$HV_030_05
PAPStable <- subset(PAPStable, select = -c(HV_026_05,HV_027_12,HV_028_05,HV_029_05,HV_030_05))
#P26 Scalp
PAPStable$P26_SC <- PAPStable$HV_016_05 + PAPStable$HV_017_05 + PAPStable$HV_018_05 + PAPStable$HV_019_05 + PAPStable$HV_020_04
PAPStable <- subset(PAPStable, select = -c(HV_016_05,HV_017_05,HV_018_05,HV_019_05,HV_020_04))
#P27 Left
PAPStable$P27_LH <- PAPStable$HV_021_07 + PAPStable$HV_022_06 + PAPStable$HV_023_06 + PAPStable$HV_024_06 + PAPStable$HV_025_07
PAPStable <- subset(PAPStable, select = -c(HV_021_07,HV_022_06,HV_023_06,HV_024_06,HV_025_07))
#P27 Right
PAPStable$P27_RH <- PAPStable$HV_026_06 + PAPStable$HV_027_13 + PAPStable$HV_028_06 + PAPStable$HV_029_06 + PAPStable$HV_030_06
PAPStable <- subset(PAPStable, select = -c(HV_026_06,HV_027_13,HV_028_06,HV_029_06,HV_030_06))
#P27 Scalp
PAPStable$P27_SC <- PAPStable$HV_016_06 + PAPStable$HV_017_06 + PAPStable$HV_018_06 + PAPStable$HV_019_06 + PAPStable$HV_020_05
PAPStable <- subset(PAPStable, select = -c(HV_016_06,HV_017_06,HV_018_06,HV_019_06,HV_020_05))
#P28 Left
PAPStable$P28_LH <- PAPStable$HV_021_08 + PAPStable$HV_022_07 + PAPStable$HV_023_07 + PAPStable$HV_024_07 + PAPStable$HV_025_08
PAPStable <- subset(PAPStable, select = -c(HV_021_08,HV_022_07,HV_023_07,HV_024_07,HV_025_08))
#P28 Right
PAPStable$P28_RH <- PAPStable$HV_026_07 + PAPStable$HV_027_14 + PAPStable$HV_028_07 + PAPStable$HV_029_07 + PAPStable$HV_030_07
PAPStable <- subset(PAPStable, select = -c(HV_026_07,HV_027_14,HV_028_07,HV_029_07,HV_030_07))
#P28 Scalp
PAPStable$P28_SC <- PAPStable$HV_016_07 + PAPStable$HV_017_07 + PAPStable$HV_018_07 + PAPStable$HV_019_07 + PAPStable$HV_020_06
PAPStable <- subset(PAPStable, select = -c(HV_016_07,HV_017_07,HV_018_07,HV_019_07,HV_020_06))
#P29 Left
PAPStable$P29_LH <- PAPStable$HV_021_09 + PAPStable$HV_022_08 + PAPStable$HV_023_08 + PAPStable$HV_024_08 + PAPStable$HV_025_09
PAPStable <- subset(PAPStable, select = -c(HV_021_09,HV_022_08,HV_023_08,HV_024_08,HV_025_09))
#P29 Right
PAPStable$P29_RH <- PAPStable$HV_026_08 + PAPStable$HV_027_15 + PAPStable$HV_028_08 + PAPStable$HV_029_08 + PAPStable$HV_030_08
PAPStable <- subset(PAPStable, select = -c(HV_026_08,HV_027_15,HV_028_08,HV_029_08,HV_030_08))
#P29 Scalp
PAPStable$P29_SC <- PAPStable$HV_016_08 + PAPStable$HV_017_08 + PAPStable$HV_018_08 + PAPStable$HV_019_08 + PAPStable$HV_020_07
PAPStable <- subset(PAPStable, select = -c(HV_016_08,HV_017_08,HV_018_08,HV_019_08,HV_020_07))
#P30 Left
PAPStable$P30_LH <- PAPStable$HV_021_10 + PAPStable$HV_022_09 + PAPStable$HV_023_09 + PAPStable$HV_024_09 + PAPStable$HV_025_10
PAPStable <- subset(PAPStable, select = -c(HV_021_10,HV_022_09,HV_023_09,HV_024_09,HV_025_10))
#P30 Right
PAPStable$P30_RH <- PAPStable$HV_026_09 + PAPStable$HV_027_16 + PAPStable$HV_028_09 + PAPStable$HV_029_09 + PAPStable$HV_030_09
PAPStable <- subset(PAPStable, select = -c(HV_026_09,HV_027_16,HV_028_09,HV_029_09,HV_030_09))
#P30 Scalp
PAPStable$P30_SC <- PAPStable$HV_016_09 + PAPStable$HV_017_09 + PAPStable$HV_018_09 + PAPStable$HV_019_09 + PAPStable$HV_020_08
PAPStable <- subset(PAPStable, select = -c(HV_016_09,HV_017_09,HV_018_09,HV_019_09,HV_020_08))
#P31 Left
PAPStable$P31_LH <- PAPStable$HV_021_11 + PAPStable$HV_022_10 + PAPStable$HV_023_10 + PAPStable$HV_024_10
PAPStable <- subset(PAPStable, select = -c(HV_021_11,HV_022_10,HV_023_10,HV_024_10))
#P31 Right
PAPStable$P31_RH <- PAPStable$HV_026_10 + PAPStable$HV_027_18 + PAPStable$HV_028_10 + PAPStable$HV_029_10
PAPStable <- subset(PAPStable, select = -c(HV_026_10,HV_027_18,HV_028_10,HV_029_10))
#P31 Scalp
PAPStable$P31_SC <- PAPStable$HV_016_10 + PAPStable$HV_017_10 + PAPStable$HV_018_10 + PAPStable$HV_019_10
PAPStable <- subset(PAPStable, select = -c(HV_016_10,HV_017_10,HV_018_10,HV_019_10))
#P32 Left
PAPStable$P32_LH <- PAPStable$HV_021_12 + PAPStable$HV_022_11 + PAPStable$HV_023_11 + PAPStable$HV_024_11 + PAPStable$HV_025_11
PAPStable <- subset(PAPStable, select = -c(HV_021_12,HV_022_11,HV_023_11,HV_024_11,HV_025_11))
#P32 Right
PAPStable$P32_RH <- PAPStable$HV_026_11 + PAPStable$HV_027_19 + PAPStable$HV_028_11 + PAPStable$HV_029_11 + PAPStable$HV_030_10
PAPStable <- subset(PAPStable, select = -c(HV_026_11,HV_027_19,HV_028_11,HV_029_11,HV_030_10))
#P32 Scalp
PAPStable$P32_SC <- PAPStable$HV_016_11 + PAPStable$HV_017_11 + PAPStable$HV_018_11 + PAPStable$HV_019_11 + PAPStable$HV_020_09
PAPStable <- subset(PAPStable, select = -c(HV_016_11,HV_017_11,HV_018_11,HV_019_11,HV_020_09))
#P34 Left
PAPStable$P34_LH <- PAPStable$HV_021_14 + PAPStable$HV_022_12 + PAPStable$HV_023_12 + PAPStable$HV_024_12 + PAPStable$HV_025_12
PAPStable <- subset(PAPStable, select = -c(HV_021_14,HV_022_12,HV_023_12,HV_024_12,HV_025_12))
#P34 Right
PAPStable$P34_RH <- PAPStable$HV_026_12 + PAPStable$HV_027_20 + PAPStable$HV_028_12 + PAPStable$HV_029_12 + PAPStable$HV_030_11
PAPStable <- subset(PAPStable, select = -c(HV_026_12,HV_027_20,HV_028_12,HV_029_12,HV_030_11))
#P34 Scalp
PAPStable$P34_SC <- PAPStable$HV_016_12 + PAPStable$HV_017_12 + PAPStable$HV_018_12 + PAPStable$HV_019_12 + PAPStable$HV_020_11
PAPStable <- subset(PAPStable, select = -c(HV_016_12,HV_017_12,HV_018_12,HV_019_12,HV_020_11))
#P35 Left
PAPStable$P35_LH <- PAPStable$HV_021_15 + PAPStable$HV_022_13 + PAPStable$HV_023_13 + PAPStable$HV_024_13 + PAPStable$HV_025_13
PAPStable <- subset(PAPStable, select = -c(HV_021_15,HV_022_13,HV_023_13,HV_024_13,HV_025_13))
#P35 Right
PAPStable$P35_RH <- PAPStable$HV_026_13 + PAPStable$HV_027_21 + PAPStable$HV_028_13 + PAPStable$HV_029_13 + PAPStable$HV_030_12
PAPStable <- subset(PAPStable, select = -c(HV_026_13,HV_027_21,HV_028_13,HV_029_13,HV_030_12))
#P35 Scalp
PAPStable$P35_SC <- PAPStable$HV_016_13 + PAPStable$HV_017_13 + PAPStable$HV_018_13 + PAPStable$HV_019_13 + PAPStable$HV_020_12
PAPStable <- subset(PAPStable, select = -c(HV_016_13,HV_017_13,HV_018_13,HV_019_13,HV_020_12))
#P36 Left
PAPStable$P36_LH <- PAPStable$HV_021_16 + PAPStable$HV_022_14 + PAPStable$HV_023_14 + PAPStable$HV_024_14 + PAPStable$HV_025_14
PAPStable <- subset(PAPStable, select = -c(HV_021_16,HV_022_14,HV_023_14,HV_024_14,HV_025_14))
#P36 Right
PAPStable$P36_RH <- PAPStable$HV_026_14 + PAPStable$HV_027_22 + PAPStable$HV_028_14 + PAPStable$HV_029_14 + PAPStable$HV_030_13
PAPStable <- subset(PAPStable, select = -c(HV_026_14,HV_027_22,HV_028_14,HV_029_14,HV_030_13))
#P36 Scalp
PAPStable$P36_SC <- PAPStable$HV_016_14 + PAPStable$HV_017_14 + PAPStable$HV_018_14 + PAPStable$HV_019_14 + PAPStable$HV_020_13
PAPStable <- subset(PAPStable, select = -c(HV_016_14,HV_017_14,HV_018_14,HV_019_14,HV_020_13))
#P37 Left
PAPStable$P37_LH <- PAPStable$HV_021_18 + PAPStable$HV_022_15 + PAPStable$HV_023_15 + PAPStable$HV_024_15 + PAPStable$HV_025_15
PAPStable <- subset(PAPStable, select = -c(HV_021_18,HV_022_15,HV_023_15,HV_024_15,HV_025_15))
#P37 Right
PAPStable$P37_RH <- PAPStable$HV_026_15 + PAPStable$HV_028_15 + PAPStable$HV_029_15 + PAPStable$HV_030_14 + PAPStable$HV_030_22
PAPStable <- subset(PAPStable, select = -c(HV_026_15,HV_028_15,HV_029_15,HV_030_14,HV_030_22))
#P37 Scalp
PAPStable$P37_SC <- PAPStable$HV_016_15 + PAPStable$HV_017_15 + PAPStable$HV_018_15 + PAPStable$HV_019_15 + PAPStable$HV_020_14
PAPStable <- subset(PAPStable, select = -c(HV_016_15,HV_017_15,HV_018_15,HV_019_15,HV_020_14))
#P38 Left
PAPStable$P38_LH <- PAPStable$HV_021_19 + PAPStable$HV_022_16 + PAPStable$HV_023_16 + PAPStable$HV_024_16 + PAPStable$HV_025_16
PAPStable <- subset(PAPStable, select = -c(HV_021_19,HV_022_16,HV_023_16,HV_024_16,HV_025_16))
#P38 Right
PAPStable$P38_RH <- PAPStable$HV_026_16 + PAPStable$HV_028_16 + PAPStable$HV_029_16 + PAPStable$HV_030_15 
PAPStable <- subset(PAPStable, select = -c(HV_026_16,HV_028_16,HV_029_16,HV_030_15))
#P38 Scalp
PAPStable$P38_SC <- PAPStable$HV_016_16 + PAPStable$HV_017_16 + PAPStable$HV_018_16 + PAPStable$HV_019_16 + PAPStable$HV_020_15
PAPStable <- subset(PAPStable, select = -c(HV_016_16,HV_017_16,HV_018_16,HV_019_16,HV_020_15))
#P39 Left
PAPStable$P39_LH <- PAPStable$HV_021_20 + PAPStable$HV_022_18 + PAPStable$HV_023_18 + PAPStable$HV_024_18 + PAPStable$HV_025_18
PAPStable <- subset(PAPStable, select = -c(HV_021_20,HV_022_18,HV_023_18,HV_024_18,HV_025_18))
#P39 Right
PAPStable$P39_RH <- PAPStable$HV_026_18 + PAPStable$HV_028_18 + PAPStable$HV_029_18 + PAPStable$HV_030_16
PAPStable <- subset(PAPStable, select = -c(HV_026_18,HV_028_18,HV_029_18,HV_030_16))
#P39 Scalp
PAPStable$P39_SC <- PAPStable$HV_016_18 + PAPStable$HV_017_18 + PAPStable$HV_018_18 + PAPStable$HV_019_18 + PAPStable$HV_020_16
PAPStable <- subset(PAPStable, select = -c(HV_016_18,HV_017_18,HV_018_18,HV_019_18,HV_020_16))
#P40 Left
PAPStable$P40_LH <- PAPStable$HV_021_21 + PAPStable$HV_022_19 + PAPStable$HV_023_19 + PAPStable$HV_024_19 + PAPStable$HV_025_19
PAPStable <- subset(PAPStable, select = -c(HV_021_21,HV_022_19,HV_023_19,HV_024_19,HV_025_19))
#P40 Right
PAPStable$P40_RH <- PAPStable$HV_026_19 + PAPStable$HV_028_19 + PAPStable$HV_029_19 + PAPStable$HV_030_18
PAPStable <- subset(PAPStable, select = -c(HV_026_19,HV_028_19,HV_029_19,HV_030_18))
#P40 Scalp
PAPStable$P40_SC <- PAPStable$HV_016_19 + PAPStable$HV_017_19 + PAPStable$HV_018_19 + PAPStable$HV_019_19 + PAPStable$HV_020_18
PAPStable <- subset(PAPStable, select = -c(HV_016_19,HV_017_19,HV_018_19,HV_019_19,HV_020_18))
#P41 Left
PAPStable$P41_LH <- PAPStable$HV_021_22 + PAPStable$HV_022_20 + PAPStable$HV_023_20 + PAPStable$HV_024_20 + PAPStable$HV_025_20
PAPStable <- subset(PAPStable, select = -c(HV_021_22,HV_022_20,HV_023_20,HV_024_20,HV_025_20))
#P41 Right
PAPStable$P41_RH <- PAPStable$HV_026_20 + PAPStable$HV_028_20 + PAPStable$HV_029_20 + PAPStable$HV_030_19
PAPStable <- subset(PAPStable, select = -c(HV_026_20,HV_028_20,HV_029_20,HV_030_19))
#P41 Scalp
PAPStable$P41_SC <- PAPStable$HV_016_20 + PAPStable$HV_017_20 + PAPStable$HV_018_20 + PAPStable$HV_019_20 + PAPStable$HV_020_19
PAPStable <- subset(PAPStable, select = -c(HV_016_20,HV_017_20,HV_018_20,HV_019_20,HV_020_19))
#P42 Left
PAPStable$P42_LH <- PAPStable$HV_022_21 + PAPStable$HV_023_21 + PAPStable$HV_024_21 + PAPStable$HV_025_21 
PAPStable <- subset(PAPStable, select = -c(HV_022_21,HV_023_21,HV_024_21,HV_025_21))
#P42 Right
PAPStable$P42_RH <- PAPStable$HV_026_21 + PAPStable$HV_028_21 + PAPStable$HV_029_21 + PAPStable$HV_030_20
PAPStable <- subset(PAPStable, select = -c(HV_026_21,HV_028_21,HV_029_21,HV_030_20))
#P42 Scalp
PAPStable$P42_SC <- PAPStable$HV_016_21 + PAPStable$HV_017_21 + PAPStable$HV_018_21 + PAPStable$HV_019_21 + PAPStable$HV_020_20
PAPStable <- subset(PAPStable, select = -c(HV_016_21,HV_017_21,HV_018_21,HV_019_21,HV_020_20))
#P43 Left
PAPStable$P43_LH <- PAPStable$HV_022_22 + PAPStable$HV_023_22 + PAPStable$HV_024_22 + PAPStable$HV_025_01 + PAPStable$HV_025_22
PAPStable <- subset(PAPStable, select = -c(HV_022_22,HV_023_22,HV_024_22,HV_025_01,HV_025_22))
#P43 Right
PAPStable$P43_RH <- PAPStable$HV_026_22 + PAPStable$HV_028_22 + PAPStable$HV_029_22 + PAPStable$HV_030_21
PAPStable <- subset(PAPStable, select = -c(HV_026_22,HV_028_22,HV_029_22,HV_030_21))
#P43 Scalp
PAPStable$P43_SC <- PAPStable$HV_016_22 + PAPStable$HV_017_22 + PAPStable$HV_018_22 + PAPStable$HV_019_22 + PAPStable$HV_020_21
PAPStable <- subset(PAPStable, select = -c(HV_016_22,HV_017_22,HV_018_22,HV_019_22,HV_020_21))
```

## Set B Stable Left Hand Papillomaviridae Species
Subset by left hand and identify Papillomaviridae species that are persistent across 4 out of the 5 time points by subject
```{r,message=FALSE,warning=FALSE,results="hide"}
PAP_OTU_LH <- subset(PAPStable, select = c(P01_LH,P02_LH,P03_LH,P04_LH,P05_LH,P06_LH,P07_LH,P08_LH,P09_LH,P10_LH,P11_LH,P12_LH,P13_LH,P14_LH,P15_LH,P16_LH, P17_LH,P18_LH,P19_LH,P20_LH,P21_LH,P22_LH,P23_LH,P24_LH,P25_LH,P26_LH,P27_LH,P28_LH,P29_LH,P30_LH,P31_LH,P32_LH,P34_LH,P35_LH,P36_LH,P37_LH,P38_LH,P39_LH,P40_LH,P41_LH,P42_LH,P43_LH,Species))
row.names(PAP_OTU_LH) <- PAP_OTU_LH$Species
PAP_OTU_ALL_LH <- PAP_OTU_LH %>% mutate_if(is.numeric, ~1 * (. != 0))
row.names(PAP_OTU_ALL_LH) <- PAP_OTU_ALL_LH$Species
PAP_OTU_ALL_LH <- subset (PAP_OTU_ALL_LH, select = -c(Species))
PAP_OTU_ALL_LH$Mean <- rowMeans(PAP_OTU_ALL_LH)
PAP_OTU_ALL_LH$Species <- row.names(PAP_OTU_ALL_LH)
PAPStable_LH <- PAP_OTU_LH %>% mutate_if(is.numeric, ~1 * (. > 3 ))
row.names(PAPStable_LH) <- PAPStable_LH$Species
PAPStable_LH <- subset (PAPStable_LH, select = -c(Species))
PAPStable_LH$Mean_Stable <- rowMeans(PAPStable_LH)
PAPStable_LH$Species <- row.names(PAPStable_LH)
PAP_OTU_LH_Compare<- subset (PAPStable_LH, select = c(Mean_Stable,Species))
PAP_OTU_LH_Compare<- merge(PAP_OTU_ALL_LH, PAP_OTU_LH_Compare, by= "Species")
PAP_OTU_LH_Compare$Mean_temp <- PAP_OTU_LH_Compare$Mean - PAP_OTU_LH_Compare$Mean_Stable
PAP_LH_Stable2 <- subset(PAP_OTU_LH_Compare, 0 < Mean_Stable)
PAP_LH_Markers2 <- PAP_LH_Stable2$Species
```
Left hand Papillomaviridae species markers that are stable over time 
```{r}
PAP_LH_Markers2
```

## Set B Stable Right Hand Papillomaviridae Species
Subset by right hand and identify Papillomaviridae species that are persistent across 4 out of the 5 time points by subject
```{r,message=FALSE,warning=FALSE,results="hide"}
PAP_OTU_RH <- subset(PAPStable, select = c(P01_RH,P02_RH,P03_RH,P04_RH,P05_RH,P06_RH,P07_RH,P08_RH,P09_RH,P10_RH,P11_RH,P12_RH,P13_RH,P14_RH,P15_RH,P16_RH, P17_RH,P18_RH,P19_RH,P20_RH,P21_RH,P22_RH,P23_RH,P24_RH,P25_RH,P26_RH,P27_RH,P28_RH,P29_RH,P30_RH,P31_RH,P32_RH,P34_RH,P35_RH,P36_RH,P37_RH,P38_RH,P39_RH,P40_RH,P41_RH,P42_RH,P43_RH,Species))
row.names(PAP_OTU_RH) <- PAP_OTU_RH$Species
PAP_OTU_ALL_RH <- PAP_OTU_RH %>% mutate_if(is.numeric, ~1 * (. != 0))
row.names(PAP_OTU_ALL_RH) <- PAP_OTU_ALL_RH$Species
PAP_OTU_ALL_RH <- subset (PAP_OTU_ALL_RH, select = -c(Species))
PAP_OTU_ALL_RH$Mean <- rowMeans(PAP_OTU_ALL_RH)
PAP_OTU_ALL_RH$Species <- row.names(PAP_OTU_ALL_RH)
PAPStable_RH <- PAP_OTU_RH %>% mutate_if(is.numeric, ~1 * (. > 3 ))
row.names(PAPStable_RH) <- PAPStable_RH$Species
PAPStable_RH <- subset (PAPStable_RH, select = -c(Species))
PAPStable_RH$Mean_Stable <- rowMeans(PAPStable_RH)
PAPStable_RH$Species <- row.names(PAPStable_RH)
PAP_OTU_RH_Compare<- subset (PAPStable_RH, select = c(Mean_Stable,Species))
PAP_OTU_RH_Compare<- merge(PAP_OTU_ALL_RH, PAP_OTU_RH_Compare, by= "Species")
PAP_OTU_RH_Compare$Mean_temp <- PAP_OTU_RH_Compare$Mean - PAP_OTU_RH_Compare$Mean_Stable
PAP_RH_Stable2 <- subset(PAP_OTU_RH_Compare, 0 < Mean_Stable)
PAP_RH_Markers2 <- PAP_RH_Stable2$Species
```
Right hand Papillomaviridae species markers that are stable over time 
```{r}
PAP_RH_Markers2
```

## Set B Stable Scalp Papillomaviridae Species
Subset by scalp and identify Papillomaviridae species that are persistent across 4 out of the 5 time points by subject
```{r,message=FALSE,warning=FALSE,results="hide"}
PAP_OTU_SC <- subset(PAPStable, select = c(P01_SC,P02_SC,P03_SC,P04_SC,P05_SC,P06_SC,P07_SC,P08_SC,P09_SC,P10_SC,P11_SC,P12_SC,P13_SC,P14_SC,P15_SC,P16_SC, P17_SC,P18_SC,P19_SC,P20_SC,P21_SC,P22_SC,P23_SC,P24_SC,P25_SC,P26_SC,P27_SC,P28_SC,P29_SC,P30_SC,P31_SC,P32_SC,P34_SC,P35_SC,P36_SC,P37_SC,P38_SC,P39_SC,P40_SC,P41_SC,P42_SC,P43_SC,Species))
row.names(PAP_OTU_SC) <- PAP_OTU_SC$Species
PAP_OTU_ALL_SC <- PAP_OTU_SC %>% mutate_if(is.numeric, ~1 * (. != 0))
row.names(PAP_OTU_ALL_SC) <- PAP_OTU_ALL_SC$Species
PAP_OTU_ALL_SC <- subset (PAP_OTU_ALL_SC, select = -c(Species))
PAP_OTU_ALL_SC$Mean <- rowMeans(PAP_OTU_ALL_SC)
PAP_OTU_ALL_SC$Species <- row.names(PAP_OTU_ALL_SC)
PAPStable_SC <- PAP_OTU_SC %>% mutate_if(is.numeric, ~1 * (. > 3 ))
row.names(PAPStable_SC) <- PAPStable_SC$Species
PAPStable_SC <- subset (PAPStable_SC, select = -c(Species))
PAPStable_SC$Mean_Stable <- rowMeans(PAPStable_SC)
PAPStable_SC$Species <- row.names(PAPStable_SC)
PAP_OTU_SC_Compare<- subset (PAPStable_SC, select = c(Mean_Stable,Species))
PAP_OTU_SC_Compare<- merge(PAP_OTU_ALL_SC, PAP_OTU_SC_Compare, by= "Species")
PAP_OTU_SC_Compare$Mean_temp <- PAP_OTU_SC_Compare$Mean - PAP_OTU_SC_Compare$Mean_Stable
PAP_SC_Stable2 <- subset(PAP_OTU_SC_Compare, 0 < Mean_Stable)
PAP_SC_Markers2 <- PAP_SC_Stable2$Species
```
Scalp Papillomaviridae species markers that are stable over time 
```{r}
PAP_SC_Markers2
```

## Set B Stable Hand Papillomaviridae Species
```{r,message=FALSE,warning=FALSE,results="hide"}
PAP_Hand_Markers_Shared2 <- PAP_LH_Markers2[PAP_LH_Markers2 %in% PAP_RH_Markers2]
```
Hand Stable Papillomaviridae Species Markers
```{r}
PAP_Hand_Markers_Shared2
```

## Set B Stable Across All Locations Papillomaviridae Species
```{r,message=FALSE,warning=FALSE,results="hide"}
PAP_All_Markers_Shared2 <- PAP_Hand_Markers_Shared2[PAP_Hand_Markers_Shared2 %in% PAP_SC_Markers2]
```
Overall Across All Locations Stable Papillomaviridae Species Markers
```{r}
PAP_All_Markers_Shared2
```
#Markers
```{r}
Overall_markers_LH<-c("Autographa californica multiple nucleopolyhedrovirus","Autographa californica nucleopolyhedrovirus","Caribou associated gemykrogvirus 1","Staphylococcus phage St 134","Unclassified Caudovirales","Unclassified Homo sapiens like virus","Unclassified Siphoviridae","Uncultured Caudovirales phage")
Overall_markers_RH<-c("Autographa californica multiple nucleopolyhedrovirus","Autographa californica nucleopolyhedrovirus","Staphylococcus phage HOB 14.1.R1","Staphylococcus phage St 134","Staphylococcus virus IPLA7","Unclassified Andhravirus","Unclassified Caudovirales","Unclassified Homo sapiens like virus","Unclassified Siphoviridae","Unclassified Staphylococcus warneri like virus","Uncultured Caudovirales phage")
Overall_markers_SC<-c("Autographa californica multiple nucleopolyhedrovirus","Autographa californica nucleopolyhedrovirus","Gammapapillomavirus 1","Gammapapillomavirus 24","Propionibacterium virus PAD20","Staphylococcus phage HOB 14.1.R1","Staphylococcus phage IME1318_01","Staphylococcus phage IME1323_01","Staphylococcus phage IME1348_01","Staphylococcus phage St 134","Staphylococcus virus IPLA7","Staphylococcus virus vB_SepS_E72","Unclassified Andhravirus","Unclassified Caudovirales","Unclassified Eukaryotic like virus","Unclassified Homo sapiens like virus","Unclassified Pahexavirus","Unclassified Phietavirus","Unclassified Rosenblumvirus","Unclassified Siphoviridae","Unclassified Staphylococcus capitis like virus","Unclassified Staphylococcus like virus","Uncultured Caudovirales phage" )
Overall_markers_Hands<-c("Autographa californica multiple nucleopolyhedrovirus","Autographa californica nucleopolyhedrovirus","Staphylococcus phage St 134","Unclassified Caudovirales","Unclassified Homo sapiens like virus","Unclassified Siphoviridae","Uncultured Caudovirales phage")
Overall_markers_All<-c("Autographa californica multiple nucleopolyhedrovirus","Autographa californica nucleopolyhedrovirus","Staphylococcus phage St 134","Unclassified Caudovirales","Unclassified Homo sapiens like virus","Unclassified Siphoviridae","Uncultured Caudovirales phage")

Papilloma_markers_LH<-c("Alphapapillomavirus 5","Betapapillomavirus 1","Betapapillomavirus 2","Betapapillomavirus 3","Gammapapillomavirus 1","Gammapapillomavirus 12","Gammapapillomavirus 13","Gammapapillomavirus 22","Gammapapillomavirus 7","Gammapapillomavirus 8")
Papilloma_markers_RH<-c("Alphapapillomavirus 5","Betapapillomavirus 1","Betapapillomavirus 2","Betapapillomavirus 3","Betapapillomavirus 5","Gammapapillomavirus 10","Gammapapillomavirus 12","Gammapapillomavirus 15","Gammapapillomavirus 22","Gammapapillomavirus 7","Gammapapillomavirus 8","Gammapapillomavirus 9")
Papilloma_markers_SC<-c("Alphapapillomavirus 5","Betapapillomavirus 1","Betapapillomavirus 2","Betapapillomavirus 3","Gammapaptillomavirus 12","Gammapapillomavirus 15","Gammapapillomavirus 22","Gammapapillomavirus 23","Gammapapillomavirus 7","Gammapapillomavirus 8")
Papilloma_markers_Hands<-c("Alphapapillomavirus 5","Betapapillomavirus 1","Betapapillomavirus 2","Betapapillomavirus 3","Gammapapillomavirus 12","Gammapapillomavirus 22","Gammapapillomavirus 7","Gammapapillomavirus 8" )
Papilloma_markers_All<-c("Alphapapillomavirus 5","Betapapillomavirus 1","Betapapillomavirus 2","Betapapillomavirus 3","Gammapapillomavirus 12","Gammapapillomavirus 22","Gammapapillomavirus 7","Gammapapillomavirus 8")

Caudo_markers_LH<-c("Aeromonas phage AP1","Bacillus phage Stitch","Caudovirales sp.","Cellulophaga phage phi47:1","Escherichia phage T7","Escherichia virus DE3","Escherichia virus Lambda","Escherichia virus P1","Escherichia virus T7","Escherichia virus TH38","Marine virus AFVG_250M104","Marine virus AFVG_25M557","Staphylococcus phage CNPx","Staphylococcus phage HOB 14.1.R1","Staphylococcus phage PhiSepi-HH3","Staphylococcus phage SPbeta-like","Staphylococcus phage Terranova","Staphylococcus phage vB_SauH_DELF3","Staphylococcus virus IPLA7","Staphylococcus virus IPLAC1C","Staphylococcus virus PH15","Staphylococcus virus vB_SepS_456","Staphylococcus virus vB_SepS_459","Staphylococcus virus vB_SepS_E72","Streptococcus phage phi-SC181","Streptococcus phage phiJH1301-2","Stx converting phage vB_EcoS_P27","Stx converting phage vB_EcoS_P32","Uncultured Caudovirales phage" )
Caudo_markers_RH<-c("Bacillus phage Stitch","Caudovirales sp.","Cellulophaga phage phi47:1","CrAssphage cat_SB2894","Escherichia phage 1720a-02","Escherichia phage T7","Escherichia virus DE3","Escherichia virus Lambda","Escherichia virus P1","Escherichia virus T7","Escherichia virus TH38","Marine virus AFVG_250M104","Marine virus AFVG_25M557","Staphylococcus phage CNPH82","Staphylococcus phage HOB 14.1.R1","Staphylococcus phage IME1365_01","Staphylococcus phage PhiSepi-HH3","Staphylococcus phage Pike","Staphylococcus phage Pontiff","Staphylococcus phage SPbeta-like","Staphylococcus phage StB20","Staphylococcus phage StB20-like","Staphylococcus phage Twillingate","Staphylococcus phage vB_SauH_DELF3","Staphylococcus virus IPLA5","Staphylococcus virus IPLA7","Staphylococcus virus IPLAC1C","Staphylococcus virus PH15","Staphylococcus virus St134","Staphylococcus virus vB_SepS_456","Staphylococcus virus vB_SepS_459","Staphylococcus virus vB_SepS_E72","Streptococcus phage phi-SC181","Streptococcus phage phi-SsuSSJ28_rum","Streptococcus phage phiJH1301-2","Stx converting phage vB_EcoS_P22","Stx converting phage vB_EcoS_P27","Stx converting phage vB_EcoS_P32","Stx converting phage vB_EcoS_ST2-8624","Uncultured Caudovirales phage")
Caudo_markers_SC<-c("Aeromonas phage AP1","Bacillus phage Stitch","Caudovirales sp.","CrAssphage apr34_000142F","Cutibacterium phage FD1","Escherichia phage T7","Escherichia virus DE3","Escherichia virus Lambda","Escherichia virus T7","Escherichia virus TH38","Marine virus AFVG_250M104","Marine virus AFVG_25M557","Propionibacterium phage MEAK","Propionibacterium phage pa27","Propionibacterium phage PacnesP1","Propionibacterium virus Attacne","Propionibacterium virus P100D","Propionibacterium virus P101A","Propionibacterium virus P144","Propionibacterium virus PHL041M10","Propionibacterium virus PHL060L00","Propionibacterium virus PHL070N00","Propionibacterium virus PHL112N00","Propionibacterium virus PHL179M00","Propionibacterium virus SKKY","Staphylococcus phage CNPH82","Staphylococcus phage CNPx","Staphylococcus phage HOB 14.1.R1","Staphylococcus phage IME-SA4","Staphylococcus phage IME1318_01","Staphylococcus phage IME1323_01","Staphylococcus phage IME1348_01","Staphylococcus phage IME1365_01","Staphylococcus phage JBug18","Staphylococcus phage PhiSepi-HH3","Staphylococcus phage Pike","Staphylococcus phage Pontiff","Staphylococcus phage Quidividi","Staphylococcus phage SPbeta-like","Staphylococcus phage StB12","Staphylococcus phage StB20","Staphylococcus phage StB20-like","Staphylococcus phage StB27","Staphylococcus phage Terranova","Staphylococcus phage Twillingate","Staphylococcus phage vB_SauH_DELF3","Staphylococcus virus Andhra","Staphylococcus virus IPLA5","Staphylococcus virus IPLA7","Staphylococcus virus IPLAC1C","Staphylococcus virus PH15","Staphylococcus virus SEP1","Staphylococcus virus St134","Staphylococcus virus vB_SepS_27","Staphylococcus virus vB_SepS_456","Staphylococcus virus vB_SepS_459","Staphylococcus virus vB_SepS_48","Staphylococcus virus vB_SepS_E72","Streptococcus phage phi-SC181","Streptococcus phage phi-SsuFJNP8_rum","Streptococcus phage phi-SsuHCJ3_rum","Streptococcus phage phi-SsuSSJ28_rum","Streptococcus phage phiJH1301-2","Uncultured Caudovirales phage")
Caudo_markers_Hands<-c("Bacillus phage Stitch","Caudovirales sp.","Cellulophaga phage phi47:1","Escherichia phage T7","Escherichia virus DE3","Escherichia virus Lambda","Escherichia virus P1","Escherichia virus T7","Escherichia virus TH38","Marine virus AFVG_250M104","Marine virus AFVG_25M557","Staphylococcus phage HOB 14.1.R1","Staphylococcus phage PhiSepi-HH3","Staphylococcus phage SPbeta-like","Staphylococcus phage vB_SauH_DELF3","Staphylococcus virus IPLA7","Staphylococcus virus IPLAC1C","Staphylococcus virus PH15","Staphylococcus virus vB_SepS_456","Staphylococcus virus vB_SepS_459","Staphylococcus virus vB_SepS_E72","Streptococcus phage phi-SC181","Streptococcus phage phiJH1301-2","Stx converting phage vB_EcoS_P27","Stx converting phage vB_EcoS_P32","Uncultured Caudovirales phage")
Caudo_markers_All<-c("Bacillus phage Stitch","Caudovirales sp.","Escherichia phage T7","Escherichia virus DE3","Escherichia virus Lambda","Escherichia virus T7","Escherichia virus TH38","Marine virus AFVG_250M104","Marine virus AFVG_25M557","Staphylococcus phage HOB 14.1.R1","Staphylococcus phage PhiSepi-HH3","Staphylococcus phage SPbeta-like","Staphylococcus phage vB_SauH_DELF3","Staphylococcus virus IPLA7","Staphylococcus virus IPLAC1C","Staphylococcus virus PH15","Staphylococcus virus vB_SepS_456","Staphylococcus virus vB_SepS_459","Staphylococcus virus vB_SepS_E72","Streptococcus phage phi-SC181","Streptococcus phage phiJH1301-2","Uncultured Caudovirales phage")

Baculo_markers_LH<-c("Autographa californica multiple nucleopolyhedrovirus","Malacosoma neustria nucleopolyhedrovirus","Orgyia pseudotsugata multiple nucleopolyhedrovirus","Spilosoma obliqua nucleopolyhedrosis virus","Unclassified Baculoviridae")
Baculo_markers_RH<-c("Autographa californica multiple nucleopolyhedrovirus","Malacosoma neustria nucleopolyhedrovirus","Unclassified Baculoviridae")
Baculo_markers_SC<-c("Autographa californica multiple nucleopolyhedrovirus","Dasychira pudibunda nucleopolyhedrovirus","Malacosoma neustria nucleopolyhedrovirus","Orgyia pseudotsugata multiple nucleopolyhedrovirus","Spilosoma obliqua nucleopolyhedrosis virus","Unclassified Baculoviridae")
Baculo_markers_Hands<-c("Autographa californica multiple nucleopolyhedrovirus","Malacosoma neustria nucleopolyhedrovirus","Unclassified Baculoviridae")
Baculo_markers_All<-c("Autographa californica multiple nucleopolyhedrovirus","Malacosoma neustria nucleopolyhedrovirus","Unclassified Baculoviridae")

Genomo_markers_LH<-c("Caribou associated gemykrogvirus 1","Genomoviridae sp.")
Genomo_markers_RH<-c("Genomoviridae sp.")
Genomo_markers_SC<-c("Genomoviridae sp.")
Genomo_markers_Hands<-c("Genomoviridae sp.")
Genomo_markers_All<-c("Genomoviridae sp.")

Contig_markers_LH<-c("k127_12111805","k127_12278877","k127_12339328","k127_1246730","k127_12842510","k127_12954","k127_13186497","k127_13257999","k127_14008563","k127_147881","k127_14874687","k127_3126920","k127_3443640","k127_4304884","k127_4343132","k127_5189512","k127_5608134","k127_5611397","k127_5988390","k127_6026611","k127_639643","k127_6473642","k127_6904675","k127_6909063","k127_699139","k127_8149250","k127_8568361","k127_9807842","k127_9848036")
Contig_markers_RH<-c("k127_10278031","k127_10802542","k127_12278877","k127_1246730","k127_12842510","k127_12863729","k127_12954","k127_13186497","k127_13257999","k127_14008563","k127_14483676","k127_147881","k127_14874687","k127_3126920","k127_3443640","k127_4343132","k127_5189512","k127_5608134","k127_5988390","k127_6026611","k127_639643","k127_6473642","k127_6475725","k127_6909063","k127_699139","k127_7149975","k127_7334662","k127_8058138","k127_8086034","k127_8261143","k127_8487815","k127_8568361","k127_9807842","k127_9848036")
Contig_markers_SC<-c("k127_10099950","k127_10802542","k127_11112126","k127_11476866","k127_12185411","k127_12278877","k127_1246730","k127_12842510","k127_12954","k127_13186497","k127_13257999","k127_13261360","k127_14008563","k127_14145340","k127_14306111","k127_14874687","k127_1591215","k127_1771997","k127_1788076","k127_205838","k127_2105829","k127_213564","k127_2529763","k127_2661048","k127_3126920","k127_3259586","k127_3443640","k127_3912894","k127_4343132","k127_5094717","k127_5189512","k127_535004","k127_5366206","k127_5412943","k127_5608134","k127_5611397","k127_5836065","k127_5958394","k127_5988390","k127_6026611","k127_6073437","k127_639643","k127_6463225","k127_6473642","k127_6475725","k127_654357","k127_6780509","k127_6783281","k127_6809321","k127_699139","k127_71913","k127_8058138","k127_8086034","k127_8261143","k127_8261887","k127_8487815","k127_8568361","k127_8745188","k127_8999582","k127_9070193","k127_9367470","k127_9468798","k127_9807842","k127_9848036","k127_9868134")
Contig_markers_Hands<-c("k127_12278877","k127_1246730","k127_12954","k127_13186497","k127_12842510","k127_13257999","k127_14008563","k127_147881","k127_14874687","k127_3126920","k127_3443640","k127_4343132","k127_5189512","k127_5608134","k127_5988390","k127_6026611","k127_639643","k127_6473642","k127_6909063","k127_699139","k127_8568361","k127_9807842","k127_9848036")
Contig_markers_All<-c("k127_12278877","k127_1246730","k127_12842510","k127_12954","k127_13186497","k127_13257999","k127_14008563","k127_14874687","k127_3126920","k127_3443640","k127_4343132","k127_5189512","k127_5608134","k127_5988390","k127_6026611","k127_639643","k127_6473642","k127_699139","k127_8568361","k127_9807842","k127_9848036")
```


"Autographa californica multiple nucleopolyhedrovirus","Autographa californica nucleopolyhedrovirus","Staphylococcus phage St 134","Unclassified Caudovirales","Unclassified Homo sapiens like virus","Unclassified Siphoviridae","Uncultured Caudovirales phage"

"k127_12278877","k127_1246730","k127_12842510","k127_12954","k127_13186497","k127_13257999","k127_14008563","k127_14874687","k127_3126920","k127_3443640","k127_4343132","k127_5189512","k127_5608134","k127_5988390","k127_6026611","k127_639643","k127_6473642","k127_699139","k127_8568361","k127_9807842","k127_9848036"

"Genomoviridae sp."

"Autographa californica multiple nucleopolyhedrovirus","Malacosoma neustria nucleopolyhedrovirus","Unclassified Baculoviridae"

"Bacillus phage Stitch","Caudovirales sp.","Escherichia phage T7","Escherichia virus DE3","Escherichia virus Lambda","Escherichia virus T7","Escherichia virus TH38","Marine virus AFVG_250M104","Marine virus AFVG_25M557","Staphylococcus phage HOB 14.1.R1","Staphylococcus phage PhiSepi-HH3","Staphylococcus phage SPbeta-like","Staphylococcus phage vB_SauH_DELF3","Staphylococcus virus IPLA7","Staphylococcus virus IPLAC1C","Staphylococcus virus PH15","Staphylococcus virus vB_SepS_456","Staphylococcus virus vB_SepS_459","Staphylococcus virus vB_SepS_E72","Streptococcus phage phi-SC181","Streptococcus phage phiJH1301-2","Uncultured Caudovirales phage"

"Alphapapillomavirus 5","Betapapillomavirus 1","Betapapillomavirus 2","Betapapillomavirus 3","Gammapapillomavirus 12","Gammapapillomavirus 22","Gammapapillomavirus 7","Gammapapillomavirus 8"





```{r}
HM_GENStable <- GENStable
HM_GENStable$Species->row.names(HM_GENStable)
HM_GENStable<- subset (HM_GENStable, select = -c(Species))
HM_GENStable_ALL <- subset(HM_GENStable, rownames(HM_GENStable) %in% Genomo_markers_All)

HM_OVERALL_Stable <- OTU_Stable 
HM_OVERALL_Stable$Species->row.names(HM_OVERALL_Stable)
HM_OVERALL_Stable<- subset (HM_OVERALL_Stable, select = -c(Species))
HM_OVERALL_Stable_ALL <- subset(HM_OVERALL_Stable, rownames(HM_OVERALL_Stable) %in% Overall_markers_All)

HM_BACStable <- BACStable
HM_BACStable$Species->row.names(HM_BACStable)
HM_BACStable<- subset (HM_BACStable, select = -c(Species))
HM_BACStable_ALL <- subset(HM_BACStable, rownames(HM_BACStable) %in% Baculo_markers_All)

HM_Contig_Stable <- CONTIGStable
HM_Contig_Stable$Species->row.names(HM_Contig_Stable)
HM_Contig_Stable<- subset (HM_Contig_Stable, select = -c(Species))
HM_Contig_Stable_ALL <- subset(HM_Contig_Stable, rownames(HM_Contig_Stable) %in% Contig_markers_All)

HM_PAPStable <- PAPStable
HM_PAPStable$Species->row.names(HM_PAPStable)
HM_PAPStable<- subset (HM_PAPStable, select = -c(Species))
HM_PAPStable_ALL <- subset(HM_PAPStable, rownames(HM_PAPStable) %in% Papilloma_markers_All)

HM_CAUDOStable <- CAUDOStable
HM_CAUDOStable$Species->row.names(HM_CAUDOStable)
HM_CAUDOStable<- subset (HM_CAUDOStable, select = -c(Species))
HM_CAUDOStable_ALL <- subset(HM_CAUDOStable, rownames(HM_CAUDOStable) %in% Caudo_markers_All)

```

```{r}
profile <- rbind(HM_GENStable_ALL,HM_OVERALL_Stable_ALL,HM_BACStable_ALL,HM_Contig_Stable_ALL,HM_PAPStable_ALL,HM_CAUDOStable_ALL)
profile2<-as.matrix(profile)
pheatmaps.obj<-pheatmap(profile2, cluster_cols = FALSE,cellheight = 11,cellwidth = 11,fontsize = 12,gaps_col = c(3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,75,78,81,84,87,90,93,96,99,102,105,108,111,114,117,120,123) )
```
pheatmap(test, annotation = annotation)
grid.text(levels(annotation$Var1), x=c(0.25,0.6),y=c(0.89,0.89), gp=gpar(fontsize=12))



```{r}


profile <- rbind(HM_GENStable_ALL,HM_OVERALL_Stable_ALL,HM_BACStable_ALL,HM_Contig_Stable_ALL,HM_PAPStable_ALL,HM_CAUDOStable_ALL)

profile2<-as.matrix(profile)

col_fun = colorRamp2(c(0, 4), c("white", "#000033"))
col_fun2 = colorRamp2(c(0, 4), c("#000033", "#66CCFF"))
lgd=Legend(col_fun = col_fun,title="Presence Over Time",title_position = "topcenter")
    

profile_LH <- subset(profile, select = c(P01_LH,P02_LH,P03_LH,P04_LH,P05_LH,P06_LH,P07_LH,P08_LH,P09_LH,P10_LH,P11_LH,P12_LH,P13_LH,P14_LH,P15_LH,P16_LH, P17_LH,P18_LH,P19_LH,P20_LH,P21_LH,P22_LH,P23_LH,P24_LH,P25_LH,P26_LH,P27_LH,P28_LH,P29_LH,P30_LH,P31_LH,P32_LH,P34_LH,P35_LH,P36_LH,P37_LH,P38_LH,P39_LH,P40_LH,P41_LH,P42_LH,P43_LH))
profile_LH <-as.matrix(profile_LH )
profile_LH <- t(profile_LH )
HMLH<-Heatmap(profile_LH , name = "Left Hand", heatmap_legend_param = list(title="Presence Over Time",title_position = "topcenter", direction = "horizontal"),row_title = "Subject", column_title_side = "bottom", row_dend_width = unit(2, "cm"), cluster_rows = FALSE, col = col_fun2, column_names_rot = 45,)

profile_RH <- subset(profile, select = c(P01_RH,P02_RH,P03_RH,P04_RH,P05_RH,P06_RH,P07_RH,P08_RH,P09_RH,P10_RH,P11_RH,P12_RH,P13_RH,P14_RH,P15_RH,P16_RH, P17_RH,P18_RH,P19_RH,P20_RH,P21_RH,P22_RH,P23_RH,P24_RH,P25_RH,P26_RH,P27_RH,P28_RH,P29_RH,P30_RH,P31_RH,P32_RH,P34_RH,P35_RH,P36_RH,P37_RH,P38_RH,P39_RH,P40_RH,P41_RH,P42_RH,P43_RH))
profile_RH <-as.matrix(profile_RH )
profile_RH <- t(profile_RH )
HMRH<-Heatmap(profile_RH , name = "Presence Over Time", row_title = "Subject", column_title_side = "bottom", row_dend_width = unit(2, "cm"), cluster_rows = FALSE, col = col_fun2, column_names_rot = 45,)

profile_SC <- subset(profile, select = c(P01_SC,P02_SC,P03_SC,P04_SC,P05_SC,P06_SC,P07_SC,P08_SC,P09_SC,P10_SC,P11_SC,P12_SC,P13_SC,P14_SC,P15_SC,P16_SC, P17_SC,P18_SC,P19_SC,P20_SC,P21_SC,P22_SC,P23_SC,P24_SC,P25_SC,P26_SC,P27_SC,P28_SC,P29_SC,P30_SC,P31_SC,P32_SC,P34_SC,P35_SC,P36_SC,P37_SC,P38_SC,P39_SC,P40_SC,P41_SC,P42_SC,P43_SC))
profile_SC <-as.matrix(profile_SC )
profile_SC <- t(profile_SC )
HMSC<-Heatmap(profile_SC , name = "Presence Over Time", row_title = "Subject", column_title_side = "bottom", row_dend_width = unit(2, "cm"), cluster_rows = FALSE, col = col_fun2, column_names_rot = 45,title_position = "topcenter")

library(grid)
pheatmaps.obj<-pheatmap(profile2, cluster_cols = FALSE,cellheight = 7,cellwidth = 7,fontsize = 8,gaps_col = c(3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,75,78,81,84,87,90,93,96,99,102,105,108,111,114,117,120,123) ,filename = "test.pdf")
grid.text(levels(annotation$Var1), x=c(0.25,0.6),y=c(0.89,0.89), gp=gpar(fontsize=12))
showViewport()



profile3<- t(profile2)
pheatmap(profile3, cluster_rows = FALSE,cellheight = 6,cellwidth = 6,fontsize = 6, gaps_row = c(3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,75,78,81,84,87,90,93,96,99,102,105,108,111,114,117,120,123) ,filename = "test_long.pdf")

annotation <- data.frame("Var1"=c("P01","P01","P01","P02","P02","P02","P03","P03","P03","P04","P04","P04","P05","P05","P05","P06","P06","P06","P07","P07","P07","P08","P08","P08","P09","P09","P09","P10","P10","P10","P11","P11","P11","P12","P12","P12","P13","P13","P13","P14","P14","P14","P15","P15","P15","P16","P16","P16","P17","P17","P17","P18","P18","P18","P19","P19","P19","P20","P20","P20","P21","P21","P21","P22","P22","P22","P23","P23","P23","P24","P24","P24","P25","P25","P25", "P26", "P26", "P26","P27","P27","P27","P28","P28","P28","P29","P29","P29","P30","P30","P30","P31","P31","P31","P32","P32","P32","P34","P34","P34","P35","P35","P35","P36","P36","P36","P37","P37","P37","P38","P38","P38","P39","P39","P39","P40","P40","P40","P41","P41","P41","P42","P42","P42","P43","P43","P43"))
rownames(annotation) <- colnames(profile2)



annotation <- data.frame(Var1 = factor(1:10 %% 2 == 0, labels = c("P01","P01","P01","P02","P02","P02","P03","P03","P03","P04","P04","P04","P05","P05","P05","P06","P06","P06","P07","P07","P07","P08","P08","P08","P09","P09","P09","P10","P10","P10","P11","P11","P11","P12","P12","P12","P13","P13","P13","P14","P14","P14","P15","P15","P15","P16","P16","P16","P17","P17","P17","P18","P18","P18","P19","P19","P19","P20","P20","P20","P21","P21","P21","P22","P22","P22","P23","P23","P23","P24","P24","P24","P25","P25","P25", "P26", "P26", "P26","P27","P27","P27","P28","P28","P28","P29","P29","P29","P30","P30","P30","P31","P31","P31","P32","P32","P32","P34","P34","P34","P35","P35","P35","P36","P36","P36","P37","P37","P37","P38","P38","P38","P39","P39","P39","P40","P40","P40","P41","P41","P41","P42","P42","P42","P43","P43","P43")))

ht_list = HMSC + HMLH + HMRH
draw(ht_list, ht_gap = unit(1, "cm"))

draw(HMLH, heatmap_legend_side = "top")



```
```{r}
profile_LH <- subset(profile, select = c(P01_LH,P01_RH,P01_SC))
profile_LH <-as.matrix(profile_LH )
HM01<-Heatmap(profile_LH , name = "P01", heatmap_legend_param = list(title="Presence Over Time",title_position = "topcenter", direction = "horizontal"),column_title = "Subject", column_title_side = "bottom", row_dend_width = unit(1, "cm"), cluster_columns = FALSE, col = col_fun2)
profile_02 <- subset(profile, select = c(P02_LH,P02_RH,P02_SC))
profile_02 <-as.matrix(profile_02)
HM02<-Heatmap(profile_02 , name = "P02",  top_annotation =HeatmapAnnotation(show_legend = FALSE),column_title = "Subject", column_title_side = "bottom", row_dend_width = unit(1, "cm"), cluster_columns = FALSE, col = col_fun2)
draw(HM01+HM02, heatmap_legend_side = "top")
pheatmap(HM01,HM02)
```

pheatmap(test, annotation = annotation)
grid.text(levels(annotation$Var1), x=c(0.25,0.6),y=c(0.89,0.89), gp=gpar(fontsize=12))
```{r}
pheatmaps.obj<-pheatmap(profile2, cluster_cols = FALSE,cellheight = 7,cellwidth = 7,fontsize = 8, annotation=annotation,gaps_col = c(3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,75,78,81,84,87,90,93,96,99,102,105,108,111,114,117,120,123) ,filename = "test2.pdf")
grid.text(levels(annotation$Var1), x=c(0.25,0.75),y=c(0.5,0.5), gp=gpar(fontsize=5))
showViewport()  #check viewport name
downViewport("col_annotation.3-3-3-3") # annotation
pheatmaps.obj <- pheatmap(test, annotation = annotation) # replot
grid.text(levels(annotation$Var1), x=c(0.25,0.75),y=c(0.5,0.5), gp=gpar(fontsize=5))
```


#annotation of contigs
```{r}
OVERALL_Stable<-OTU_Stable 

####"k127_1167408"human
####"k127_12111805" ermc and human
####"k127_12339328"65% staoh warneri
####"k127_12955915"Staphylococcus arlettae  
####"k127_13651728"staph warneri
####"k127_2294481"staph epidermis
####"k127_2930874"Staphylococcus hominis
####"k127_4304884"unknown
####"k127_5539693"staph warneri
####"k127_5760260"staph warneri
####"k127_6051856"Staphylococcus haemolyticus plasmid
####"k127_6350990"staph warneri 79%
####"k127_6904675"staph warneri 36%
####"k127_8149250"Caribou feces-associated gemycircularvirus
####"k127_8595617"human 86%
####"k127_8773102"staph epidermis
####"k127_909419"staph epidermis
####"k127_9768581"staph epidermis
####"k127_9822147"staph warneri
####"k127_10278031"phage
####"k127_12845230"staph warneri plasmid
####"k127_12863729"70% human but only one
####"k127_13220787"staph epidermis
####"k127_13446490"human
####"k127_14240615"human
####"k127_14483676"staph epidermis 67%
####"k127_2550702"staph epidermis
####"k127_2973204"Aerococcus urinaeequi
####"k127_3827777"Staphylococcus hominis
####"k127_4448855"human
####"k127_477065"Canis lupus
####"k127_5374282"staph warneri
####"k127_622663"Staphylococcus saccharolyticus 85%
####"k127_7149975"57% human
####"k127_7334662"unknown
####"k127_7403466" human but only:!!!!!!
####"k127_7729221"Staphylococcus saccharolyticus
####"k127_7824569"human
####"k127_8637706"staph epidermis
####"k127_9018021"human but only:!!!!!!
####"k127_9699339"human
####"k127_10353230" human
####"k127_10519884" human
####"k127_10775502" human
####"k127_11129356" human
####"k127_12278877" Unknown (keep)
####"k127_1232577"  Staph aureus plasmid
####"k127_1246730"  Unknown (keep)
####"k127_12842510" ermc contig
####"k127_1286849" human
####"k127_12954"  mixed of bacteria and human so keep
####"k127_13186497" ermc gene
####"k127_13257999" virus! Cress like
####"k127_14007238" Haemophilus parainfluenzae
####"k127_14008563" Unknown
####"k127_147881" Unknown
####"k127_14874687" Unknown
####"k127_2211545" Cutibacterium acnes  
####"k127_3126920" virus Synthetic baculovirus AcMNPV-WIV-Syn1
####"k127_3443640" Unknown 
####"k127_3852072" human
####"k127_4343132" 50% human the rest is unknown
####"k127_451583" staph epidermis
####"k127_5189512" 65% Acinetobacter sp.
####"k127_5608134"  40% human
####"k127_5988390" 50% human
####"k127_6026611"  68% staph hominis
####"k127_639643" 40% Musa acuminata
####"k127_6473642" Autographa californica nucleopolyhedrovirus isolate vAcRev-2
####"k127_6909063"  ermc 
####"k127_699139"   64% human (only one)
####"k127_7282023"  human
####"k127_7700951"  Acinetobacter ursingi
####"k127_8267947" staph epidermis
####"k127_8568361" 61% human
####"k127_9177428" human
####"k127_926238"  human
####"k127_9421050"  human
####"k127_959482"  human
####"k127_9807842"  65% human
####"k127_9848036" 31% staph 
####"k127_10099950" unknown
####"k127_10160518"Propionibacterium acnes
####"k127_10219930"Staph epidermis
####"k127_1023938"Staph epidermis
####"k127_10304315" Staph epidermis
####"k127_1030640" Staph epidermis
####"k127_1047837" human
####"k127_10592214" staph hominus
####"k127_1069162" staph epidermis
####"k127_10718521"staph epidermis
####"k127_10746685"staph epidermis
####"k127_10792696"staph capitis
####"k127_10802542"Unknown
####"k127_10926047"staph epidermis
####"k127_10967782"staph epidermis
####"k127_11002946"staph epidermis
####"k127_11069831"staph capitis
####"k127_11112126"staph epidermis or staph phage
####"k127_11184018"staph epidermis
####"k127_11197271"staph epidermis plasmid
####"k127_11237773"staph capitis
####"k127_11401384"staph capitis
####"k127_11456255"staph epidermis
####"k127_11476667"staph capitis
####"k127_11476866"Unknown
####"k127_11515987"Staph epidermis
####"k127_11561766"staph capitis
####"k127_11623110" staph capitis
####"k127_11645202"staph hominis
####"k127_1187702"staph epidermis
####"k127_11946240"staph capitis
####"k127_11966247" human
####"k127_12017676"staph capitis
####"k127_12117639"staph hominis
####"k127_12173104"staph capitis
####"k127_12185411"staph 82% and phage 64%
####"k127_12329334"staph epidermis
####"k127_12341692"staph epidermis
####"k127_12351065"staph capitis
####"k127_12361553"staph capitis
####"k127_12364323"staph capitis
####"k127_12405425"staph capitis
####"k127_12416470"Cutibacterium acnes  
####"k127_1243388"human
####"k127_12445641"staph capitis
####"k127_12481766"staph epidermis
####"k127_12496393"Cutibacterium acnes
####"k127_12510607"staph epidermis
####"k127_1254771"Cutibacterium acnes
####"k127_12620961"staph capitis
####"k127_12687793"staph capitis
####"k127_12697343"staph capitis
####"k127_12717"staph epidermis
####"k127_1274093"staph capitis
####"k127_12801595"staph epidermis
####"k127_12826274"staph capitis
####"k127_12846149"staph epidermis
####"k127_12857229"staph epidermis
####"k127_12868487"staph capitis
####"k127_12878667"staph capitis
####"k127_12928181"Cutibacterium acnes
####"k127_1293968"staph epidermis
####"k127_12954" mix of bacteria and human and dog
####"k127_12981690"Cutibacterium acnes
####"k127_13015218"staph epidermis
####"k127_13030744"staph epidermis
####"k127_13066699"Cutibacterium acnes
####"k127_13162885" 74% Staph capitis
####"k127_13186497"ermc
####"k127_13196142"human
####"k127_13205050"Staphylococcus saccharolyticus
####"k127_1322320"staph epidermis
####"k127_13257999" Cress virus
####"k127_13261360"staph epidermis 69%
####"k127_13295455"staph capitis
####"k127_1332986"staph capitis
####"k127_13407043"staph capitis
####"k127_13591451"staph epidermis
####"k127_13634"staph capitis
####"k127_13645658"staph
####"k127_13681513"staph epidermis
####"k127_13713824"staph
####"k127_1374042"staph capitis
####"k127_1397185"human
####"k127_14016320"staph epidermis 86%
####"k127_14145340"52% human only one
####"k127_14306111"phage
####"k127_1446839"staph
####"k127_14641566"staph epidermis
####"k127_1466069"human (but only 1)##$$$$$$$$$$****
####"k127_14716738"staph capitis
####"k127_1477928"staph epidermis
####"k127_14874687" mix of bacteria and weird stuff
####"k127_14882639"staph capitis
####"k127_14883155"staph epidermis
####"k127_15000680"staph epidermis
####"k127_15055673"staph epidermis
####"k127_15104150"Cutibacterium acnes
####"k127_15178741"Cutibacterium acnes
####"k127_1566837"human
####"k127_1591215"47% staph
####"k127_1704175"staph capitis
####"k127_1753074"staph epidermis
####"k127_1771997"57% human
####"k127_1788076"phage
####"k127_1899023"human
####"k127_1967774"staph epidermis
####"k127_205838" unknown
####"k127_2083255"staph epidermis
####"k127_2105829"phage
####"k127_2111166"staph capitis
####"k127_2121349"Cutibacterium acnes
####"k127_2133616"human 75%
####"k127_213564"unknown(human44%)
####"k127_2191793"staph capitis
####"k127_2222331"human (but only 1)##$$$$$$$$$$****
####"k127_2264154"staph epidermis
####"k127_2296868"staph epidermis
####"k127_2379642"staph capitis
####"k127_2391265"staph capitis
####"k127_2391320"human
####"k127_2394541"staph capitis
####"k127_2406027"staph epidermis
####"k127_246113"staph epidermis
####"k127_2463680"staph epidermis
####"k127_2529763"papilloma HPV
####"k127_2585305"staph hominis
####"k127_2596807"staph capitis
####"k127_262628"staph epidermis
####"k127_2661048"phage
####"k127_2701746"staph epidermis
####"k127_2730884"Cutibacterium acnes
####"k127_2741207"human
####"k127_296328"Cutibacterium acnes
####"k127_2990313"staph epidermis
####"k127_3006533"staph capitis
####"k127_3033219"staph
####"k127_3037988"staph epidermis
####"k127_3088777"human
####"k127_3094606"staph epidermis
####"k127_3109667"Staphylococcus saccharolyticus plasmid
####"k127_3109796"staph epidermis
####"k127_3110351"staph capitis
####"k127_3126920"baculovirus
####"k127_3165784"staph epidermis
####"k127_317240"staph epidermis
####"k127_3259586"phage
####"k127_3269807"human
####"k127_3340803"Cutibacterium acnes
####"k127_3347249"staph epidermis
####"k127_3396793"staph epidermis
####"k127_3443640"unknown
####"k127_3469997"staph epidermis
####"k127_3523838"staph epidermis
####"k127_3538854"staph capitis
####"k127_3552867"staph capitis
####"k127_3624816"staph epidermis
####"k127_3637269"staph epidermis
####"k127_379243"staph epidermis
####"k127_3886910"staph epidermis plasmid
####"k127_3890066"human
####"k127_3896165"staph capitis
####"k127_3901733"staph epidermis
####"k127_39106"staph epidermis
####"k127_3910990"staph capitis
####"k127_3912894"phage
####"k127_3923524"staph epidermis
####"k127_3926309"staph capitis
####"k127_3999766"staph capitis
####"k127_3999825"staph capitis
####"k127_404851"staph capitis
####"k127_4059128"staph capitis
####"k127_4126947"staph epidermis
####"k127_4151350"staph epidermis
####"k127_4177634"staph epidermis 84%
####"k127_419403"staph capitis
####"k127_4226947"staph
####"k127_4236668"staph capitis 81%
####"k127_4239437"staph capitis
####"k127_4271824"staph epidermis
####"k127_4279105"staph epidermis
####"k127_427981"Staphylococcus saccharolyticus
####"k127_4288402"staph epidermis
####"k127_4343132"56% human
####"k127_4368876"staph epidermis
####"k127_4386580"staph capitis
####"k127_439307"Staphylococcus saccharolyticus 77%
####"k127_4423721"staph capitis
####"k127_4469481"human
####"k127_4485060"Cutibacterium acnes
####"k127_4557944"human
####"k127_4662510"staph epidermis
####"k127_4666979"staph epidermis
####"k127_4730751"staph epidermis
####"k127_4744579"staph capitis
####"k127_477380"staph epidermis
####"k127_4778904"staph epidermis
####"k127_4810741"staph capitis
####"k127_4819310"staph epidermis
####"k127_4829263"staph capitis
####"k127_4838803"staph capitis
####"k127_4950186"Staphylococcus saccharolyticus
####"k127_4956495"staph capitis
####"k127_4985000"staph epidermis
####"k127_5094717" unknonw 34% hit to phage
####"k127_5106004"human
####"k127_5109515"staph capitis
####"k127_5114660"Cutibacterium acnes
####"k127_5126754"human
####"k127_5189512"65% Acinetobacter
####"k127_5190951"staph capitis
####"k127_5300000"staph capitis
####"k127_5316878"human (but only 1)##$$$$$$$$$$****
####"k127_535004" staph and phage same %
####"k127_5366206"staph and virus
####"k127_5412943"staph 27%
####"k127_5437945"staph epidermis
####"k127_5486674"human
####"k127_5512203"staph epidermis
####"k127_55130"Cutibacterium acnes
####"k127_5516726"staph epidermis
####"k127_5600749"staph epidermis
####"k127_560318"staph capitis
####"k127_5608134"40% human
####"k127_5611397"staph capitis 67%
####"k127_5611770"staph capitis
####"k127_5617973"staph capitis
####"k127_5621202"staph epidermis 86%
####"k127_5813071"staph epidermis
####"k127_5836065"staph epidermis 50%
####"k127_5850797"Cutibacterium acnes
####"k127_5931972"staph epidermis
####"k127_5958394" staph and staph phage same %
####"k127_5977979"staph epidermis
####"k127_5988390"55% human
####"k127_6010033"Malassezia restricta
####"k127_6026611"Staphylococcus hominis 68%
####"k127_6058410"staph epidermis
####"k127_6070943"staph epidermis
####"k127_6071026"staph capitis
####"k127_6072461"human
####"k127_6073197"staph capitis
####"k127_6073437"staph epidermis and phage both high percentage
####"k127_6103216"staph epidermis
####"k127_6109690"staph capitis
####"k127_6134838"staph capitis
####"k127_6273104"staph capitis
####"k127_6289604"staph epidermis
####"k127_6315537"staph capitis
####"k127_6331920"staph epidermis
####"k127_6379298"staph epidermis
####"k127_639643"Musa acuminata 40%
####"k127_6430965"staph capitis
####"k127_6450463"Cutibacterium acnes
####"k127_6463225"staph and phage
####"k127_6473642"Mutant Autographa californica virus
####"k127_6475725"staph epidermis 61%
####"k127_6501265"staph epidermis
####"k127_654357"staph epidermis (does have phage though)
####"k127_6544139"Staphylococcus simulans 
####"k127_6780509"HPV 173
####"k127_6783281"staph epidermis 67%
####"k127_6809321"staph epidermis 48%
####"k127_6819316"staph epidermis
####"k127_6882653"staph capitis
####"k127_68828"staph capitis
####"k127_699139"64% human
####"k127_7017128"staph epidermis
####"k127_7066603"Staphylococcus saccharolyticus 78%
####"k127_7082354"staph epidermis
####"k127_7154587"staph capitis
####"k127_71913"Staph and virus
####"k127_7318856"Cutibacterium acnes
####"k127_7345020"Cutibacterium acnes
####"k127_7353848"staph capitis
####"k127_7492625"human
####"k127_7544103"staph capitis
####"k127_7677292"staph epidermis
####"k127_7730885"Staphylococcus saccharolyticus
####"k127_7813478"staph epidermis
####"k127_7847012"staph capitis
####"k127_7922647"staph capitis
####"k127_8033651"staph epidermis
####"k127_8052341"staph capitis
####"k127_8057303"human
####"k127_8058138"human 30%
####"k127_8075126"Cutibacterium acnes
####"k127_8081120"staph epidermis
####"k127_8086034"phage
####"k127_8105321"Staphylococcus hominis
####"k127_8110873"staph capitis
####"k127_8188768"staph epidermis
####"k127_8196091"staph epidermis
####"k127_8196827"human
####"k127_8225069"staph capitis
####"k127_8261143"staph epidermis 64%
####"k127_8261887"staph capitis 57%
####"k127_8487815"staph capitis 70%
####"k127_8502252"human
####"k127_8568361"human 61%
####"k127_8581271"staph capitis
####"k127_8582786"staph epidermis
####"k127_8651030"staph epidermis 89%
####"k127_8700728"staph capitis
####"k127_8715368"Cutibacterium acnes
####"k127_8745188"staphylococcus hominis 58%
####"k127_8748448"Cutibacterium acnes
####"k127_8749760"staph capitis
####"k127_877471"staph capitis
####"k127_8802126"staph capitis
####"k127_8864451"human (but only 1)##$$$$$$$$$$****
#####"k127_888146"staph epidermis
####"k127_8943896"staph capitis
####"k127_8999582"phage
####"k127_900127"staph epidermis
####"k127_9070193"staph epidermis 67%
####"k127_9099273"staph epidermis
####"k127_910955"staph epidermis
####"k127_9111562"human
####"k127_9216380"staph capitis
####"k127_9229891"staph epidermis
####"k127_926728"Cutibacterium acnes
####"k127_9301472"staph epidermis
####"k127_9367470"unknown
####"k127_9413842"staph epidermis
####"k127_9422444"staph epidermis
####"k127_9438305"Staphylococcus hominis
####"k127_9468798"staph epidermis 60% end is phage gene so probably virus
####"k127_9491837"staph epidermis
####"k127_9498949"Propionibacterium acnes
####"k127_9623411"staph capitis
####"k127_9638225"staph epidermis
####"k127_9770486"Cutibacterium acnes
####"k127_9782919"staph capitis
####"k127_9787499"staph capitis
####"k127_9790834"staph epidermis
###"k127_9805288"staph capitis
####"k127_9807842"human 65%
####"k127_981341"staph epidermis
####"k127_9848036"staph 31%
####"k127_9855053"staph capitis
####"k127_9868134"staph saccharolyticus 58%
####"k127_9895440"Cutibacterium acnes
####"k127_990551"staph epidermis
####"k127_9928610"staph epidermis
####"k127_9938655"staph capitis
####"k127_9956553"staph capitis
```


#VennDiagram
```{r}
#library("VennDiagram") 

#length(Contig_markers_LH) #8 #10 #29 #5 #2 #29 #total=83
#length(Contig_markers_RH) #11 #12 #40 #3 #1 #34 #total=101
#length(Contig_markers_SC) #23 #10 #64 #6 #1 #65 #total=169
#length(intersect(Contig_markers_LH,Contig_markers_RH)) #7 #8 #26 #3 #1 #23 #total=68
#length(intersect(Contig_markers_LH,Contig_markers_SC)) #7 #8 #25 #5 #1 #22 #total=68
#length(intersect(Contig_markers_RH,Contig_markers_SC)) #10 #9 #32 #3 #1 #27 #total=82
#length(Contig_markers_All) #7 #8 #22 #3 #1 #21 #total=62

#ALL categories
grid.newpage() 
venn.plot<-draw.triple.venn(area1 = 80, area2 = 97, area3 = 161, n12 = 66, n23 = 77, n13 = 66, n123 = 59, 
                            fill = c("pink", "#99ff99", "light blue"),
                            lty = "blank", 
                            category = c("Left Hand", "Right Hand", "Scalp"),
                            cat.fontface = "bold"
                            )


```


```{r}
#Overall
grid.newpage() 
draw.triple.venn(area1 = 8, area2 = 11, area3 = 23, n12 = 7, n13 = 7, n23 = 10, n123 = 7, fill = c("pink", "green", "orange"), lty = "blank", category = c("Left Hand", "Right Hand", "Scalp"))

#Papilloma
grid.newpage() 
draw.triple.venn(area1 = 10, area2 = 12, area3 = 10, n12 = 8, n13 = 8, n23 = 9, n123 = 8, fill = c("pink", "green", "orange"), lty = "blank", category = c("Left Hand", "Right Hand", "Scalp"))

#Caudovirales
grid.newpage() 
draw.triple.venn(area1 = 29, area2 = 40, area3 = 64, n12 = 26, n13 = 25, n23 = 32, n123 = 22, fill = c("pink", "green", "orange"), lty = "blank", category = c("Left Hand", "Right Hand", "Scalp"))

#Baculoviridea
grid.newpage() 
draw.triple.venn(area1 = 5, area2 = 3, area3 = 6, n12 = 3, n13 = 5, n23 = 3, n123 = 3, fill = c("pink", "green", "orange"), lty = "blank", category = c("Left Hand", "Right Hand", "Scalp"))

#Genomoviridea
grid.newpage() 
draw.triple.venn(area1 = 2, area2 = 1, area3 = 1, n12 = 1, n13 = 1, n23 = 1, n123 = 1, fill = c("pink", "green", "orange"), lty = "blank", category = c("Left Hand", "Right Hand", "Scalp"))

#Contig
grid.newpage() 
draw.triple.venn(area1 = 29, area2 = 34, area3 = 65, n12 = 23, n13 = 22, n23 = 27, n123 = 21, fill = c("pink", "green", "orange"), lty = "blank", category = c("Left Hand", "Right Hand", "Scalp"))
```

#Bargraph
```{r}
#Left Hand
OTU_LH <- subset(OTU_Stable, select = c(P01_LH,P02_LH,P03_LH,P04_LH,P05_LH,P06_LH,P07_LH,P08_LH,P09_LH,P10_LH,P11_LH,P12_LH,P13_LH,P14_LH,P15_LH,P16_LH, P17_LH,P18_LH,P19_LH,P20_LH,P21_LH,P22_LH,P23_LH,P24_LH,P25_LH,P26_LH,P27_LH,P28_LH,P29_LH,P30_LH,P31_LH,P32_LH,P34_LH,P35_LH,P36_LH,P37_LH,P38_LH,P39_LH,P40_LH,P41_LH,P42_LH,P43_LH,Family))
row.names(OTU_LH) <- OTU_LH$Family
OTU_ALL_LH <- OTU_LH %>% mutate_if(is.numeric, ~1 * (. != 0))
#OTU_ALL_LH <- OTU_LH %>% mutate_if(is.numeric, ~1 * (. > 5))
row.names(OTU_ALL_LH) <- OTU_ALL_LH$Family
OTU_ALL_LH <- subset (OTU_ALL_LH, select = -c(Family))
OTU_ALL_LH$Mean <- rowMeans(OTU_ALL_LH)
OTU_ALL_LH$Family <- row.names(OTU_ALL_LH)
OTU_Stable_LH <- OTU_LH %>% mutate_if(is.numeric, ~1 * (. > 3 ))
row.names(OTU_Stable_LH) <- OTU_Stable_LH$Family
OTU_Stable_LH <- subset (OTU_Stable_LH, select = -c(Family))
OTU_Stable_LH$Mean_Stable <- rowMeans(OTU_Stable_LH)
OTU_Stable_LH$Family <- row.names(OTU_Stable_LH)
OTU_LH_Compare<- subset (OTU_Stable_LH, select = c(Mean_Stable,Family))
OTU_LH_Compare<- merge(OTU_ALL_LH, OTU_LH_Compare, by= "Family")
OTU_LH_Compare$Mean_temp <- OTU_LH_Compare$Mean - OTU_LH_Compare$Mean_Stable
LH_Stable2 <- subset(OTU_LH_Compare, 0 < Mean_Stable)
LH_Stable2<-subset(LH_Stable2,select=c(Family,Mean,Mean_Stable,Mean_temp))
LH_Stable2

#Right Hand
OTU_RH <- subset(OTU_Stable, select = c(P01_RH,P02_RH,P03_RH,P04_RH,P05_RH,P06_RH,P07_RH,P08_RH,P09_RH,P10_RH,P11_RH,P12_RH,P13_RH,P14_RH,P15_RH,P16_RH, P17_RH,P18_RH,P19_RH,P20_RH,P21_RH,P22_RH,P23_RH,P24_RH,P25_RH,P26_RH,P27_RH,P28_RH,P29_RH,P30_RH,P31_RH,P32_RH,P34_RH,P35_RH,P36_RH,P37_RH,P38_RH,P39_RH,P40_RH,P41_RH,P42_RH,P43_RH,Family))
row.names(OTU_RH) <- OTU_RH$Family
OTU_ALL_RH <- OTU_RH %>% mutate_if(is.numeric, ~1 * (. != 0))
#OTU_ALL_RH <- OTU_RH %>% mutate_if(is.numeric, ~1 * (. > 5))
row.names(OTU_ALL_RH) <- OTU_ALL_RH$Family
OTU_ALL_RH <- subset (OTU_ALL_RH, select = -c(Family))
OTU_ALL_RH$Mean <- rowMeans(OTU_ALL_RH)
OTU_ALL_RH$Family <- row.names(OTU_ALL_RH)
OTU_Stable_RH <- OTU_RH %>% mutate_if(is.numeric, ~1 * (. > 3 ))
row.names(OTU_Stable_RH) <- OTU_Stable_RH$Family
OTU_Stable_RH <- subset (OTU_Stable_RH, select = -c(Family))
OTU_Stable_RH$Mean_Stable <- rowMeans(OTU_Stable_RH)
OTU_Stable_RH$Family <- row.names(OTU_Stable_RH)
OTU_RH_Compare<- subset (OTU_Stable_RH, select = c(Mean_Stable,Family))
OTU_RH_Compare<- merge(OTU_ALL_RH, OTU_RH_Compare, by= "Family")
OTU_RH_Compare$Mean_temp <- OTU_RH_Compare$Mean - OTU_RH_Compare$Mean_Stable
RH_Stable2 <- subset(OTU_RH_Compare, 0 < Mean_Stable)
RH_Stable2<-subset(RH_Stable2,select=c(Family,Mean,Mean_Stable,Mean_temp))
RH_Stable2

#Scalp
OTU_SC <- subset(OTU_Stable, select = c(P01_SC,P02_SC,P03_SC,P04_SC,P05_SC,P06_SC,P07_SC,P08_SC,P09_SC,P10_SC,P11_SC,P12_SC,P13_SC,P14_SC,P15_SC,P16_SC, P17_SC,P18_SC,P19_SC,P20_SC,P21_SC,P22_SC,P23_SC,P24_SC,P25_SC,P26_SC,P27_SC,P28_SC,P29_SC,P30_SC,P31_SC,P32_SC,P34_SC,P35_SC,P36_SC,P37_SC,P38_SC,P39_SC,P40_SC,P41_SC,P42_SC,P43_SC,Family))
row.names(OTU_SC) <- OTU_SC$Family
OTU_ALL_SC <- OTU_SC %>% mutate_if(is.numeric, ~1 * (. != 0))
#OTU_ALL_SC <- OTU_SC %>% mutate_if(is.numeric, ~1 * (. > 5))
row.names(OTU_ALL_SC) <- OTU_ALL_SC$Family
OTU_ALL_SC <- subset (OTU_ALL_SC, select = -c(Family))
OTU_ALL_SC$Mean <- rowMeans(OTU_ALL_SC)
OTU_ALL_SC$Family <- row.names(OTU_ALL_SC)
OTU_Stable_SC <- OTU_SC %>% mutate_if(is.numeric, ~1 * (. > 3 ))
row.names(OTU_Stable_SC) <- OTU_Stable_SC$Family
OTU_Stable_SC <- subset (OTU_Stable_SC, select = -c(Family))
OTU_Stable_SC$Mean_Stable <- rowMeans(OTU_Stable_SC)
OTU_Stable_SC$Family <- row.names(OTU_Stable_SC)
OTU_SC_Compare<- subset (OTU_Stable_SC, select = c(Mean_Stable,Family))
OTU_SC_Compare<- merge(OTU_ALL_SC, OTU_SC_Compare, by= "Family")
OTU_SC_Compare$Mean_temp <- OTU_SC_Compare$Mean - OTU_SC_Compare$Mean_Stable
SC_Stable2 <- subset(OTU_SC_Compare, 0 < Mean_Stable)
SC_Stable2<-subset(SC_Stable2,select=c(Family,Mean,Mean_Stable,Mean_temp))
SC_Stable2
```

```{r}
data2 <- read.table(text="
Location,Family,OverallMean, StableMean
Left Hand, Baculoviridae, 1.0000000, 0.59523810
Left Hand, Genomoviridae, 0.9523810, 0.23809524
Left Hand, Herelleviridae, 0.9047619, 0.02380952
Left Hand, Myoviridae, 0.7380952, 0.02380952
Left Hand, Papillomaviridae, 0.5952381, 0.14285714
Left Hand, Podoviridae, 0.4047619, 0.07142857
Left Hand, Siphoviridae, 0.9761905, 0.38095238
Left Hand, Unclassified Caudovirales, 0.9523810, 0.26190476
Left Hand, Unclassified Homo sapiens like virus, 0.5238095, 0.07142857
Left Hand, Caulimoviridae, 0, 0
Left Hand, Unclassified Staphylococcus warneri like virus, 0, 0
Left Hand, Microviridae, 0, 0
Left Hand, Unclassified Eukaryotic like virus, 0, 0
Left Hand, Unclassified Staphylococcus capitis like virus, 0, 0 
Left Hand, Unclassified Staphylococcus like virus, 0, 0
Right Hand, Baculoviridae, 1.0000000, 0.30952381
Right Hand, Caulimoviridae, 1.0000000, 0.02380952
Right Hand, Genomoviridae, 0.6190476, 0.14285714
Right Hand, Herelleviridae, 0.7380952, 0.02380952
Right Hand, Myoviridae, 0.5714286, 0.02380952
Right Hand, Papillomaviridae, 0.8333333, 0.14285714
Right Hand, Podoviridae, 0.5476190, 0.02380952
Right Hand, Siphoviridae, 0.9761905, 0.42857143
Right Hand, Unclassified Caudovirales, 1.0000000, 0.28571429
Right Hand, Unclassified Homo sapiens like virus, 0.8095238, 0.04761905
Right Hand, Unclassified Staphylococcus warneri like virus, 0.2857143, 0.02380952
Right Hand, Microviridae, 0, 0
Right Hand, Unclassified Eukaryotic like virus, 0, 0
Right Hand, Unclassified Staphylococcus capitis like virus, 0, 0
Right Hand, Unclassified Staphylococcus like virus, 0, 0
Scalp, Baculoviridae, 0.9761905, 0.40476190
Scalp, Genomoviridae, 0.9523810, 0.33333333
Scalp, Herelleviridae, 0.9285714, 0.04761905
Scalp, Microviridae, 0.9523810, 0.02380952
Scalp, Papillomaviridae, 0.8571429, 0.21428571
Scalp, Podoviridae, 0.9285714, 0.11904762
Scalp, Siphoviridae, 1.0000000, 0.57142857
Scalp, Unclassified Caudovirales, 1.0000000, 0.52380952
Scalp, Unclassified Eukaryotic like virus, 0.2857143, 0.02380952
Scalp, Unclassified Homo sapiens like virus, 0.9523810, 0.09523810
Scalp, Unclassified Staphylococcus capitis like virus, 0.6190476, 0.02380952
Scalp, Unclassified Staphylococcus like virus, 0.8571429, 0.02380952
Scalp, Myoviridae, 0, 0
Scalp, Caulimoviridae, 0, 0
Scalp, Unclassified Staphylococcus warneri like virus, 0, 0
", header=TRUE, sep=",") 

data2$OverallSum<-round(data2$OverallMean*42)
data2$StableSum<-round(data2$StableMean*42)
data2$PercentStable<-(data2$StableSum/data2$OverallSum)
data2 <- data2 %>%
        mutate(PercentStable = paste0(round(PercentStable*100, 1), "%"))
data2[10, "PercentStable"] <- ""
data2[11, "PercentStable"] <- ""
data2[12, "PercentStable"] <- ""
data2[13, "PercentStable"] <- ""
data2[14, "PercentStable"] <- ""
data2[15, "PercentStable"] <- ""
data2[27, "PercentStable"] <- ""
data2[28, "PercentStable"] <- ""
data2[29, "PercentStable"] <- ""
data2[30, "PercentStable"] <- ""
data2[43, "PercentStable"] <- ""
data2[44, "PercentStable"] <- ""
data2[45, "PercentStable"] <- ""
```

```{r}
#library(cowplot)
plot <- ggplot(data2, 
               aes(x = Family, 
                   y = OverallSum, 
                   fill = Location)) +
  geom_bar(stat = "identity", 
           position = "dodge",colour="black") +
  scale_y_continuous(limits = c(0,42), 
                     expand = c(0, 0)) +
  coord_flip()

plot2<-ggplot(data2, 
              aes(x = Family, 
                  y = -StableSum, 
                  fill = Location)) +
  geom_bar(stat = "identity", 
           position = "dodge",alpha=0.5,colour="black") +
  scale_y_continuous(limits = c(-42,0.1), 
                     expand = c(.1, 0))+
  coord_flip()
p1<-plot+
   theme_half_open(12)+
  theme( axis.text.y = element_blank(),
         axis.title.y = element_blank(),
         axis.ticks.y = element_blank())+
  theme(plot.margin = unit(c(0, 1, 0, 0), "cm"),
        axis.line.y = element_line(color = "grey", linetype = "dotted"))+
  scale_y_continuous(name = "Prevalence in Study Population",
                     breaks = seq(0, 42, by = 6),
                     labels = seq(0, 42, by = 6),
                     limits = c(0,42), expand = c(0, 0))+
  theme(legend.position = "none")+
  ylab("Prevalence in Population")

p2<-plot2 +
   theme_half_open(12)+
  scale_y_continuous(name = "Prevalence Stable",
                     breaks = seq(0.1, -42, by = -6),
                     labels = seq(0,  42, by =  6),
                     limits = c(-42,0), expand = c(0, 0))+
  theme(legend.position = "none")+
  theme(plot.margin = unit(c(0, -0.2, 0, 0), "cm"))+ 
  ylab("Prevalence Stable")

legend_b <- get_legend(
  p1 + 
    guides(color = guide_legend(nrow = 1)) +
    theme(legend.position = "bottom"))

prow<-plot_grid(p2, p1,rel_widths = c(1.35,1))

png("BAR_FIGURE.png", width= 16, height= 10,
    units="in", res=300, pointsize=12)
plot_grid(prow, legend_b, ncol = 1,nrow = 2, rel_heights = c(1, .1),align = "hv",axis="t")
dev.off()

ggsave("BAR_FIGURE.pdf", BAR_figure,width = 16, height = 10, units = "in",dpi = 600, pointsize=12)

```
#opposite
```{r}

#library(cowplot)
plot <- ggplot(data2, 
               aes(x = Family, 
                   y = StableSum, 
                   fill = Location)) +
  geom_bar(stat = "identity", 
           position = "dodge",alpha=0.5,colour="black") +
  scale_y_continuous(limits = c(0,25), 
                     expand = c(0, 0)) +
  coord_flip()

plot2<-ggplot(data2, 
              aes(x = Family, 
                  y = -OverallSum, 
                  fill = Location)) +
  geom_bar(stat = "identity", 
           position = "dodge",colour="black") +
  scale_y_continuous(limits = c(-42,0.1), 
                     expand = c(.1, 0))+
  coord_flip()
p1<-plot+
   theme_half_open(12)+
  theme( axis.text.y = element_blank(),
         axis.title.y = element_blank(),
         axis.ticks.y = element_blank())+
  theme(plot.margin = unit(c(0, 0, 0, 0), "cm"),
        axis.line.y = element_line(color = "grey", linetype = "dotted"))+
  ylab("Prevalence Stable")

p2<-plot2 +
   theme_half_open(12)+
  scale_y_continuous(name = "Prevalence in Population",
                     breaks = seq(0.1, -42, by = -5),
                     labels = seq(0,  42, by =  5),
                     limits = c(-42,0), expand = c(0, 0))+
  theme(legend.position = "none")+
  theme(plot.margin = unit(c(0, -0.2, 0, 0), "cm"))

plot_grid(p2, p1)
```


```{r}


profile <- HM_PAPStable_ALL
profile2<-as.matrix(profile)
pheatmaps.obj<-pheatmap(profile2, cluster_cols = FALSE,cellheight = 11,cellwidth = 11,fontsize = 12,gaps_col = c(3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,75,78,81,84,87,90,93,96,99,102,105,108,111,114,117,120,123) ,filename = "Heatmap_pap.pdf")
```
```